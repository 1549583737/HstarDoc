<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  
  <title>Archives: 2017 | 幻☆精灵的Blog</title>
  <meta name="description" content="幻☆精灵的Blog站点" />
  <meta name="keywords" content="幻精灵" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <link rel="shortcut icon" href="/blog/images/favicon.ico">
  <link rel="alternate" href="/blog/atom.xml" title="幻☆精灵的Blog">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="幻☆精灵的Blog站点">
<meta property="og:type" content="website">
<meta property="og:title" content="幻☆精灵的Blog">
<meta property="og:url" content="http://hstarorg.github.io/blog/archives/2017/page/2/index.html">
<meta property="og:site_name" content="幻☆精灵的Blog">
<meta property="og:description" content="幻☆精灵的Blog站点">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="幻☆精灵的Blog">
<meta name="twitter:description" content="幻☆精灵的Blog站点">
    
  <link href="https://fonts.googleapis.com/css?family=Inconsolata|Titillium+Web" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Roboto+Mono" rel="stylesheet">
  <link href='//cdn.bootcss.com/node-waves/0.7.5/waves.min.css' rel='stylesheet'>
  <link rel="stylesheet" href="/blog/style.css">
  
  

  <script>
    function setLoadingBarProgress(num) {
      document.getElementById('loading-bar').style.width=num+"%";
    }
  </script>
</head>

<body>
  <div id="loading-bar-wrapper">
  <div id="loading-bar"></div>
</div>


  <script>setLoadingBarProgress(20)</script> 
  <header class="l_header">
		<div class="wrapper container">
			<a class="logo flat-box" href='/blog/' >
				幻☆精灵的Blog
			</a>
			<div class='menu'>
				<ul class='h-list'>
					
						<li>
							<a class='flat-box nav-home' href='/blog/'>
								首页
							</a>
						</li>
					
						<li>
							<a class='flat-box nav-archives' href='/blog/archives'>
								归档
							</a>
						</li>
					
						<li>
							<a class='flat-box nav-about' href='/blog/about'>
								关于我
							</a>
						</li>
					
				</ul>
				<div class='underline'></div>
			</div>
			
				<div class="m_search">
					<form name="searchform" class="form u-search-form">
						<input type="text" class="input u-search-input" placeholder="Search" />
						<span class="icon icon-search"></span>
					</form>
				</div>
			
			<ul class='switcher h-list'>
				
					<li class='s-search'><a href='javascript:void(0)'><span class="icon icon-search"></span></a></li>
				
				<li class='s-menu'><a href='javascript:void(0)'><span class="icon icon-menu"></span></a></li>
			</ul>
		</div>
		<aside class="menu-phone">
			<nav>
				
					<a href="/blog/" class="nav-home nav">
						首页
					</a>
				
					<a href="/blog/archives" class="nav-archives nav">
						归档
					</a>
				
					<a href="/blog/about" class="nav-about nav">
						关于我
					</a>
				
			</nav>
		</aside>
</header>

    <script>setLoadingBarProgress(40);</script>
  <div class="l_body">
    <div class='container'>
      <div class='l_main'>
        
	
	<section class="page-header archive banner waves-image">
    <h1>Year : <span>2017</span></h1>
  </section>

<section class="post-list">
	
    <div class='post-wrapper'>
      <article class="post reveal">
  <section class="meta">
    
    <h2 class="title">
      <a href="/blog/2017/02/21/前端相关/CORS详解/">
        CORS详解
      </a>
    </h2>
    
    <time>
      Feb 21, 2017
    </time>
		
  </section>
  <section class="article typo">
	  <h2 id="0、关于CORS"><a href="#0、关于CORS" class="headerlink" title="0、关于CORS"></a>0、关于CORS</h2><p>说到CORS，就不得不先了解跨站HTTP请求（Cross-site HTTP request）。</p>
<p>跨域HTTP请求是指发起请求的资源所在域不同于该请求所指向资源所在的域的HTTP请求。</p>
<p>正如大家所知，出于安全考虑，浏览器会限制脚本中发起的跨站请求。使用XMLHttpRequest发起HTTP请求必须遵守同源策略。 具体而言，Web 应用程序能且只能使用 XMLHttpRequest 对象向其加载的源域名发起 HTTP 请求，而不能向任何其它域名发起请求。</p>
<p>由于Web应用技术越来越丰富，我们非常渴望在不丢失安全的前提下，能够实现跨站请求。特别是现在的Web程序结构，一般是HTML+REST API。在之前的实现中，我们一般采用jsonp来发起跨站请求，这其实是利用了html标签的特点。</p>
<p>W3C的Web应用工作组推荐了一种新的机制，即跨域资源共享（Cross-Origin Resource Sharing），也就是当前我们提到的CORS。 </p>
<p>CORS的核心，就是让服务器来确定是否允许跨域访问。</p>
<h2 id="1、典型场景"><a href="#1、典型场景" class="headerlink" title="1、典型场景"></a>1、典型场景</h2><h3 id="1-1、简单请求"><a href="#1-1、简单请求" class="headerlink" title="1.1、简单请求"></a>1.1、简单请求</h3><p>什么是简单请求？全部满足以下条件的请求可以称之为简单请求：</p>
<ol>
<li>只使用GET、HEAD或者POST请求方法。如果是POST，则数据类型（Content-Type）只能是<code>application/x-www-form-urlencodeed</code>、<code>multipart/form-data</code>、<code>text/plain</code>中的一种。</li>
<li>没有使用自定义的请求头（如x-token）</li>
</ol>
<p>按照这个规则，那我们的能实现跨域请求的情况如下：</p>
<p>Server代码：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="meta">'use strict'</span>;</div><div class="line"></div><div class="line"><span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>);</div><div class="line"><span class="keyword">var</span> server = http.createServer(<span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</div><div class="line">  <span class="comment">//之后设置了Access-Control-Allow-Origin，才会允许跨域</span></div><div class="line">  res.setHeader(<span class="string">'Access-Control-Allow-Origin'</span>, <span class="string">'*'</span>);</div><div class="line">  res.write(<span class="string">'abc'</span>);</div><div class="line">  res.end();</div><div class="line">&#125;);</div><div class="line"></div><div class="line">server.listen(<span class="number">10000</span>, () =&gt; &#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'started.'</span>);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>Client代码：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</div><div class="line">xhr.onreadystatechange = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">if</span>(xhr.readyState === XMLHttpRequest.DONE)&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'Result：'</span>, xhr.responseText);</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//场景一：GET请求，不需要Header，允许跨域</span></div><div class="line">xhr.open(<span class="string">'GET'</span>, <span class="string">'http://localhost:10000/'</span>, <span class="literal">true</span>);</div><div class="line">xhr.send();</div><div class="line"></div><div class="line"><span class="comment">//场景二： POST请求，需要设置为指定Header（不设置content-type也可），允许跨域</span></div><div class="line">xhr.open(<span class="string">'POST'</span>, <span class="string">'http://localhost:10000/'</span>, <span class="literal">true</span>);</div><div class="line"><span class="comment">//此处value必须是text/plain或者application/x-www-form-urlencoded或者multipart/form-data。</span></div><div class="line"><span class="comment">//此处也可以不设置</span></div><div class="line">xhr.setRequestHeader(<span class="string">'Content-Type'</span>, <span class="string">'text/plain'</span>);</div><div class="line">xhr.send();</div><div class="line"></div><div class="line"><span class="comment">//场景三：DELETE请求（不允许跨域）</span></div><div class="line">xhr.open(<span class="string">'DELETE'</span>, <span class="string">'http://localhost:10000/'</span>, <span class="literal">true</span>);</div><div class="line">xhr.send();</div><div class="line"></div><div class="line"><span class="comment">//场景四：POST请求，有自定义Header（不允许跨域）</span></div><div class="line">xhr.open(<span class="string">'POST'</span>, <span class="string">'http://localhost:10000/'</span>, <span class="literal">true</span>);</div><div class="line">xhr.setRequestHeader(<span class="string">'x-token'</span>, <span class="string">'a'</span>);</div><div class="line">xhr.send();</div></pre></td></tr></table></figure>
<h3 id="1-2、预请求"><a href="#1-2、预请求" class="headerlink" title="1.2、预请求"></a>1.2、预请求</h3><p>不同于简单请求，预请求要求必须先发送一个OPTIONS请求给站点，来查明该站点是否允许跨域请求，这样做的原因是为了避免跨站请求可能对目的站点的数据造成的损坏。</p>
<p>如果请求满足以下任一条件，则会产生预请求：</p>
<ol>
<li>请求以GET、HEAD、POST之外的方法发起。或者，使用POST，但数据类型为<code>application/x-www-form-urlencoded</code>, <code>multipart/form-data</code> 或者 <code>text/plain</code> 以外的数据类型。（注：之前的版本只有text/plain可以不用发起预请求）。</li>
<li>使用了自定义请求头。</li>
</ol>
<p>按照如上规则，我们来列举几个应用场景：</p>
<p>Server端代码：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="meta">'use strict'</span>;</div><div class="line"></div><div class="line"><span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>);</div><div class="line"><span class="keyword">var</span> server = http.createServer(<span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</div><div class="line">  <span class="comment">//之后设置了Access-Control-Allow-Origin，才会允许跨域</span></div><div class="line">  res.setHeader(<span class="string">'Access-Control-Allow-Origin'</span>, <span class="string">'*'</span>);</div><div class="line">  res.setHeader(<span class="string">'Access-Control-Allow-Methods'</span>, <span class="string">'POST, DELETE, GET'</span>);</div><div class="line">  res.setHeader(<span class="string">'Access-Control-Allow-Headers'</span>, <span class="string">'x-token'</span>);</div><div class="line">  <span class="comment">//设置预请求缓存1天，1天内再次请求，可以跳过预请求</span></div><div class="line">  <span class="comment">//此功能需要客户端缓存支持，如果客户端禁用缓存，那么每次都会预请求</span></div><div class="line">  res.setHeader(<span class="string">'Access-Control-Max-Age'</span>, <span class="number">60</span> * <span class="number">60</span> * <span class="number">24</span>); </div><div class="line">  res.write(<span class="string">'abc'</span>);</div><div class="line">  res.end();</div><div class="line">&#125;);</div><div class="line"></div><div class="line">server.listen(<span class="number">10000</span>, () =&gt; &#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'started.'</span>);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>Client端代码：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</div><div class="line">xhr.onreadystatechange = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">if</span>(xhr.readyState === XMLHttpRequest.DONE)&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'Result：'</span>, xhr.responseText);</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//场景一：DELETE请求，发送OPTIONS，匹配，允许跨域</span></div><div class="line">xhr.open(<span class="string">'DELETE'</span>, <span class="string">'http://localhost:10000/'</span>, <span class="literal">true</span>);</div><div class="line">xhr.send();</div><div class="line"></div><div class="line"><span class="comment">//场景二：PUT请求，发送OPTIONS，不匹配，不允许跨域</span></div><div class="line">xhr.open(<span class="string">'PUT'</span>, <span class="string">'http://localhost:10000/'</span>, <span class="literal">true</span>);</div><div class="line">xhr.send();</div><div class="line"></div><div class="line"><span class="comment">//场景三：DELETE请求匹配，使用自定义Header不匹配，不允许跨域</span></div><div class="line">xhr.open(<span class="string">'DELETE'</span>, <span class="string">'http://localhost:10000/'</span>, <span class="literal">true</span>);</div><div class="line">xhr.setRequestHeader(<span class="string">'x-token1'</span>, <span class="string">'aa'</span>);</div><div class="line">xhr.send();</div><div class="line"></div><div class="line"><span class="comment">//场景四：POST请求，匹配的自定义Header，允许跨域</span></div><div class="line">xhr.open(<span class="string">'POST'</span>, <span class="string">'http://localhost:10000/'</span>, <span class="literal">true</span>);</div><div class="line">xhr.setRequestHeader(<span class="string">'x-token'</span>, <span class="string">'a'</span>);</div><div class="line">xhr.send();</div></pre></td></tr></table></figure>
<h3 id="1-3、带凭证的请求"><a href="#1-3、带凭证的请求" class="headerlink" title="1.3、带凭证的请求"></a>1.3、带凭证的请求</h3><p>一般来说，对于跨站请求，浏览器是不会发送凭证（HTTP Cookies和验证信息）的。如果要发送带凭证的信息，只需要给XMLHttpRequest设置一个特殊的属性<code>withCredentials = true</code>，通过这种方式，浏览器就允许发送凭证信息。</p>
<p>带凭证的请求可能是简单请求，也可以是会有预请求。是否允许跨域，会先判断简单请求和预请求的规则，然后还会带上带凭证的请求自己的规则。</p>
<p>在带凭证的请求中，后端的响应必须包含Header<code>Access-Control-Allow-Credentials=true</code>，同时Header <code>Access-Control-Allow-Origin</code>，不能再使用*号这种匹配符。</p>
<p>具体示例如下：</p>
<p>服务端代码：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="meta">'use strict'</span>;</div><div class="line"></div><div class="line"><span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>);</div><div class="line"><span class="keyword">var</span> server = http.createServer(<span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</div><div class="line">  <span class="comment">//要处理带凭证的请求，此Header不能使用*。</span></div><div class="line">  res.setHeader(<span class="string">'Access-Control-Allow-Origin'</span>, <span class="string">'http://10.16.85.170:8000'</span>);</div><div class="line">  res.setHeader(<span class="string">'Access-Control-Allow-Methods'</span>, <span class="string">'POST, DELETE, GET'</span>);</div><div class="line">  res.setHeader(<span class="string">'Access-Control-Allow-Headers'</span>, <span class="string">'x-token'</span>);</div><div class="line">  res.setHeader(<span class="string">'Access-Control-Max-Age'</span>, <span class="number">60</span> * <span class="number">60</span> * <span class="number">24</span>); </div><div class="line">  <span class="comment">//只有设置了该Header，才允许带凭证的请求。</span></div><div class="line">  res.setHeader(<span class="string">'Access-Control-Allow-Credentials'</span>, <span class="literal">true</span>);</div><div class="line">  res.write(<span class="string">'abc'</span>);</div><div class="line">  res.end();</div><div class="line">&#125;);</div><div class="line"></div><div class="line">server.listen(<span class="number">10000</span>, () =&gt; &#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'started.'</span>);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>客户端代码：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</div><div class="line">xhr.onreadystatechange = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">if</span>(xhr.readyState === XMLHttpRequest.DONE)&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'Result：'</span>, xhr.responseText);</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"><span class="comment">//优先满足预请求，然后满足凭证请求，允许跨域。</span></div><div class="line">xhr.open(<span class="string">'POST'</span>, <span class="string">'http://localhost:10000/'</span>, <span class="literal">true</span>);</div><div class="line">xhr.withCredentials = <span class="literal">true</span>;</div><div class="line">xhr.setRequestHeader(<span class="string">'x-token'</span>, <span class="string">'a'</span>);</div><div class="line">xhr.send();</div></pre></td></tr></table></figure>
<h2 id="2、HTTP响应头"><a href="#2、HTTP响应头" class="headerlink" title="2、HTTP响应头"></a>2、HTTP响应头</h2><h3 id="2-1、-后端HTTP响应头"><a href="#2-1、-后端HTTP响应头" class="headerlink" title="2.1、 后端HTTP响应头"></a>2.1、 后端HTTP响应头</h3><p>此处列举后端有关CORS的响应头：</p>
<ol>
<li>Access-Control-Allow-Origin： <origin> | *  允许的域名</origin></li>
<li>Access-Control-Expose-Headers: <headers> 允许的白名单Header，多个用逗号隔开</headers></li>
<li>Access-Control-Max-Age: <delta-seconds>  预请求缓存时间，单位秒</delta-seconds></li>
<li>Access-Control-Allow-Credentials: true | false  是否允许带凭证的请求</li>
<li>Access-Control-Allow-Methods: <methods> 允许的请求类型，多个用逗号隔开</methods></li>
<li>Access-Control-Allow-Headers: <headers> 在实际请求中，允许的自定义header，多个用逗号隔开</headers></li>
</ol>
<h3 id="2-2、-浏览器发出跨域请求的响应头"><a href="#2-2、-浏览器发出跨域请求的响应头" class="headerlink" title="2.2、 浏览器发出跨域请求的响应头"></a>2.2、 浏览器发出跨域请求的响应头</h3><p>此处列举出浏览器在发送跨域请求时，会带上的响应头：</p>
<ol>
<li>Origin: <origin> 告诉服务器，请求来自哪里，仅仅是服务器名，不包含路径。</origin></li>
<li>Access-Control-Request-Method: <method> 预请求时，告诉服务器实际的请求方式</method></li>
<li>Access-Control-Request-Headers: <headers> 预请求时，告诉服务器，实际请求所携带的自定义Header</headers></li>
</ol>
<h2 id="3、参考资料"><a href="#3、参考资料" class="headerlink" title="3、参考资料"></a>3、参考资料</h2><ol>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Access_control_CORS#Preflighted_requests" target="_blank" rel="external">MDN HTTP access control (CORS)</a></li>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Access_control_CORS" target="_blank" rel="external">MDN HTTP访问控制(CORS)</a></li>
</ol>


    
    
    
  </section>
</article>
    </div>
  
    <div class='post-wrapper'>
      <article class="post reveal">
  <section class="meta">
    
    <h2 class="title">
      <a href="/blog/2017/02/21/前端相关/CSS布局（上）/">
        CSS布局（上）
      </a>
    </h2>
    
    <time>
      Feb 21, 2017
    </time>
		
  </section>
  <section class="article typo">
	  <h2 id="1、CSS布局之display"><a href="#1、CSS布局之display" class="headerlink" title="1、CSS布局之display"></a>1、CSS布局之display</h2><h3 id="1-1、dispaly"><a href="#1-1、dispaly" class="headerlink" title="1.1、dispaly"></a>1.1、dispaly</h3><p>dispaly是CSS中最重要的用于控制布局的属性，每个元素都有一个默认的display，大多数元素的默认值通常是block（块级元素）或inline（行内元素）。</p>
<p>另一个常用的display是none。一些特殊元素的默认值就是它，如script、link等。</p>
<h3 id="1-2-display-none-与-visibility-hidden"><a href="#1-2-display-none-与-visibility-hidden" class="headerlink" title="1.2 display:none 与 visibility:hidden"></a>1.2 display:none 与 visibility:hidden</h3><p>display设置为none，是不会保存元素本该显示的空间，但是visibility:hidden会保留。</p>
<pre><code>&lt;div style=&quot;width: 100px; height: 100px; border: 1px solid red;float:left;&quot;&gt;
  &lt;span style=&quot;display:none;&quot;&gt;ABCD&lt;/span&gt;EFG
&lt;/div&gt;
&lt;div style=&quot;width: 100px; height: 100px; border: 1px solid red;float:left;&quot;&gt;
  &lt;span style=&quot;visibility:hidden;&quot;&gt;ABCD&lt;/span&gt;EFG
&lt;/div&gt;
</code></pre><div style="width: 100px; height: 100px; border: 1px solid red;float:left;"><br>  <span style="display:none;">ABCD</span>EFG<br></div><br><div style="width: 100px; height: 100px; border: 1px solid red;float:left"><br>  <span style="visibility:hidden;">ABCD</span>EFG<br></div><br><div style="clear:both;"><br><br>### 1.3、更多的display值<br><br>比较常用的有list-item,inline-block,table,table-cell,flex等。<br><br>全部列表如下：<br><br>    none inline block contents list-item inline-block inline-table<br><br>    table table-cell table-column table-column-group table-footer-group table-header-group table-row table-row-group<br><br>    flex inline-flex grid inline-grid<br><br>    ruby ruby-base ruby-text ruby-base-container ruby-text-container<br><br>    run-in<br><br>    /<em> Global values </em>/<br>    display: inherit;<br>    display: initial;<br>    display: unset;<br><br>### 1.4 可改写的display属性<br><br>虽然每个元素都有默认的display，但是我们可以随时随地的重写它，比如将li元素修改为inline-block，制作水平菜单。<br><br>## 2、元素居中<br><br>### 2.1、水平居中<br><br>通过设置margin为auto可以实现水平居中，前提是元素必须得有宽度<br><br>    <div style="width:400px;margin:0 auto;height:10px;border:1px solid red;"></div>

<div style="width:400px;margin:0 auto;height:10px;border:1px solid red;"></div>

<h3 id="2-2、垂直居中"><a href="#2-2、垂直居中" class="headerlink" title="2.2、垂直居中"></a>2.2、垂直居中</h3><p>因为table的cell可以设置垂直居中，所以玩么可以模拟这样的效果</p>
<pre><code>&lt;div style=&quot;width: 400px;height: 200px;border: 1px solid red;display: table-cell; vertical-align: middle;&quot;&gt;
    &lt;div style=&quot;width:100px; height:100px;background: blue;&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
</code></pre><div style="width: 200px;height: 200px;border: 1px solid red;display: table-cell; vertical-align: middle;"><br>    <div style="width:100px; height:100px;background: blue;"></div><br></div>

<h3 id="2-3、绝对居中"><a href="#2-3、绝对居中" class="headerlink" title="2.3、绝对居中"></a>2.3、绝对居中</h3><p>知道水平居中和垂直居中，那么绝对居中就比较容易实现了。组合一下：</p>
<pre><code>&lt;div style=&quot;width: 200px;height: 200px;border: 1px solid red;display: table-cell; vertical-align: middle;&quot;&gt;
  &lt;div style=&quot;width:100px; height:100px;background: blue;margin:0 auto;&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
</code></pre><div style="width: 200px;height: 200px;border: 1px solid red;display: table-cell; vertical-align: middle;"><br>  <div style="width:100px; height:100px;background: blue;margin:0 auto;"></div><br></div>

<p>还有没有更好的方式呢？如下：</p>
<p>通过设置position:absolute,然后top、bottom、left、right值为0，margin:auto;实现绝对居中。<br>如果要相对容器居中，设置容器的position为relative。</p>
<pre><code>&lt;div style=&quot;width: 200px;height: 200px;border: 1px solid red; position:relative;&quot;&gt;
  &lt;div style=&quot;width:100px; height:100px;background: blue;margin:auto;position:absolute;top:0;left:0;bottom:0; right: 0;&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
</code></pre><div style="width: 200px;height: 200px;border: 1px solid red; position:relative;"><br>  <div style="width:100px; height:100px;background: blue;margin:auto;position:absolute;top:0;left:0;bottom:0; right: 0;"></div><br></div>


<h2 id="3、盒子模型"><a href="#3、盒子模型" class="headerlink" title="3、盒子模型"></a>3、盒子模型</h2><p>盒子模型(box-sizing)有两种典型值，分别为content-box,border-box。</p>
<h3 id="3-1、content-box"><a href="#3-1、content-box" class="headerlink" title="3.1、content-box"></a>3.1、content-box</h3><p>此时，设置在元素上的宽度为内容宽度，那么元素所占用的宽度为：width + border * 2 + padding * 2 + margin * 2。宽度同理</p>
<h3 id="3-2、border-box"><a href="#3-2、border-box" class="headerlink" title="3.2、border-box"></a>3.2、border-box</h3><p>此时，设置在元素上的宽度为包含border的宽度，那么占用总宽度为width + margin * 2。内容宽度为width - padding * 2 - border * 2。</p>
<h3 id="3-3-示例"><a href="#3-3-示例" class="headerlink" title="3.3 示例"></a>3.3 示例</h3><pre><code>&lt;div style=&quot;width:100px; margin: 10px; padding: 15px; border: 5px solid blue; box-sizing:content-box&quot;&gt;&lt;/div&gt;
&lt;div style=&quot;width:100px; margin: 10px; padding: 15px; border: 5px solid blue; box-sizing:border-box&quot;&gt;&lt;/div&gt;
</code></pre><div style="width:100px; margin: 10px; padding: 15px; border: 5px solid blue; box-sizing:content-box"></div><br><div style="width:100px; margin: 10px; padding: 15px; border: 5px solid blue; box-sizing:border-box"></div>

<h3 id="3-4、浏览器兼容性"><a href="#3-4、浏览器兼容性" class="headerlink" title="3.4、浏览器兼容性"></a>3.4、浏览器兼容性</h3><p>为了保证浏览器兼容性，需要加上特定浏览器前缀。</p>
<h2 id="4、元素定位"><a href="#4、元素定位" class="headerlink" title="4、元素定位"></a>4、元素定位</h2><p>如果要实现更多复杂的布局，那么就需要了解下position了。</p>
<h3 id="4-1、position-static"><a href="#4-1、position-static" class="headerlink" title="4.1、position:static"></a>4.1、position:static</h3><p>static是position属性的默认值，position:static的元素不会被特殊定位。</p>
<h3 id="4-2、position-relative"><a href="#4-2、position-relative" class="headerlink" title="4.2、position:relative"></a>4.2、position:relative</h3><p>在相对定位(relative)的元素上设置top、right、bottom、left会使其偏离正常位置，其他元素不会调整位置来弥补它偏离后剩下的空隙。</p>
<pre><code>&lt;div style=&quot;border:1px solid red; width: 400px; height: 200px;&quot;&gt;
  &lt;div style=&quot;background: blue; width:100px; height: 100px;&quot;&gt;&lt;/div&gt;
  ABCDE
&lt;/div&gt;
&lt;div style=&quot;border:1px solid red; width: 400px; height: 200px;&quot;&gt;
  &lt;div style=&quot;background: blue; width:100px; height: 100px;position:relative; left: 100px;top:50px;&quot;&gt;&lt;/div&gt;
  ABCDE
&lt;/div&gt;
</code></pre><div style="border:1px solid red; width: 400px; height: 200px;"><br>  <div style="background: blue; width:100px; height: 100px;"></div><br>  ABCDE<br></div><br><div style="border:1px solid red; width: 400px; height: 200px;"><br>  <div style="background: blue; width:100px; height: 100px;position:relative; left: 100px;top:50px;"></div><br>  ABCDE<br></div>

<h3 id="4-3、position-fixed"><a href="#4-3、position-fixed" class="headerlink" title="4.3、position:fixed"></a>4.3、position:fixed</h3><p>固定定位（fixed）元素会相对于视窗来定位，所以就算页面滚动，它还是会留在相同位置。示例请看左下角。</p>
<pre><code>&lt;div style=&quot;width: 100px;height:100px; position:fixed; bottom: 0; right: 0;
border: 1px solid red;&quot;&gt;固定定位&lt;/div&gt;
</code></pre><div style="width: 100px;height:100px; position:fixed; bottom: 0; right: 0;
border: 1px solid red;">固定定位</div>

<h3 id="4-4、position-absolute"><a href="#4-4、position-absolute" class="headerlink" title="4.4、position:absolute"></a>4.4、position:absolute</h3><p>绝对定位元素（absolute）与fixed类似，但是它不是相对视窗，而是相对最近的positioned（position值不是static的元素都是positioned元素）祖先元素，如果没有这样的祖先元素，那么它相对于文档的body元素，并且会随着页面滚动而滚动。</p>
<pre><code>&lt;div style=&quot;border:1px solid red; width: 400px; height: 200px;position:relative;&quot;&gt;
    &lt;div style=&quot;background: blue; width:100px; height: 100px;position:absolute;top: 25px;right:25px;&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
</code></pre><div style="border:1px solid red; width: 400px; height: 200px;position:relative;"><br>    <div style="background: blue; width:100px; height: 100px;position:absolute;top: 25px;right:25px;"></div><br></div>
</div>

    
    
    
  </section>
</article>
    </div>
  
    <div class='post-wrapper'>
      <article class="post reveal">
  <section class="meta">
    
    <h2 class="title">
      <a href="/blog/2017/02/21/前端相关/Iframe跨域通信的几种方式/">
        Iframe跨域通信的几种方式
      </a>
    </h2>
    
    <time>
      Feb 21, 2017
    </time>
		
  </section>
  <section class="article typo">
	  <h2 id="0、前言"><a href="#0、前言" class="headerlink" title="0、前言"></a>0、前言</h2><p>虽然iframe已经越来越不流行了，但是在某些特定的场景下，使用它可以大大减小我们的工作量。</p>
<p>当在页面内使用iframe，甚至是嵌套iframe的时候，它们之间少不了要通信。如果是同域的情况，那我们可以直接进行通信。</p>
<p>然而，很多场景下，往往是跨域通信，那这个时候我们可以用怎样的方式来跨域通信呢？</p>
<p>请看此文分解。</p>
<h2 id="1、重现跨域"><a href="#1、重现跨域" class="headerlink" title="1、重现跨域"></a>1、重现跨域</h2><p>我们新建两个 <code>index.html</code>，分别部署两个不同的端口上。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">// localhost:8001/index.html</div><div class="line">...</div><div class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Page1<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">iframe</span> <span class="attr">src</span>=<span class="string">"http://localhost:8003"</span> <span class="attr">frameborder</span>=<span class="string">"5"</span> </span></div><div class="line">  <span class="attr">style</span>=<span class="string">"width: 100%;height: 300px"</span>&gt;<span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></div><div class="line">    <span class="built_in">window</span>.getPage1Title = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">      <span class="keyword">return</span> <span class="string">'abc'</span>;</div><div class="line">    &#125;;</div><div class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line">...</div></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">// localhost:8003/index.html</div><div class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Page2<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">"fun1();"</span>&gt;</span>Test<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">fun1</span>(<span class="params"></span>)</span>&#123;</div><div class="line">      <span class="keyword">var</span> parentTitle = <span class="built_in">window</span>.parent.getPage1Title();</div><div class="line">      alert(parentTitle);</div><div class="line">    &#125;</div><div class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></div></pre></td></tr></table></figure>
<p>从浏览器打开 <code>http://localhost:8001</code>，然后点击iframe中的按钮，会出现一个如下提示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">(index):15 Uncaught SecurityError: Blocked a frame with origin &quot;http://localhost:8003&quot; from accessing a frame with origin &quot;http://10.16.85.170:8001&quot;. Protocols, domains, and ports must match.</div></pre></td></tr></table></figure>
<p>简而言之，就是不允许跨域访问。</p>
<h2 id="2、方式1-通过修改domain来实现跨域访问"><a href="#2、方式1-通过修改domain来实现跨域访问" class="headerlink" title="2、方式1 - 通过修改domain来实现跨域访问"></a>2、方式1 - 通过修改domain来实现跨域访问</h2><p>该方式适合主域相同，而子域不同的场景。此时可以在多个iframe中，通过修改document.domain = ‘主域’ 的方式来实现跨域。</p>
<p><strong>特定场合适用，不推荐</strong></p>
<h2 id="3、方式2-通过-window-name-跨域访问"><a href="#3、方式2-通过-window-name-跨域访问" class="headerlink" title="3、方式2 - 通过 window.name 跨域访问"></a>3、方式2 - 通过 <code>window.name</code> 跨域访问</h2><p>该方式原理是通过先请求其他的域的页面，把要传输的值赋值给 <code>window.name</code> 属性，然后把该iframe的src地址，修改为不跨域的一个页面。此时，由于是同一个iframe，所以name还是之前的数据，通过这样的方式变相的来获取其他域的数据。</p>
<p>示例如下：</p>
<p>在子页面中，仅仅需要把数据赋值给 <code>window.name</code><br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">// localhost:8003/index.html</div><div class="line">...</div><div class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Page2<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></div><div class="line">    <span class="built_in">window</span>.name = <span class="string">'我是page2的数据'</span>;</div><div class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line">...</div></pre></td></tr></table></figure></p>
<p>父页面中，需要修改iframe为不跨域，然后获取数据</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">// localhost:8001/index.html</div><div class="line">...</div><div class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Page1<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">iframe</span> <span class="attr">id</span>=<span class="string">"f1"</span> <span class="attr">frameborder</span>=<span class="string">"5"</span> <span class="attr">style</span>=<span class="string">"width: 100%;height: 300px"</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></div><div class="line">    <span class="keyword">var</span> iframe = <span class="built_in">document</span>.getElementById(<span class="string">'f1'</span>);</div><div class="line">    <span class="keyword">var</span> isCrossFrameUrl = <span class="literal">true</span>;</div><div class="line">    iframe.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">      <span class="keyword">if</span>(isCrossFrameUrl)&#123;</div><div class="line">        iframe.src = <span class="string">'about:block;'</span>;</div><div class="line">        isCrossFrameUrl = <span class="literal">false</span>;</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">      &#125;</div><div class="line">      <span class="built_in">console</span>.log(iframe.contentWindow.name);</div><div class="line">    &#125;;   </div><div class="line">    iframe.src = <span class="string">'http://localhost:8003'</span>;</div><div class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line">...</div></pre></td></tr></table></figure>
<p>这种方式实现起来，比较别扭，另外只能获取单次数据，并不友好，<strong>不推荐使用</strong>。</p>
<h2 id="4、方式3-通过-navigator-对象来跨域-已过期，不能使用了"><a href="#4、方式3-通过-navigator-对象来跨域-已过期，不能使用了" class="headerlink" title="4、方式3 - 通过 navigator 对象来跨域(已过期，不能使用了)"></a>4、方式3 - 通过 <code>navigator</code> 对象来跨域(已过期，不能使用了)</h2><p>该方式利用多个iframe窗口，访问的 <code>navigator</code> 对象都是同一个，而且并没有跨域问题这个原理；通过在该对象上注册和发送事件的方式来跨域访问。</p>
<h2 id="5、通过-window-postMessage-传递消息"><a href="#5、通过-window-postMessage-传递消息" class="headerlink" title="5、通过 window.postMessage 传递消息"></a>5、通过 <code>window.postMessage</code> 传递消息</h2><p>这是IE8+之后正统的iframe跨域解决方案，全称“跨文档消息”，是一个HTML5的新特性。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">otherWindow.postMessage(message, targetOrigin, [transfer]);</div></pre></td></tr></table></figure>
<p>其中第一个参数是消息对象，允许JS数据类型，第二个是要发送到的域，可以设置为 <code>*</code> 表示不限制。</p>
<p>使用如下：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">// localhost:8001/index.html</div><div class="line">...</div><div class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Page1<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">iframe</span> <span class="attr">id</span>=<span class="string">"f1"</span> <span class="attr">src</span>=<span class="string">"http://localhost:8003/"</span> <span class="attr">frameborder</span>=<span class="string">"5"</span> <span class="attr">style</span>=<span class="string">"width: 100%;height: 300px"</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></div><div class="line">    <span class="built_in">window</span>.addEventListener(<span class="string">'message'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">evt</span>)</span>&#123;</div><div class="line">      <span class="built_in">console</span>.log(evt);</div><div class="line">    &#125;);</div><div class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line">...</div></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">// localhost:8003/index.html</div><div class="line">...</div><div class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Page2<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></div><div class="line">    parent.postMessage(<span class="string">'test'</span>, <span class="string">'*'</span>);</div><div class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line">...</div></pre></td></tr></table></figure>
<p>打开 <code>http://localhost:8001</code> 就可以看到父页面已经收到子页面发过来的消息了。</p>
<p>evt对象有几个重要的属性需要我们去了解一下：</p>
<ol>
<li>data // 具体发送的数据</li>
<li>origin // 发送者origin（<a href="http://localhost:8003）" target="_blank" rel="external">http://localhost:8003）</a></li>
<li>source // 发送者（window对象）</li>
</ol>
<p><strong>该方式是当前最合适的跨文档通信方式，如果没有兼容IE6、7的需求，建议全部使用该方式。</strong></p>


    
    
    
  </section>
</article>
    </div>
  
    <div class='post-wrapper'>
      <article class="post reveal">
  <section class="meta">
    
    <h2 class="title">
      <a href="/blog/2017/02/21/前端相关/CSS布局（下）/">
        CSS布局（下）
      </a>
    </h2>
    
    <time>
      Feb 21, 2017
    </time>
		
  </section>
  <section class="article typo">
	  <h2 id="1、CSS布局之浮动"><a href="#1、CSS布局之浮动" class="headerlink" title="1、CSS布局之浮动"></a>1、CSS布局之浮动</h2><h3 id="1-1、float之图文混排"><a href="#1-1、float之图文混排" class="headerlink" title="1.1、float之图文混排"></a>1.1、float之图文混排</h3><p>float的意思就是元素漂浮在上层。</p>
<p>可以直接通过设置float属性实现图文混排，代码如下：</p>
<pre><code>&lt;div style=&quot;width:200px;height:200px;border: 1px solid gray;&quot;&gt;
  &lt;img src=&quot;&quot; alt=&quot;&quot; style=&quot;width:100px;height:100px;float:right;&quot;&gt; Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus imperdiet, nulla et dictum interdum, nisi lorem egestas odio, vitae scelerisque enim ligula venenatis dolor.
&lt;/div&gt;
</code></pre><div style="width:200px;height:200px;border: 1px solid gray;"><br>  <img src="" alt="" style="width:100px;height:100px;float:right;"> Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus imperdiet, nulla et dictum interdum, nisi lorem egestas odio, vitae scelerisque enim ligula venenatis dolor.<br></div>

<h3 id="1-2、float的副作用"><a href="#1-2、float的副作用" class="headerlink" title="1.2、float的副作用"></a>1.2、float的副作用</h3><p>当为元素设置float只有，它将会漂浮起来。那么它之后的元素就会忽略它，而进行定位。所以会导致元素重叠：</p>
<pre><code>&lt;div style=&quot;width:50px;height:50px;border:1px solid red;float:left&quot;&gt;
  我是悬浮元素
&lt;/div&gt;
&lt;div style=&quot;width:100px;height:100px;border:1px solid blue;&quot;&gt;
  我是标准div元素内容
&lt;/div&gt;
</code></pre><div style="width:50px;height:50px;border:1px solid red;float:left"><br>  我是悬浮元素<br></div><br><div style="width:100px;height:100px;border:1px solid blue;"><br>  我是标准div元素内容<br></div>

<p>这个时候，就需要清除浮动(clear:both)，另外，还可以通过clear:left|right来分别清除左右浮动：</p>
<pre><code>&lt;div style=&quot;width:50px;height:50px;border:1px solid red;float:left&quot;&gt;
  我是悬浮元素
&lt;/div&gt;
&lt;div style=&quot;width:100px;height:100px;border:1px solid blue;clear:both;&quot;&gt;
  我是标准div元素内容
&lt;/div&gt;
</code></pre><div style="width:50px;height:50px;border:1px solid red;float:left"><br>  我是悬浮元素<br></div><br><div style="width:100px;height:100px;border:1px solid blue;clear:both;"><br>  我是标准div元素内容<br></div>

<h3 id="1-3、奇怪的浮动效果"><a href="#1-3、奇怪的浮动效果" class="headerlink" title="1.3、奇怪的浮动效果"></a>1.3、奇怪的浮动效果</h3><p>在内容的浮动元素高度大于外部容器时，效果如下：</p>
<pre><code>&lt;div style=&quot;width:100px;border:1px solid blue;&quot;&gt;
  &lt;div style=&quot;width:50px;height:150px;border:1px solid red;float:right&quot;&gt;
    我是悬浮元素
  &lt;/div&gt;
  我是标准div元素内容
&lt;/div&gt;
</code></pre><div style="width:100px;border:1px solid blue;"><br>  <div style="width:50px;height:150px;border:1px solid red;float:right"><br>    我是悬浮元素<br>  </div><br>  我是标准div元素内容<br></div>

<div style="clear:both;"></div><br>    <strong>如何修复？</strong><br><br>可以通过clearfix样式来修复：<br><br>    <style><br>      .clearfix {<br>        overflow: auto;<br>        zoom: 1;/<em>针对IE需要额外关照</em>/<br>      }<br>    </style><br>    <div class="clearfix" style="width:100px;border:1px solid blue;"><br>      <div style="width:50px;height:150px;border:1px solid red;float:right"><br>        我是悬浮元素<br>      </div><br>      我是标准div元素内容<br>    </div>

<p><style><br>  .clearfix {<br>    overflow: auto;<br>    zoom: 1;/<em>针对IE需要额外关照</em>/<br>  }<br></style></p>
<div class="clearfix" style="width:100px;border:1px solid blue;"><br>  <div style="width:50px;height:150px;border:1px solid red;float:right"><br>    我是悬浮元素<br>  </div><br>  我是标准div元素内容<br></div>

<h2 id="2、CSS布局之百分比宽度"><a href="#2、CSS布局之百分比宽度" class="headerlink" title="2、CSS布局之百分比宽度"></a>2、CSS布局之百分比宽度</h2><p>百分比宽度可以非常容易的实现动态布局，但是当窗口变得很窄的时候，元素的展示可能会错乱。所以需要选择最合适的布局方式。</p>
<p>另外，不能使用min-width来修复这个问题，因为如果是左右结构，对左边的元素设定min-width，右边的元素是不会遵守的，可能会引起重叠。</p>
<h2 id="3、CSS布局之媒体查询（Media-Query）"><a href="#3、CSS布局之媒体查询（Media-Query）" class="headerlink" title="3、CSS布局之媒体查询（Media Query）"></a>3、CSS布局之媒体查询（Media Query）</h2><p>“响应式设计（Responsive Design）”是一种让网站针对不同的浏览器和设备“响应”不同显示效果的策略，这样可以让网站在任何情况下显示的很棒！</p>
<p>如果要兼容移动端，请加上如下类似meta</p>
<pre><code>&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, maximum-scale=2, minimum-scale=0.5, user-scalable=no&quot;&gt;
</code></pre><p>因为众所周知，手机端的屏幕分辨率相当多，所以可以强制指定屏幕的width是等于设备宽度的，忽略分辨率。<br>maximum-scale 是指最大缩放比例。</p>
<h2 id="4、CSS布局之column"><a href="#4、CSS布局之column" class="headerlink" title="4、CSS布局之column"></a>4、CSS布局之column</h2><p>CSS columns是较新的标准，不支持IE9及以下和Opera Mini，所以需要使用浏览器前缀。Column可以很轻松的实现文字的多列布局，示例如下：</p>
<pre><code>&lt;div style=&quot;width:150px;-webkit-column-count:3;-webkit-column-gap: 1em;&quot;&gt;
  CSS布局CSS布局CSS布局CSS布局CSS布局CSS布局CSS布局CSS布局CSS布局CSS布局
&lt;/div&gt;
</code></pre><div style="width:150px;-webkit-column-count:3;-webkit-column-gap: 1em;"><br>  CSS布局CSS布局CSS布局CSS布局CSS布局CSS布局CSS布局CSS布局CSS布局CSS布局<br></div>

<h2 id="5、CSS布局之flexbox"><a href="#5、CSS布局之flexbox" class="headerlink" title="5、CSS布局之flexbox"></a>5、CSS布局之flexbox</h2><p>flexbox布局模式被用来重新定义CSS中的布局方式。</p>
<pre><code>&lt;style&gt;
  .container{
    width: 80%;
    border: 1px solid red;
    height:50px;
    display: flex;
  }
&lt;/style&gt;
&lt;div class=&quot;container&quot;&gt;
  &lt;div style=&quot;width:100px;&quot;&gt;&lt;/div&gt;
  &lt;div style=&quot;flex:3;background:lightgray;&quot;&gt;1&lt;/div&gt;
  &lt;div style=&quot;flex:5;background:lightyellow;&quot;&gt;2&lt;/div&gt;
&lt;/div&gt;
</code></pre><p><style><br>  .container{<br>    width: 80%;<br>    border: 1px solid red;<br>    height:50px;<br>    display: flex;<br>  }<br></style></p>
<div class="container"><br>  <div style="width:100px;"></div><br>  <div style="flex:3;background:lightgray;">1</div><br>  <div style="flex:5;background:lightyellow;">2</div><br></div>

<p>分析一下以上代码，只需要在容器上设置display:flex，那么内部元素的如果设置了flex样式，那么就会按照flex进行计算，然后实现flex布局。</p>
<p>flex布局，还能实现简单的垂直居中布局。</p>
<pre><code>&lt;div class=&quot;container&quot; style=&quot;align-items: center; justify-content: center;&quot;&gt;
  我是垂直居中的元素
&lt;/div&gt;
</code></pre><div class="container" style="align-items: center; justify-content: center;"><br>  我是垂直居中的元素<br></div>

<p>其中，align-items设置水平居中，justify-content设置了垂直居中。</p>


    
    
    
  </section>
</article>
    </div>
  
    <div class='post-wrapper'>
      <article class="post reveal">
  <section class="meta">
    
    <h2 class="title">
      <a href="/blog/2017/02/21/前端相关/Nginx常规用法解析/">
        Nginx常规用法解析
      </a>
    </h2>
    
    <time>
      Feb 21, 2017
    </time>
		
  </section>
  <section class="article typo">
	  <h2 id="0、Nginx简介"><a href="#0、Nginx简介" class="headerlink" title="0、Nginx简介"></a>0、Nginx简介</h2><p><code>Nginx</code> 是时下最流行的静态Web服务器之一，使用它能快速的托管一个web站点。</p>
<p>当然，它的功能并不仅限于此，负载均衡，反向代理，它都非常拿手。</p>
<p>然而，要使用它，就不得不提到它的配置文件。本文就大致来了解下 <code>Nginx</code> 常规配置。</p>
<p><strong>注意：由于环境因素，该文所有测试均在Win10上使用 <code>nginx-1.11.5</code> 测试通过。</strong></p>
<h2 id="1、如何开始？"><a href="#1、如何开始？" class="headerlink" title="1、如何开始？"></a>1、如何开始？</h2><h3 id="1-1、安装"><a href="#1-1、安装" class="headerlink" title="1.1、安装"></a>1.1、安装</h3><p><strong>注意：该安装是指在Windows上安装 </strong></p>
<p>首先，我们进入 <code>Nginx</code> 的下载地址：<a href="https://nginx.org/en/download.html" target="_blank" rel="external">https://nginx.org/en/download.html</a>（书写该文时，<code>nginx</code> 最新版本是 <code>1.11.5</code>）。</p>
<p>然后，找到nginx的Windows压缩包并下载，然后解压到指定目录即可。</p>
<p><strong>提示：Linux下安装也是同样的思路，下载压缩包，解压缩。</strong></p>
<h3 id="1-2、启动"><a href="#1-2、启动" class="headerlink" title="1.2、启动"></a>1.2、启动</h3><p>解压好之后，进入解压目录，我们会看到一个 <code>nginx.exe</code>，它就是 <code>nginx</code> 的启动文件。</p>
<p>进入该目录的cmd环境，执行 <code>nginx</code> 即可启动 <code>nginx</code>，此时我们打开的是一个阻塞的控制台。当我们关闭控制台之后，<code>nginx</code> 服务也相应的关闭了。</p>
<p>大部分时候，我们需要它能在后台执行，此时我们可以使用 <code>start nginx</code> 来启动一个后台运行的 <code>nginx</code> 实例。</p>
<p>如果是线上环境，可能还要求它能够开机启动，此时我们可以采用把 <code>nginx</code> 作为Windows服务的方式来实现开机启动，具体做法请参考： <a href="http://www.spkevin.com/?p=946" target="_blank" rel="external">http://www.spkevin.com/?p=946</a>。</p>
<h3 id="1-3、重新载入配置"><a href="#1-3、重新载入配置" class="headerlink" title="1.3、重新载入配置"></a>1.3、重新载入配置</h3><p>当我们后台启动 <code>nginx</code> 之后，如果修改了配置文件，想重新载入配置怎么办呢？当然，我们可以停止，然后再启动。实际上，还有更简单的方法，执行如下命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 重新载入配置文件</span></div><div class="line">$ nginx <span class="_">-s</span> reload</div><div class="line"></div><div class="line"><span class="comment"># 重新打开日志文件</span></div><div class="line">$ nginx <span class="_">-s</span> reopen</div></pre></td></tr></table></figure>
<h3 id="1-4、停止服务"><a href="#1-4、停止服务" class="headerlink" title="1.4、停止服务"></a>1.4、停止服务</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 停止（快速停止，不保存相关信息，快）</span></div><div class="line">$ nginx <span class="_">-s</span> stop</div><div class="line"></div><div class="line"><span class="comment"># 退出（完整有序的停止，保存相关信息，慢）</span></div><div class="line">$ nginx <span class="_">-s</span> quit</div></pre></td></tr></table></figure>
<h2 id="2、托管静态目录"><a href="#2、托管静态目录" class="headerlink" title="2、托管静态目录"></a>2、托管静态目录</h2><p>托管静态目录是 <code>Nginx</code> 最常用的功能之一，该功能是将一个目录部署为一个静态的Web站点。</p>
<p>先使用 <code>start nginx</code> 启动 <code>nginx</code>（默认绑定的是80端口，可能会有冲突，需要修改下端口绑定）。</p>
<p><strong>修改端口绑定：在 <code>nginx/conf</code> 的目录下，打开 <code>nginx.conf</code> 配置文件，找到80，修改为另外一个端口号即可。</strong></p>
<p>启动之后，我们直接输入 <code>http://localhost:&lt;port&gt;</code> 即可查看到Nginx的欢迎页面。</p>
<p>先来分析下它的配置文件：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">http &#123;</div><div class="line">  ...</div><div class="line">  server &#123;</div><div class="line">    listen 7777;</div><div class="line"></div><div class="line">    location / &#123;</div><div class="line">      root html;  <span class="comment"># 从html相对目录查找内容</span></div><div class="line">      index index.html index.htm; <span class="comment"># 默认首页查找顺序</span></div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>什么意思呢？我们主要需要关注 <code>server/location</code> 节点，其中 <code>root属性</code> 表示去哪个目录查找文件，<code>index属性</code> 表示默认首页查找顺序。</p>
<h3 id="2-1、托管多个站点"><a href="#2-1、托管多个站点" class="headerlink" title="2.1、托管多个站点"></a>2.1、托管多个站点</h3><p>当我们要托管多个站点的时候，我们可以以同样的方式，创建多个 <code>server</code> 节点，这样就能监听不同的端口，也能托管不同的目录。</p>
<h3 id="2-2、有条件查找（复杂实例）"><a href="#2-2、有条件查找（复杂实例）" class="headerlink" title="2.2、有条件查找（复杂实例）"></a>2.2、有条件查找（复杂实例）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">server &#123;</div><div class="line">  listen 8101; <span class="comment"># 监听8101端口</span></div><div class="line">  server_name newegg-central-2.0; <span class="comment"># 设置server_name，类似iis的主机头 </span></div><div class="line">  root /dist;</div><div class="line">  index index.html; </div><div class="line"></div><div class="line">  location ~* \.(eot|ttf|woff|woff2)$ &#123; <span class="comment"># 针对字体请求做特殊处理</span></div><div class="line">    add_header x-nc2-server <span class="variable">$server_addr</span>;</div><div class="line">    add_header Access-Control-Allow-Origin <span class="string">'*'</span>; <span class="comment"># 允许字体跨域</span></div><div class="line">  &#125; </div><div class="line"></div><div class="line">  location ~* \.[a-zA-Z0-9]+$ &#123; <span class="comment"># 针对有后缀名的请求特殊处理，直接返回</span></div><div class="line">    add_header x-nc2-server <span class="variable">$server_addr</span>; </div><div class="line">  &#125;</div><div class="line"></div><div class="line">  location / &#123; <span class="comment"># 针对不满足上述条件的请求做处理</span></div><div class="line">    add_header x-nc2-server <span class="variable">$server_addr</span>;</div><div class="line">    access_log off;</div><div class="line">    error_page 404 = /index.html;  <span class="comment"># 如果遇到了404，则返回首页（为浏览器history api做的特殊处理，客户端路由）</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="3、反向代理"><a href="#3、反向代理" class="headerlink" title="3、反向代理"></a>3、反向代理</h2><p>反向代理是根据客户端的请求，从后端的服务器上获取资源，然后再将这些资源返回给客户端。所以我们需要一个后端，此处随便找一个站点来测试，如 “www.newegg.com”，让如何实现我们访问 localhost:7778，就能返回 <code>newegg</code>的数据呢？</p>
<p>配置如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">server &#123;</div><div class="line">  listen 7778; <span class="comment"># 监听7778端口</span></div><div class="line">  location / &#123;</div><div class="line">    proxy_pass http://www.newegg.com; <span class="comment">#根据客户端请求返回newegg的数据</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="3-1、利用反向代理，处理跨域"><a href="#3-1、利用反向代理，处理跨域" class="headerlink" title="3.1、利用反向代理，处理跨域"></a>3.1、利用反向代理，处理跨域</h3><p>跨域是前后端分离项目中，比较容易遇到的一个问题，在这里演示下，如何利用Nginx来避免跨域问题。</p>
<p>该方法的原理是，将API通过反向代理，让它看起来和站点是在同一个域，避免发起跨域请求。</p>
<p>先在7777端口托管的index.html中添加如下代码：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></div><div class="line">  <span class="keyword">let</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</div><div class="line">  xhr.open(<span class="string">'GET'</span>, <span class="string">'http://localhost:7779'</span>, <span class="literal">true</span>);</div><div class="line">  xhr.send();</div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure>
<p>访问 <code>http://localhost:7777</code>，可以明显的看到有跨域请求，接下来，我们来解决该问题，</p>
<p>首先，修改请求域名为： <code>http://localhost:7777/api</code> 这样就变成了同域，然后配置 <code>nginx</code>，把 <code>/api</code>的请求转发到真实的后端api上。</p>
<p>配置如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">location / &#123;</div><div class="line">  root html;</div><div class="line">  index index.html index.htm;</div><div class="line">&#125;</div><div class="line"></div><div class="line">location /api &#123; <span class="comment"># 把所有已/api 开头的请求，转发到7779端口</span></div><div class="line">  proxy_pass http://localhost:7779;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="4、负载均衡"><a href="#4、负载均衡" class="headerlink" title="4、负载均衡"></a>4、负载均衡</h2><p>负载均衡是将应用部署到多个地方，然后用统一入口访问，解决单点故障问题。</p>
<p>先用 <code>Node</code> 创建两个 <code>Web server</code>，代码如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Server 1</span></div><div class="line"><span class="keyword">const</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>);</div><div class="line"></div><div class="line"><span class="keyword">let</span> server = http.createServer(<span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</div><div class="line">  res.write(<span class="string">'Server 1, port: 7801'</span>);</div><div class="line">  res.end();</div><div class="line">&#125;);</div><div class="line"></div><div class="line">server.listen(<span class="number">7801</span>, err =&gt; &#123;</div><div class="line">  <span class="keyword">if</span>(err) <span class="keyword">return</span> <span class="built_in">console</span>.error(err);</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'server 1 started.port: 7801'</span>);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>为了方便查看效果，我们将 <code>Server 2</code> 的端口修改为 <code>7802</code>，输出的文字也稍微变下。</p>
<p>接下来我们来进行负载均衡的配置，在 <code>nginx</code> 中，负载均衡有几种方式：</p>
<ol>
<li>轮询（默认方式）</li>
<li>加权轮询（轮询升级版，可以指定权重）</li>
<li>ip_hash（通过ip计算hash，然后跳转到指定服务器）</li>
<li>fair（第三方，根据后台服务器的响应时间来分配请求，响应时间短，优先分配，适应性较强）</li>
<li>upstream_hash（ip hash升级版，可以指定hash因子）</li>
</ol>
<p>这里我们就简单测试下前两种方式，实现配置如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">http &#123;</div><div class="line">  ...</div><div class="line">  upstream test_server &#123;</div><div class="line">    server localhost:7801; <span class="comment"># 后端服务器1,</span></div><div class="line">    server localhost:7802; <span class="comment"># 后端服务器2</span></div><div class="line">  &#125;</div><div class="line"></div><div class="line">  server &#123;</div><div class="line">    listen 7779;</div><div class="line">    location / &#123;</div><div class="line">      proxy_pass http://test_server; <span class="comment"># 负载均衡 </span></div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>此时，访问 <code>http://localhost:7779</code>，会发现 Server1 和 Server2 循环命中，这就是默认的轮询方式负载。</p>
<p>接着，测试带权重的负载，修改配置如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">http &#123;</div><div class="line">  ...</div><div class="line">  upstream test_server &#123;</div><div class="line">    server localhost:7801 weight=2; <span class="comment"># 后端服务器1，权重2</span></div><div class="line">    server localhost:7802 weight=1; <span class="comment"># 后端服务器2，权重1</span></div><div class="line">  &#125;</div><div class="line"></div><div class="line">  server &#123;</div><div class="line">    listen 7779;</div><div class="line">    location / &#123;</div><div class="line">      proxy_pass http://test_server; <span class="comment"># 负载均衡 </span></div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>此时，再多次请求 <code>http://localhost:7779</code>，会发现 Server1 出现两次，Server2 出现一次交替命中。</p>
<h2 id="5、更多配置"><a href="#5、更多配置" class="headerlink" title="5、更多配置"></a>5、更多配置</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">http &#123;</div><div class="line">  ...</div><div class="line">  gzip on; <span class="comment"># 开启Gzip</span></div><div class="line"></div><div class="line">  server &#123;</div><div class="line">    ...</div><div class="line">    location / &#123;</div><div class="line">      add_header &lt;field&gt; value [always]; <span class="comment"># 返回时追加Header</span></div><div class="line">      proxy_set_header &lt;field&gt; &lt;value&gt;; <span class="comment"># 反向代理时，发送Header </span></div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>更多指令，请查询：<a href="https://nginx.org/en/docs/dirindex.html" target="_blank" rel="external">https://nginx.org/en/docs/dirindex.html</a></p>
<p>想了解完整配置，请查阅：<a href="https://nginx.org/en/docs/" target="_blank" rel="external">https://nginx.org/en/docs/</a></p>
<h2 id="6、其他"><a href="#6、其他" class="headerlink" title="6、其他"></a>6、其他</h2><h3 id="6-1、测试使用的完整Nginx配置文件"><a href="#6-1、测试使用的完整Nginx配置文件" class="headerlink" title="6.1、测试使用的完整Nginx配置文件"></a>6.1、测试使用的完整Nginx配置文件</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="comment">#user  nobody;</span></div><div class="line">worker_processes  1;</div><div class="line"></div><div class="line"><span class="comment">#error_log  logs/error.log;</span></div><div class="line"><span class="comment">#error_log  logs/error.log  notice;</span></div><div class="line"><span class="comment">#error_log  logs/error.log  info;</span></div><div class="line"></div><div class="line"><span class="comment">#pid        logs/nginx.pid;</span></div><div class="line"></div><div class="line"></div><div class="line">events &#123;</div><div class="line">    worker_connections  1024;</div><div class="line">&#125;</div><div class="line"></div><div class="line">http &#123;</div><div class="line">    include       mime.types;</div><div class="line">    default_type  application/octet-stream;</div><div class="line"></div><div class="line">    <span class="comment"># 定制日志格式</span></div><div class="line">    <span class="comment">#log_format  main  '$remote_addr - $remote_user [$time_local] "$request" '</span></div><div class="line">    <span class="comment">#                  '$status $body_bytes_sent "$http_referer" '</span></div><div class="line">    <span class="comment">#                  '"$http_user_agent" "$http_x_forwarded_for"';</span></div><div class="line"></div><div class="line">    <span class="comment">#access_log  logs/access.log  main;</span></div><div class="line"></div><div class="line">    sendfile        on;</div><div class="line">    <span class="comment">#tcp_nopush     on;</span></div><div class="line"></div><div class="line">    <span class="comment"># 定制保持连接超时时间</span></div><div class="line">    <span class="comment">#keepalive_timeout  0;</span></div><div class="line">    keepalive_timeout  65;</div><div class="line"></div><div class="line">    <span class="comment"># 是否启用gzip</span></div><div class="line">    <span class="comment">#gzip  on;</span></div><div class="line"></div><div class="line">    upstream test_server &#123;</div><div class="line">      server localhost:7801 weight=2; </div><div class="line">      server localhost:7802 weight=1;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    server &#123;</div><div class="line">        listen       7777;</div><div class="line">        server_name  localhost;</div><div class="line"></div><div class="line">        <span class="comment"># 设置编码格式</span></div><div class="line">        <span class="comment">#charset koi8-r;</span></div><div class="line"></div><div class="line">        <span class="comment"># 是否开启访问日志</span></div><div class="line">        <span class="comment">#access_log  logs/host.access.log  main;</span></div><div class="line"></div><div class="line">        location / &#123;</div><div class="line">            root   html;</div><div class="line">            index  index.html index.htm;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        location /api &#123;</div><div class="line">          proxy_pass http://localhost:7779;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="comment"># 指定错误页面</span></div><div class="line">        <span class="comment">#error_page  404              /404.html;</span></div><div class="line"></div><div class="line">        <span class="comment"># redirect server error pages to the static page /50x.html</span></div><div class="line">        <span class="comment">#</span></div><div class="line">        error_page   500 502 503 504  /50x.html;</div><div class="line">        location = /50x.html &#123;</div><div class="line">            root   html;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="comment"># proxy the PHP scripts to Apache listening on 127.0.0.1:80</span></div><div class="line">        <span class="comment">#</span></div><div class="line">        <span class="comment">#location ~ \.php$ &#123;</span></div><div class="line">        <span class="comment">#    proxy_pass   http://127.0.0.1;</span></div><div class="line">        <span class="comment">#&#125;</span></div><div class="line"></div><div class="line">        <span class="comment"># 托管PHP的相关配置</span></div><div class="line">        <span class="comment"># pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000</span></div><div class="line">        <span class="comment">#</span></div><div class="line">        <span class="comment">#location ~ \.php$ &#123;</span></div><div class="line">        <span class="comment">#    root           html;</span></div><div class="line">        <span class="comment">#    fastcgi_pass   127.0.0.1:9000;</span></div><div class="line">        <span class="comment">#    fastcgi_index  index.php;</span></div><div class="line">        <span class="comment">#    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;</span></div><div class="line">        <span class="comment">#    include        fastcgi_params;</span></div><div class="line">        <span class="comment">#&#125;</span></div><div class="line"></div><div class="line">        <span class="comment"># deny access to .htaccess files, if Apache's document root</span></div><div class="line">        <span class="comment"># concurs with nginx's one</span></div><div class="line">        <span class="comment">#</span></div><div class="line">        <span class="comment">#location ~ /\.ht &#123;</span></div><div class="line">        <span class="comment">#    deny  all;</span></div><div class="line">        <span class="comment">#&#125;</span></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    server &#123;</div><div class="line">      listen 7778;</div><div class="line">      location / &#123;</div><div class="line">        proxy_pass http://www.newegg.com;</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    server &#123;</div><div class="line">      listen 7779;</div><div class="line">      location / &#123;</div><div class="line">        proxy_pass http://test_server;</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment"># another virtual host using mix of IP-, name-, and port-based configuration</span></div><div class="line">    <span class="comment">#</span></div><div class="line">    <span class="comment">#server &#123;</span></div><div class="line">    <span class="comment">#    listen       8000;</span></div><div class="line">    <span class="comment">#    listen       somename:8080;</span></div><div class="line">    <span class="comment">#    server_name  somename  alias  another.alias;</span></div><div class="line"></div><div class="line">    <span class="comment">#    location / &#123;</span></div><div class="line">    <span class="comment">#        root   html;</span></div><div class="line">    <span class="comment">#        index  index.html index.htm;</span></div><div class="line">    <span class="comment">#    &#125;</span></div><div class="line">    <span class="comment">#&#125;</span></div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment"># 托管HTTPS</span></div><div class="line">    <span class="comment"># HTTPS server</span></div><div class="line">    <span class="comment">#</span></div><div class="line">    <span class="comment">#server &#123;</span></div><div class="line">    <span class="comment">#    listen       443 ssl;</span></div><div class="line">    <span class="comment">#    server_name  localhost;</span></div><div class="line"></div><div class="line">    <span class="comment">#    ssl_certificate      cert.pem;</span></div><div class="line">    <span class="comment">#    ssl_certificate_key  cert.key;</span></div><div class="line"></div><div class="line">    <span class="comment">#    ssl_session_cache    shared:SSL:1m;</span></div><div class="line">    <span class="comment">#    ssl_session_timeout  5m;</span></div><div class="line"></div><div class="line">    <span class="comment">#    ssl_ciphers  HIGH:!aNULL:!MD5;</span></div><div class="line">    <span class="comment">#    ssl_prefer_server_ciphers  on;</span></div><div class="line"></div><div class="line">    <span class="comment">#    location / &#123;</span></div><div class="line">    <span class="comment">#        root   html;</span></div><div class="line">    <span class="comment">#        index  index.html index.htm;</span></div><div class="line">    <span class="comment">#    &#125;</span></div><div class="line">    <span class="comment">#&#125;</span></div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>


    
    
    
  </section>
</article>
    </div>
  
    <div class='post-wrapper'>
      <article class="post reveal">
  <section class="meta">
    
    <h2 class="title">
      <a href="/blog/2017/02/21/前端相关/Web API接口之Geolocation/">
        Web API接口之Geolocation
      </a>
    </h2>
    
    <time>
      Feb 21, 2017
    </time>
		
  </section>
  <section class="article typo">
	  <h2 id="0、关于Geolocation"><a href="#0、关于Geolocation" class="headerlink" title="0、关于Geolocation"></a>0、关于Geolocation</h2><p>Geolocation，地理位置API。用于获取用户的位置信息。它不算是现有的HTML5标准的“直系”成员，但是是W3C的一个标准。它几乎就是一个真正的JavaScript API！</p>
<h2 id="1、位置相关"><a href="#1、位置相关" class="headerlink" title="1、位置相关"></a>1、位置相关</h2><h3 id="1-1、经纬度表示位置"><a href="#1-1、经纬度表示位置" class="headerlink" title="1.1、经纬度表示位置"></a>1.1、经纬度表示位置</h3><p>要想知道用户的位置，就需要有一个坐标系统，这就是我们的经纬度。一般我们用度/分/秒表示经纬度，如果需要将经纬度转换为小数，可以使用如下函数：</p>
<pre><code>function degreesToDecimal(degrees, minutes, seconds){
  return degrees + (minutes / 60) + (seconds / 3600);
}
</code></pre><h3 id="1-2、API如何确定你的位置"><a href="#1-2、API如何确定你的位置" class="headerlink" title="1.2、API如何确定你的位置"></a>1.2、API如何确定你的位置</h3><p>浏览器要获取你的位置信息，并不要求你非得使用最新的智能手机，即使桌面浏览器也能获取你的位置。那么是如何获取到位置的呢？</p>
<p>其实，获取位置信息的方式有很多，比如：</p>
<ol>
<li>IP地址 –通过ip地址库获取你的位置</li>
<li>GPS  –通过全球定位系统获取你的位置（高精度）</li>
<li>蜂窝电话  –通过三角定位获取你的位置</li>
<li>Wi-Fi  – 同样适用类似蜂窝电话的三角定位获取位置</li>
</ol>
<p>我们没办法知道设备是使用的何种方法获取我们的位置信息，一些聪明的浏览器很可能会使用多种方式来确定你的位置。</p>
<h2 id="2、如何使用Geolocation"><a href="#2、如何使用Geolocation" class="headerlink" title="2、如何使用Geolocation"></a>2、如何使用Geolocation</h2><p>在使用Geolocation之前，我们需要先是否支持，通过如下代码：</p>
<pre><code>if(navigator.geolocation){
  //Supported.
} else {
  window.alert(&apos;No geolocation support.&apos;);
}
</code></pre><h3 id="2-1、获取位置"><a href="#2-1、获取位置" class="headerlink" title="2.1、获取位置"></a>2.1、获取位置</h3><p>获取位置信息的方法是一个异步方法，我们应该如下来使用它：</p>
<pre><code>if(navigator.geolocation){
  var callback = function(pos){
    console.log(&apos;你的位置是：&apos;, pos);
  };
  navigator.geolocation.getCurrentPosition(callback);
} else {
  window.alert(&apos;No geolocation support.&apos;);
}
</code></pre><p>其中pos长什么样呢？大概是如下这个样子的：</p>
<pre><code>{
  coords： { // Coordinates
    accuracy: 137082,
    altitude: null,
    altitudeAccuracy: null,
    heading: null,
    latitude: 24.1848198,
    longitude: 120.63149479999998,
    speed: null
  },
  timestamp: 1453877895563
}
</code></pre><p>其中latitude和longitude就是我们的经纬度了。</p>
<p>该方法的语法是：navigator.geolocation.getCurrentPosition(success[, error[, options]])，具体参数含义，请接着往下看。</p>
<h3 id="2-2、监控位置变化"><a href="#2-2、监控位置变化" class="headerlink" title="2.2、监控位置变化"></a>2.2、监控位置变化</h3><p>在2.1中，我们知道如何获取位置，那如何监控位置变化呢？很容易相当的办法，就是我们定时去获取位置信息，然后比对。那么有没有更好的方式呢？当然，Geolocation API已经帮我们考虑好了。如下：</p>
<pre><code>//正常时，会获取到一个地理位置信息
var watchSuccess = function(pos){
  var latitude = pos.coords.latitude;
  var longitude = pos.coords.longitude;
  console.log(&apos;你的经纬度是：&apos;, latitude, longitude);
};
//错误时，函数会接收一个错误对象
var watchError = function(err){
  console.warn(err, err.code, err.message);
};
var watcherId = navigator.geolocation.watchPosition(watchSuccess, watchError);
</code></pre><p>watchPosition方法的语法是：id = navigator.geolocation.watchPosition(success[, error[, options]])。所以，我们还可以针对这个方法设置参数：</p>
<pre><code>var options = {
  enableHighAccuracy: false, //默认false，为true时，则选择最高的精度获取位置
  timeout: 5000, //每次获取位置信息的最长时间，默认是无限的
  maximumAge: 0 // 缓存时间（毫秒），如果为0，则每次获取最新的
};
</code></pre><h3 id="2-3-清除监控"><a href="#2-3-清除监控" class="headerlink" title="2.3 清除监控"></a>2.3 清除监控</h3><p>既然我们有监控方法，那么该如何停止呢？这就要借助清除监控的方法了，代码如下：</p>
<pre><code>navigator.geolocation.clearWatch(watcherId);
</code></pre><p>watcherId是2.2中监控时的返回值。</p>
<h3 id="2-4、如何计算距离？"><a href="#2-4、如何计算距离？" class="headerlink" title="2.4、如何计算距离？"></a>2.4、如何计算距离？</h3><p>给予两个坐标点，如何计算两者之间的距离呢？一般采用半正矢（Haversine）公式，具体代码如下：</p>
<p>  function degreesToRadians(degrees){<br>    var radians = (degrees * Math.PI) / 180;<br>    return radians;<br>  }</p>
<p>  function computeDistince(startCoords, destCoords){<br>    var Radius = 6371; //每度在地球上的距离（km）</p>
<pre><code>var startLatRads = degreesToRadians(startCoords.latitude);
var startLongRads = degreesToRadians(startCoords.longitude);
var destLatRads = degreesToRadians(destCoords.latitude);
var destLongRads = degreesToRadians(destCoords.longitude);

var distince = Math.acos(
  Math.sin(startLatRads) * Math.sin(destLatRads) + 
  Math.cos(startLatRads) * Math.cos(destLatRads) * 
  Math.cos(startLongRads - destLongRads)
) * Radius;
return distince;
</code></pre><p>  }</p>
<h2 id="3、扩展"><a href="#3、扩展" class="headerlink" title="3、扩展"></a>3、扩展</h2><p>地理位置API单独使用意义不大，一般来说，结合地图就可以实现很复杂的功能了。</p>
<p>待续…</p>


    
    
    
  </section>
</article>
    </div>
  
    <div class='post-wrapper'>
      <article class="post reveal">
  <section class="meta">
    
    <h2 class="title">
      <a href="/blog/2017/02/21/前端相关/TypeScript配置文件tsconfig简析/">
        TypeScript配置文件tsconfig简析
      </a>
    </h2>
    
    <time>
      Feb 21, 2017
    </time>
		
  </section>
  <section class="article typo">
	  <h2 id="0、前言"><a href="#0、前言" class="headerlink" title="0、前言"></a>0、前言</h2><p>在使用VsCode编写TypeScript时，VsCode提供了一个tsconfig.json辅助我们设置TypeScript的配置项，另外使用gulp-typescript或者是webpack编译ts文件时，都可以用到这个配置项来确定如何生成最终的js文件。</p>
<p>那tsconfig.json到底有哪些常用属性，它们又起到什么作用呢？下文将为你一一揭晓。</p>
<h2 id="1、tsconfig-json"><a href="#1、tsconfig-json" class="headerlink" title="1、tsconfig.json"></a>1、tsconfig.json</h2><h3 id="1-1、compilerOptions"><a href="#1-1、compilerOptions" class="headerlink" title="1.1、compilerOptions"></a>1.1、compilerOptions</h3><p>tsconfig.json文件中的 <code>compilerOptions</code> 属性用于确定如何编译ts文件。</p>
<p>其中大概有如下属性：</p>
<p>1.1.1、<strong>module: enum</strong></p>
<p><code>module</code> 用于指定模块的代码生成规则，可以使用 <code>commonjs</code> 、 <code>amd</code> 、 <code>umd</code> 、 <code>system</code> 、 <code>es6</code> 、 <code>es2015</code> 、 <code>none</code> 这些选项。</p>
<p>选择commonJS，会生成符合commonjs规范的文件，使用amd，会生成满足amd规范的文件，使用system会生成使用ES6的system.import的代码。使用es6或者是es2015会生产包含ES6特性的代码。</p>
<p>1.1.2、<strong>target: enum</strong></p>
<p><code>target</code> 用于指定生成代码的兼容版本，可以从es3,es5,es2015,es6中选择一个，如果不设置，默认生产的代码兼容到es3。</p>
<p>1.1.3、<strong>sourceMap: boolean</strong></p>
<p><code>sourceMap</code> 是是否生成SourceMap的开关，如果设置为true，则会生成.map文件。</p>
<p>1.1.4、 <strong>noImplicitAny: boolean</strong></p>
<p><code>noImplicitAny</code> 当表达式和申明 类型为any时，是否需要发出警告，设置true，则不警告</p>
<p>1.1.5、 <strong>removeComments: boolean</strong></p>
<p>用于指定是否需要输出注释，设置为true，则不输出注释。</p>
<p>1.1.6、 <strong>charset: string</strong></p>
<p>用于指定ts文件的编码格式</p>
<p>1.1.7、 <strong>declaration: boolean</strong></p>
<p>是否需要生成定义文件d.ts，设置为true，则生成。</p>
<p>1.1.8、 <strong>diagnostics: boolean</strong></p>
<p>是否需要显示诊断信息，设置为true，则显示。</p>
<p>1.1.9、 <strong>emitBOM: boolean</strong></p>
<p>是否需要在输出文件的开头发出一个UTF-8字节顺序标记，设置为true，则输出。</p>
<p>1.1.10、<strong>inlineSourceMap: boolean</strong></p>
<p>是否需要将sourceMap文件生成到js文件中，设置为true，则生成到js文件中。</p>
<p><strong>注：此选项和sourceMap、mapRoot选项冲突，会优先使用inlineSouceMap</strong></p>
<p>1.1.11、<strong>inlineSources： boolean</strong></p>
<p>用于指定生成的source内容是否inline，如果设置为true，则inline展示（从测试的效果来看，就是生成在js文件中的source map内容要多一些）</p>
<p><strong>注：该设置项依赖inlineSouceMap设置为true</strong></p>
<p>1.1.12、<strong>jsx: enum</strong></p>
<p>用于指定按照何种方式生成jsx代码，可选react和preserve。</p>
<p>1.1.13、<strong>reactNamespace: string</strong></p>
<p>配置jsx属性使用，指定生成react代码时，需要使用的命名空间。默认””</p>
<p>1.1.14、<strong>listFiles: boolean</strong></p>
<p>编译时是否需要打印文件列表，设置为true，则打印。默认false</p>
<p>1.1.15、<strong>locale: string</strong></p>
<p>用于指定本地化错误信息，如果设定为en-us，那么错误信息将显示英文。默认””</p>
<p>1.1.16、<strong>mapRoot: string(uri)</strong></p>
<p>指定map文件的跟路径，该选项的值影响.map文件中的sources属性。默认””</p>
<p><strong>注：该选项依赖sourceMap: true</strong></p>
<p>1.1.17、<strong>newLine: enum</strong></p>
<p>指定换行符。可选 <code>CRLF</code> 和 <code>LF</code> 两种，前者是回车换行，后者是换行。默认是回车换行</p>
<p>1.1.18、<strong>noEmit: boolean</strong></p>
<p>当设置为true时，将不会输出</p>
<p>1.1.19、<strong>noEmitHelpers: boolean</strong></p>
<p>设置为true时，不会生成自定义的helper函数。</p>
<p>1.1.20、<strong>noEmitOnError: boolean</strong></p>
<p>设置为true时，如果遇到了错误，就不再输出</p>
<p>1.1.21、<strong>noLib: boolean</strong></p>
<p>设置为true时，将不会包含默认的库，如（lib.d.ts）,此时有可能导致找不到Array，String等对象</p>
<p>1.1.22、<strong>noResolve: boolean</strong></p>
<p>设置为true时，不使用三斜杠引入模块，需要从编译的文件列表中添加。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/// &lt;reference path="" /&gt;</span></div><div class="line"><span class="keyword">import</span> PI <span class="keyword">from</span> <span class="string">'./2A.ts'</span>;</div></pre></td></tr></table></figure>
<p>1.1.23、<strong>skipDefaultLibCheck: boolean</strong></p>
<p>设置为true时，将跳过默认库检查。</p>
<p>1.1.24、<strong>outFile: string(uri)</strong></p>
<p>设置输出文件，会将多个ts输入文件合并到该文件中</p>
<p>1.1.25、<strong>outDir: string(uri)</strong></p>
<p>指定输出文件的根目录。</p>
<p>1.1.26、<strong>preserveConstEnums: boolean</strong></p>
<p>设置为true时，生成代码时不会删除常量枚举声明。</p>
<p>1.1.27、<strong>pretty: boolean</strong></p>
<p>当设置为true时，错误信息，跟踪信息将带有颜色和样式</p>
<p>1.1.28、<strong>noImplicitUseStrict: boolean</strong></p>
<p>当设置为true时，编译输出时不会调用’use strict’指令（也就是不生成use strict）</p>
<p>1.1.29、<strong>rootDir: string(uri)</strong></p>
<p>指定输入文件的根目录。rootDir应包含所有的源文件。</p>
<p>1.1.30、<strong>isolatedModules: boolean</strong></p>
<p>设置为true时，无条件的触发导入未解决的文件。</p>
<p>1.1.31、<strong>sourceRoot: string(uri)</strong></p>
<p>设置在调试时定位的目标文件根目录</p>
<p>1.1.32、<strong>suppressExcessPropertyErrors: boolean</strong></p>
<p>设置为true时，禁止过剩的对象字面量属性检查</p>
<p>1.1.33、<strong>suppressImplicitAnyIndexErrors: boolean</strong></p>
<p>Suppress noImplicitAny errors for indexing objects lacking index signatures.</p>
<p>1.1.34、<strong>stripInternal: boolean</strong></p>
<p>设置为true，则遇到@internal注解时，不会触发代码定义。</p>
<p>1.1.35、<strong>watch: boolean</strong></p>
<p>设置为true时，将监视文件变化。当文件变化时，自动编译</p>
<p>1.1.36、<strong>experimentalDecorators: boolean</strong></p>
<p>设置为true，则支持ES7的装饰器特性</p>
<p>1.1.37、<strong>emitDecoratorMetadata: boolean</strong></p>
<p>设置为true，则使用元数据特性</p>
<p>1.1.38、<strong>moduleResolution: string</strong></p>
<p>指定模块的解析策略，Node或者是classic，默认是classic。</p>
<p>1.1.39、<strong>allowUnusedLabels: boolean</strong></p>
<p>设置为true时，允许没有用到的标签。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">l: do&#123;</div><div class="line">  console.log(&apos;abc&apos;);</div><div class="line">&#125;while (1 !== 1);</div></pre></td></tr></table></figure>
<p>以上代码有个未使用的标签l，默认是会报错的。</p>
<p>1.1.40、<strong>noImplicitReturns: boolean</strong></p>
<p>设置为true时，如果不是函数中的所有路径都有返回值，则提示Error。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> a = <span class="number">2</span>;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">fun</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">if</span>(a === <span class="number">1</span>)&#123;</div><div class="line">    <span class="keyword">return</span> <span class="string">'abc'</span>;</div><div class="line">  &#125;</div><div class="line">  <span class="comment">//fun函数只有当a = 1的时候，才有确定的返回值。</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>1.1.41、<strong>noFallthroughCasesInSwitch: boolean</strong></p>
<p>设置为true时，将严格校验switch-case语法。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">fun2</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">let</span> key = <span class="string">'ab'</span>;</div><div class="line">  <span class="keyword">switch</span> (key) &#123;</div><div class="line">    <span class="keyword">case</span> <span class="string">'ab'</span>:</div><div class="line">      <span class="built_in">console</span>.log(<span class="string">'abc'</span>);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>以上代码默认情况不会报错，当设置noFallthroughCasesInSwitch: true时，则会提示错误。</p>
<p>1.1.42、<strong>allowUnreachableCode: boolean</strong></p>
<p>设置为true时，如果有无法访问的代码，也不会报错。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">fun</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="string">'abc'</span>;</div><div class="line">  <span class="keyword">return</span> <span class="string">'ccc'</span>; <span class="comment">//默认会报错，设置allowUnreachableCode为true时，则不报错</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>1.1.43、<strong>forceConsistentCasingInFileNames: boolean</strong></p>
<p>设置为true时，将强制区分大小写。默认为false。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//2a.ts</span></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> PI = <span class="number">3.1415926</span>;</div><div class="line"><span class="comment">//1a.ts</span></div><div class="line"><span class="keyword">import</span> PI <span class="keyword">from</span> <span class="string">'./2A.ts'</span>;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">fun</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> PI;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>以上代码默认可以通过，当强制区分大小写时，则提示错误 ‘2a’ !== ‘2A’</p>
<p>1.1.44、<strong>allowSyntheticDefaultImports: boolean</strong></p>
<p>设置为true时，则允许从没有默认导出的模块中默认导入(也就是不做检查)。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//2.ts</span></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> PI = <span class="number">3.1415926</span>;</div><div class="line"><span class="comment">//1.ts</span></div><div class="line"><span class="keyword">import</span> PI <span class="keyword">from</span> <span class="string">'./2.ts'</span>;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">fun</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> PI;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>以上代码，默认是会报错的，当设置allowSyntheticDefaultImports时，则不会报错。</p>
<p>1.1.45、<strong>allowJs: boolean</strong></p>
<p>当设置为true时，js文件也会被编译。</p>
<p><strong>注意：编译js文件时，如果不另外设置outFile，将不会成功，因为不能够重写源代码文件</strong></p>
<h3 id="1-2、compileOnSave"><a href="#1-2、compileOnSave" class="headerlink" title="1.2、compileOnSave"></a>1.2、compileOnSave</h3><p>该属性用于启用保存时编译功能。</p>
<p><em>**注意：当前仅仅只有VS2015配置TypeScript1.8.4以后或者在atom中搭配atom-typescript插件才有效</em></p>
<h3 id="1-3、exclude"><a href="#1-3、exclude" class="headerlink" title="1.3、exclude"></a>1.3、exclude</h3><p>exclude用于排除不需要编译的ts文件。该属性和files属性冲突。两者只能设置其一。</p>
<h3 id="1-4、files"><a href="#1-4、files" class="headerlink" title="1.4、files"></a>1.4、files</h3><p>当files属性不存在时，编译器会编译当前目录和子目录中的所有文件。当files属性存在是，仅仅是编译files列表中的文件。</p>
<p>该属性和exclude属性冲突。如果同时指定了exclude和files，则files属性优先。</p>
<h2 id="2、常用tsconfig配置"><a href="#2、常用tsconfig配置" class="headerlink" title="2、常用tsconfig配置"></a>2、常用tsconfig配置</h2><figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">"compilerOptions"</span>: &#123;</div><div class="line">    <span class="attr">"target"</span>: <span class="string">"ES5"</span>,</div><div class="line">    <span class="attr">"module"</span>: <span class="string">"commonjs"</span>,</div><div class="line">    <span class="attr">"emitDecoratorMetadata"</span>: <span class="literal">true</span>,</div><div class="line">    <span class="attr">"experimentalDecorators"</span>: <span class="literal">true</span>,</div><div class="line">    <span class="attr">"sourceMap"</span>: <span class="literal">true</span>,</div><div class="line">    <span class="attr">"noEmitHelpers"</span>: <span class="literal">true</span></div><div class="line">  &#125;,</div><div class="line">  <span class="attr">"exclude"</span>: [</div><div class="line">    <span class="string">"node_modules"</span>,</div><div class="line">    <span class="string">"typings/main"</span>,</div><div class="line">    <span class="string">"typings/main.d.ts"</span></div><div class="line">  ],</div><div class="line">  <span class="attr">"compileOnSave"</span>: <span class="literal">false</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="3、参考资料"><a href="#3、参考资料" class="headerlink" title="3、参考资料"></a>3、参考资料</h2><ul>
<li><a href="https://www.typescriptlang.org/docs/handbook/tsconfig-json.html" target="_blank" rel="external">https://www.typescriptlang.org/docs/handbook/tsconfig-json.html</a></li>
<li><a href="http://json.schemastore.org/tsconfig" target="_blank" rel="external">http://json.schemastore.org/tsconfig</a></li>
</ul>


    
    
    
  </section>
</article>
    </div>
  
    <div class='post-wrapper'>
      <article class="post reveal">
  <section class="meta">
    
    <h2 class="title">
      <a href="/blog/2017/02/21/前端相关/Webpack In Angular2/">
        Webpack In Angular2
      </a>
    </h2>
    
    <time>
      Feb 21, 2017
    </time>
		
  </section>
  <section class="article typo">
	  <h2 id="0、前言"><a href="#0、前言" class="headerlink" title="0、前言"></a>0、前言</h2><p>当下Angular2是比较值得关注的技术了，想要把Angular2跑起来，还是比较容易的。但</p>
<p>在这里，我要做的是搭建一个Angular2的开发环境，那么就一步一步来尝试下。</p>
<h2 id="1、搭建开发环境"><a href="#1、搭建开发环境" class="headerlink" title="1、搭建开发环境"></a>1、搭建开发环境</h2><h3 id="1-1、创建项目"><a href="#1-1、创建项目" class="headerlink" title="1.1、创建项目"></a>1.1、创建项目</h3><p>新建目录 <code>webpack-in-angular2</code>，然后进入目录执行 <code>npm init -f</code> 创建好 <code>package.json</code> 文件。</p>
<p>打开package.json文件。新建属性 <code>dependencies</code> ，并赋值如下：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">"dependencies"</span>: &#123;</div><div class="line">    <span class="attr">"@angular/common"</span>: <span class="string">"^2.0.0-rc.1"</span>,</div><div class="line">    <span class="attr">"@angular/compiler"</span>: <span class="string">"2.0.0-rc.1"</span>,</div><div class="line">    <span class="attr">"@angular/core"</span>: <span class="string">"2.0.0-rc.1"</span>,</div><div class="line">    <span class="attr">"@angular/http"</span>: <span class="string">"2.0.0-rc.1"</span>,</div><div class="line">    <span class="attr">"@angular/platform-browser"</span>: <span class="string">"2.0.0-rc.1"</span>,</div><div class="line">    <span class="attr">"@angular/platform-browser-dynamic"</span>: <span class="string">"2.0.0-rc.1"</span>,</div><div class="line">    <span class="attr">"@angular/router"</span>: <span class="string">"^2.0.0-rc.1"</span>,</div><div class="line">    <span class="attr">"@angular/router-deprecated"</span>: <span class="string">"2.0.0-rc.1"</span>,</div><div class="line">    <span class="attr">"@angular/upgrade"</span>: <span class="string">"2.0.0-rc.1"</span>,</div><div class="line">    </div><div class="line">    <span class="attr">"es6-shim"</span>: <span class="string">"^0.35.0"</span>,</div><div class="line">    <span class="attr">"reflect-metadata"</span>: <span class="string">"^0.1.3"</span>,</div><div class="line">    <span class="attr">"rxjs"</span>: <span class="string">"5.0.0-beta.6"</span>,</div><div class="line">    <span class="attr">"zone.js"</span>: <span class="string">"^0.6.12"</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>目录下打开控制台，执行 <code>npm i</code> 安装依赖。</p>
<p>至此，Angular2项目已经创建完成。</p>
<h3 id="1-2、安装webpack"><a href="#1-2、安装webpack" class="headerlink" title="1.2、安装webpack"></a>1.2、安装webpack</h3><p>首先要确保已经全局安装了 <code>webpack</code></p>
<p>接着安装所需要包 <code>npm install --save-dev webpack typescript ts-loader ts-helpers</code></p>
<h3 id="1-3、配置webpack"><a href="#1-3、配置webpack" class="headerlink" title="1.3、配置webpack"></a>1.3、配置webpack</h3><p>在根目录创建 <code>webpack.config.js</code> 文件，用于编写webpack的相关配置项。</p>
<p>在配置 <code>webpack</code> 之前，我们先在 <code>src</code> 目录下创建好我们需要的 <code>polyfills.ts</code> 和 <code>vendor.ts</code>，内容如下：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//polyfills.ts</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> <span class="string">'es6-shim'</span>;</div><div class="line"><span class="keyword">import</span> <span class="string">'reflect-metadata'</span>;</div><div class="line"><span class="built_in">require</span>(<span class="string">'zone.js/dist/zone'</span>);</div><div class="line"></div><div class="line"><span class="keyword">import</span> <span class="string">'ts-helpers'</span>;</div></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//vendor.ts</span></div><div class="line"></div><div class="line"><span class="comment">// Angular 2</span></div><div class="line"><span class="keyword">import</span> <span class="string">'@angular/platform-browser'</span>;</div><div class="line"><span class="keyword">import</span> <span class="string">'@angular/platform-browser-dynamic'</span>;</div><div class="line"><span class="keyword">import</span> <span class="string">'@angular/core'</span>;</div><div class="line"><span class="keyword">import</span> <span class="string">'@angular/common'</span>;</div><div class="line"><span class="keyword">import</span> <span class="string">'@angular/http'</span>;</div><div class="line"><span class="keyword">import</span> <span class="string">'@angular/router'</span>;</div><div class="line"><span class="keyword">import</span> <span class="string">'@angular/router-deprecated'</span>;</div><div class="line"></div><div class="line"><span class="comment">//RxJS</span></div><div class="line"><span class="keyword">import</span> <span class="string">'rxjs'</span>;</div></pre></td></tr></table></figure>
<p>接下来，我们再配置webpack的配置项，如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//webpack.config.js</span></div><div class="line"><span class="meta"></span></div><div class="line">'use strict';</div><div class="line"></div><div class="line"><span class="keyword">let</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>);</div><div class="line"></div><div class="line"><span class="built_in">module</span>.exports = &#123;</div><div class="line">  <span class="attr">debug</span>: <span class="literal">true</span>,</div><div class="line">  <span class="attr">entry</span>: &#123;</div><div class="line">    <span class="attr">polyfills</span>: <span class="string">'./src/polyfills.ts'</span>,</div><div class="line">    <span class="attr">vendor</span>: <span class="string">'./src/vendor.ts'</span></div><div class="line">  &#125;,</div><div class="line">  <span class="attr">output</span>: &#123;</div><div class="line">    <span class="attr">path</span>: <span class="string">'dist/assets/js'</span>,</div><div class="line">    <span class="attr">filename</span>: <span class="string">'[name].js'</span>,</div><div class="line">    <span class="attr">chunkFilename</span>: <span class="string">'[id].chunk.js'</span></div><div class="line">  &#125;,</div><div class="line">  <span class="attr">module</span>: &#123;</div><div class="line">    <span class="attr">loaders</span>: [</div><div class="line">      &#123;<span class="attr">test</span>: <span class="regexp">/\.ts$/</span>, <span class="attr">loader</span>: <span class="string">'ts'</span>&#125;</div><div class="line">    ]</div><div class="line">  &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>此时，通过控制台执行 <code>webpack</code> 会提示找不到路径错误。</p>
<p>这个时候，我们需要新建一个 <code>tsconfig.json</code> 文件，内容如下：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">//tsconfig.json</div><div class="line"></div><div class="line">&#123;</div><div class="line">  "compilerOptions": &#123;</div><div class="line">    "module": "commonjs",</div><div class="line">    "target": "es5"</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>之后再执行 <code>webpack</code>，可以看到在dist/assets/js目录下，已经生成了我们需要的 <code>polyfills.js</code> 和 <code>vendor.js</code> 两个文件。</p>
<p>至此，简单的webpack使用，已经ok，同时也可以生成我们需要的来个库文件了。</p>
<h3 id="1-4、Angular2-Hello-World"><a href="#1-4、Angular2-Hello-World" class="headerlink" title="1.4、Angular2 Hello World"></a>1.4、Angular2 Hello World</h3><p>接下来，我们实现一个Angular2的Hello App。</p>
<p>在 <code>src/</code> 下创建 <code>bootstrap.ts</code> 文件，内容如下：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123;Component&#125; from <span class="string">'@angular/core'</span>;</div><div class="line"><span class="keyword">import</span> &#123;bootstrap&#125; from <span class="string">'@angular/platform-browser-dynamic'</span>;</div><div class="line"></div><div class="line"><span class="meta">@Component</span>(&#123;</div><div class="line">  selector: <span class="string">'demo-app'</span>,</div><div class="line">  template: <span class="string">`</span></div><div class="line">&lt;h3&gt;Hello, Angular2 and Webpack.&lt;/h3&gt;</div><div class="line">  `</div><div class="line">&#125;)</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">class</span> AppComponent&#123;</div><div class="line">  <span class="keyword">constructor</span>(<span class="params"></span>)&#123;</div><div class="line">    </div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">bootstrap(AppComponent);</div></pre></td></tr></table></figure>
<p>然后在 <code>webpack.config.js</code> 中添加入口点：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">entry: &#123;</div><div class="line">  <span class="attr">polyfills</span>: <span class="string">'./src/polyfills.ts'</span>,</div><div class="line">  <span class="attr">vendor</span>: <span class="string">'./src/vendor.ts'</span>,</div><div class="line">  <span class="attr">bootstrap</span>: <span class="string">'./src/bootstrap.ts'</span> <span class="comment">//新增的入口文件</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>再次执行 <code>webpack</code> 命令，就可以找到 <code>dist/assets/js/bootstrap.js</code> 文件了。但打开该文件一看，似乎不对，把angular都已经打包进去了。其实我们已经把angular打包到 <code>vendor.js</code> 中了，根本就不需要再打包到 <code>bootstrap.js</code> 。</p>
<p>此时，我们可以修改webpack的config文件，添加公共代码块引用，配置如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="meta">'use strict'</span>;</div><div class="line"></div><div class="line"><span class="keyword">let</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>);</div><div class="line"><span class="keyword">let</span> CommonsChunkPlugin = webpack.optimize.CommonsChunkPlugin;</div><div class="line"></div><div class="line"><span class="built_in">module</span>.exports = &#123;</div><div class="line">  <span class="attr">debug</span>: <span class="literal">true</span>,</div><div class="line">  <span class="attr">entry</span>: &#123;</div><div class="line">    <span class="attr">polyfills</span>: <span class="string">'./src/polyfills.ts'</span>,</div><div class="line">    <span class="attr">vendor</span>: <span class="string">'./src/vendor.ts'</span>,</div><div class="line">    <span class="attr">bootstrap</span>: <span class="string">'./src/bootstrap.ts'</span></div><div class="line">  &#125;,</div><div class="line">  <span class="attr">output</span>: &#123;</div><div class="line">    <span class="attr">path</span>: <span class="string">'dist/assets/js'</span>,</div><div class="line">    <span class="attr">filename</span>: <span class="string">'[name].js'</span>,</div><div class="line">    <span class="attr">chunkFilename</span>: <span class="string">'[id].chunk.js'</span></div><div class="line">  &#125;,</div><div class="line">  <span class="attr">module</span>: &#123;</div><div class="line">    <span class="attr">loaders</span>: [</div><div class="line">      &#123;<span class="attr">test</span>: <span class="regexp">/\.ts$/</span>, <span class="attr">loader</span>: <span class="string">'ts'</span>&#125;</div><div class="line">    ]</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">plugins</span>: [</div><div class="line">    <span class="keyword">new</span> CommonsChunkPlugin(&#123;</div><div class="line">      <span class="attr">name</span>: [<span class="string">'vendor'</span>, <span class="string">'polyfills'</span>] <span class="comment">//vendor和polyfills设置为公共代码块</span></div><div class="line">    &#125;)</div><div class="line">  ]</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>再次执行 <code>webpack</code> ，发现已经达到我们想要的效果了（bootstrap.js只包含了必须的代码）。</p>
<p>接着，我们在 <code>src/</code> 创建 <code>index.html</code> 文件，内容如下：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Webpack in Angular2 demo<span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">demo-app</span>&gt;</span><span class="tag">&lt;/<span class="name">demo-app</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"assets/js/polyfills.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"assets/js/vendor.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"assets/js/bootstrap.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
<p>同时，修改 <code>webpack.config.js</code> ，使用 <code>copy-webpack-plugin</code> 将 <code>index.html</code> 复制到 <code>dist/</code> 目录下。</p>
<p>先通过 <code>npm install copy-webpack-plugin --save-dev</code> 安装该插件，然后修改配置节点如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">plugins: [</div><div class="line">  <span class="keyword">new</span> CommonsChunkPlugin(&#123;</div><div class="line">    <span class="attr">name</span>: [<span class="string">'vendor'</span>, <span class="string">'polyfills'</span>] <span class="comment">//vendor和polyfills设置为公共代码块</span></div><div class="line">  &#125;),</div><div class="line">  <span class="keyword">new</span> CopyWebpackPlugin([</div><div class="line">    <span class="comment">//将src/index.html复制到dist目录。</span></div><div class="line">    &#123;<span class="attr">form</span>: <span class="string">'src/index.html'</span>, <span class="attr">to</span>: path.join(__dirname, <span class="string">'dist'</span>)&#125;</div><div class="line">  ])</div><div class="line">]</div></pre></td></tr></table></figure>
<p>完成以上步骤之后，打开dist目录，使用 <code>anywhere</code> 命令打开 <code>web server</code>，可以在自动打开的浏览器中看到 Hello, Angular2 and Webpack.</p>
<p>至此，我们已经将Angular2和Webpack结合起来使用了。</p>
<h3 id="1-5、使用webpack-dev-server"><a href="#1-5、使用webpack-dev-server" class="headerlink" title="1.5、使用webpack-dev-server"></a>1.5、使用webpack-dev-server</h3><p>每次都在 <code>dist/</code> 目录下，通过 <code>anywhere</code> 来打开，并不方便。我们可以通过 <code>webpack-dev-server</code> 插件实现静态服务器。</p>


    
    
    
  </section>
</article>
    </div>
  
    <div class='post-wrapper'>
      <article class="post reveal">
  <section class="meta">
    
    <h2 class="title">
      <a href="/blog/2017/02/21/前端相关/Webpack初体验/">
        Webpack初体验
      </a>
    </h2>
    
    <time>
      Feb 21, 2017
    </time>
		
  </section>
  <section class="article typo">
	  <h2 id="0、关于webpack"><a href="#0、关于webpack" class="headerlink" title="0、关于webpack"></a>0、关于webpack</h2><p>Webpack是灵活的、可扩展的、开源的模块打包工具。<a href="https://webpack.github.io/" target="_blank" rel="external">https://webpack.github.io/</a>。<br>Webpack获取模块和它们之间的依赖关系，然后将这些内容打包为静态资源。</p>
<h3 id="0-1、-Webpack有如下几大特点："><a href="#0-1、-Webpack有如下几大特点：" class="headerlink" title="0.1、 Webpack有如下几大特点："></a>0.1、 Webpack有如下几大特点：</h3><ol>
<li>插件 –利用webpack提供的多功能插件接口，使得它可以被添加很多新特性，实现了webpack的高扩展性。</li>
<li>加载器（Loaders） – webpack通过加载器来预处理文件，所以它不仅仅只能打包javascript。同时，使用node程序可以很容易的实现自己的加载器。</li>
<li>代码分割 – webpack允许你将代码分块，按需加载，减少初始加载时间。</li>
<li>开发工具 –webpack支持SourceUrl和相关调试，同时可以通过开发中间件和开发服务器来实现自动化。</li>
<li>高性能 –通过异步IO和多级缓存支持，实现了webpack的高性能。</li>
<li>多支持 -webpack支持amd和commonjs风格的代码，并且还可以静态分析和拥有一个评价引擎来评估简单表达式。</li>
<li>资源优化 –webpack能够实现多层优化来减少输出大小，还能使用散列还关注请求缓存。</li>
<li>多目标 –webpack的主要目标是在Web上，但是它还支持WebWorks和node.js。</li>
</ol>
<h3 id="0-2、为什么要webpack？-webpack形成的动机"><a href="#0-2、为什么要webpack？-webpack形成的动机" class="headerlink" title="0.2、为什么要webpack？(webpack形成的动机)"></a>0.2、为什么要webpack？(webpack形成的动机)</h3><ol>
<li>多种模块加载的方式，AMD、CommonJS、ES6 modules，各有优点，也各有缺陷。</li>
<li>传输方式的两个极端，每次请求一个模块和一个请求所有模块，都并不能达到很好的效果。</li>
<li>资源不仅仅是JavaScript，也有可能是字体、图片，多语言，模板等。</li>
</ol>
<h2 id="1、Webpack功能"><a href="#1、Webpack功能" class="headerlink" title="1、Webpack功能"></a>1、Webpack功能</h2><h3 id="1-1、加载器（Loaders）"><a href="#1-1、加载器（Loaders）" class="headerlink" title="1.1、加载器（Loaders）"></a>1.1、加载器（Loaders）</h3><p>Loader是把资源文件进行转换的一种程序，使用资源文件做为参数，然后返回新的资源文件。比如，将CoffeeScript代码处理为JS代码。</p>
<p><strong>Loader有哪些特点呢？</strong></p>
<ol>
<li>Loader可以链接，通过管道方式传输。</li>
<li>Loader可以是同步或者是异步的。</li>
<li>Loader使用nodeJs运行，而且能够做更多。</li>
<li>Loader接受查询参数，可以用来传递配置。</li>
<li>Loader可以在配置中绑定到扩展货正则表达式。</li>
<li>Loader可以使用npm发布。</li>
<li>普通模块可以通过package.json来转换为loader。</li>
<li>Loader可以访问配置。</li>
<li>插件可以为Loader添加更多特性。</li>
</ol>
<p>Loader采用<code>xxx-loader</code>这样的名字命令。<code>xxx</code>就是上下文的名称。在使用loader的时候，可以忽略<code>-loader</code>，只需要使用上下文名称就可以了。</p>
<p><strong>有如下三种方式可以使用loader，</strong></p>
<ol>
<li>通过require来使用</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 使用当前目录的loader.js处理指定的文件</span></div><div class="line"><span class="built_in">require</span>(<span class="string">"./loader!./dir/file.txt"</span>);</div><div class="line"><span class="comment">// 使用jade-loader来处理.jade模板文件</span></div><div class="line"><span class="built_in">require</span>(<span class="string">"jade!./template.jade"</span>);</div></pre></td></tr></table></figure>
<ol>
<li>通过配置</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">module</span>: &#123;</div><div class="line">    <span class="attr">loaders</span>: [</div><div class="line">      &#123; <span class="attr">test</span>: <span class="regexp">/\.jade$/</span>, <span class="attr">loader</span>: <span class="string">"jade"</span> &#125;,</div><div class="line">      <span class="comment">// =&gt; 针对.jade文件使用jade-loader</span></div><div class="line"></div><div class="line">      &#123; <span class="attr">test</span>: <span class="regexp">/\.css$/</span>, <span class="attr">loader</span>: <span class="string">"style!css"</span> &#125;,</div><div class="line">      <span class="comment">// =&gt; 针对.css文件使用style和css两种loader</span></div><div class="line">      <span class="comment">// 另外的一种配置语法</span></div><div class="line">      &#123; <span class="attr">test</span>: <span class="regexp">/\.css$/</span>, <span class="attr">loaders</span>: [<span class="string">"style"</span>, <span class="string">"css"</span>] &#125;,</div><div class="line">    ]</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ol>
<li>通过cli</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">webpack --module-bind jade --module-bind &apos;css=style!css&apos;</div></pre></td></tr></table></figure>
<p><strong>如何使用查询参数？</strong></p>
<p>在require中</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">require</span>(<span class="string">"url-loader?mimetype=image/png!./file.png"</span>);</div></pre></td></tr></table></figure>
<p>在配置中</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//方式一</span></div><div class="line">&#123; <span class="attr">test</span>: <span class="regexp">/\.png$/</span>, <span class="attr">loader</span>: <span class="string">"url-loader?mimetype=image/png"</span> &#125;</div><div class="line"></div><div class="line"><span class="comment">//方式二</span></div><div class="line">&#123;</div><div class="line">    <span class="attr">test</span>: <span class="regexp">/\.png$/</span>,</div><div class="line">    <span class="attr">loader</span>: <span class="string">"url-loader"</span>,</div><div class="line">    <span class="attr">query</span>: &#123; <span class="attr">mimetype</span>: <span class="string">"image/png"</span> &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>在CLI中</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">webpack --<span class="built_in">module</span>-bind <span class="string">"png=url-loader?mimetype=image/png"</span></div></pre></td></tr></table></figure>
<h3 id="1-1、插件"><a href="#1-1、插件" class="headerlink" title="1.1、插件"></a>1.1、插件</h3><p>使用插件一般都涉及到webpack的打包功能，比如使用<a href="https://github.com/senotrusov/bell-on-bundler-error-plugin" target="_blank" rel="external">BellOnBundlerErrorPlugin</a>，来提示在打包过程的错误。</p>
<p>webpack包含部分内置插件，可以在config中进行配置：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> webpack = <span class="built_in">require</span>(<span class="string">"webpack"</span>);</div><div class="line"></div><div class="line"><span class="built_in">module</span>.exports = &#123;</div><div class="line">  <span class="attr">plugins</span>: [</div><div class="line">    <span class="keyword">new</span> webpack.ResolverPlugin([</div><div class="line">        <span class="keyword">new</span> webpack.ResolverPlugin.DirectoryDescriptionFilePlugin(<span class="string">"bower.json"</span>, [<span class="string">"main"</span>])</div><div class="line">    ], [<span class="string">"normal"</span>, <span class="string">"loader"</span>])</div><div class="line">  ]</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>也可以通过以下代码使用外部插件：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> ComponentPlugin = <span class="built_in">require</span>(<span class="string">"component-webpack-plugin"</span>);</div><div class="line"><span class="built_in">module</span>.exports = &#123;</div><div class="line">  <span class="attr">plugins</span>: [</div><div class="line">      <span class="keyword">new</span> ComponentPlugin()</div><div class="line">  ]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="1-3-开发工具"><a href="#1-3-开发工具" class="headerlink" title="1.3 开发工具"></a>1.3 开发工具</h3><p>开发工具相关配置通过通过<a href="http://webpack.github.io/docs/configuration.html" target="_blank" rel="external">Configuration</a>进行查看。</p>
<p>提供开发服务器的包：<a href="http://webpack.github.io/docs/webpack-dev-server.html" target="_blank" rel="external">webpack-dev-server</a></p>
<p>用于高级用户的中间件：<a href="http://webpack.github.io/docs/webpack-dev-middleware.html" target="_blank" rel="external">webpack-dev-middleware</a></p>
<h2 id="2、使用Webpack"><a href="#2、使用Webpack" class="headerlink" title="2、使用Webpack"></a>2、使用Webpack</h2><p>我们一般采用配置文件加webpack.config的方式来使用webpack，那具体应该如何用呢？</p>
<p>首先，通过 <code>npm install webpack -g</code> 和 <code>npm install webpack --save-dev</code> 全局和在项目中安装webpack。</p>
<p>然后通过 <code>npm install xxx</code> 来安装webpack所需要的插件和加载器（Loader）</p>
<p>接下来，就是编写webpack的配置文件：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>); <span class="comment">//引入webpack</span></div><div class="line"></div><div class="line"><span class="comment">//webpack配置</span></div><div class="line"><span class="built_in">module</span>.exports = &#123;</div><div class="line">  <span class="attr">entry</span>: &#123;</div><div class="line">    <span class="attr">app</span>: <span class="string">'index.js'</span></div><div class="line">  &#125;,</div><div class="line">  <span class="attr">output</span>: &#123;</div><div class="line">    <span class="attr">path</span>: <span class="string">'./dist'</span>, <span class="comment">//输出目录</span></div><div class="line">    filename: <span class="string">'[name][hash]bundle.js'</span> <span class="comment">//输出文件名</span></div><div class="line">  &#125;,</div><div class="line">  <span class="attr">resolve</span>: &#123;</div><div class="line">    <span class="attr">root</span>: __dirname</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">module</span>: &#123;</div><div class="line">    <span class="attr">noParse</span>: [],</div><div class="line">    <span class="attr">loaders</span>: [ <span class="comment">//针对不同的文件，采用不同的加载器来处理</span></div><div class="line">      &#123; <span class="attr">test</span>: <span class="regexp">/\.js$/</span>, <span class="attr">exclude</span>: <span class="regexp">/node_modules/</span>, <span class="attr">loader</span>: <span class="string">'babel'</span>&#125;, <span class="comment">//js文件除开node_modules,通过babel来处理</span></div><div class="line">      &#123; <span class="attr">test</span>: <span class="regexp">/\.html$/</span>, <span class="attr">loader</span>: <span class="string">'raw'</span> &#125;, <span class="comment">//html文件通过raw-loader处理</span></div><div class="line">      &#123; <span class="attr">test</span>: <span class="regexp">/\.css$/</span>, <span class="attr">loader</span>: <span class="string">'style!css'</span>&#125; <span class="comment">//css文件通过style-loader和css-loader来处理</span></div><div class="line">    ]</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">plugins</span>: [</div><div class="line">    <span class="comment">//Banner插件，合并时增加注释</span></div><div class="line">    <span class="keyword">new</span> webpack.BannerPlugin(<span class="string">'Hello'</span> + <span class="keyword">new</span> <span class="built_in">Date</span>())</div><div class="line">  ]</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>最后，执行webpack，就能够启动了，在执行webpack的时候，可以附加很多参数，这些参数可以通过 <code>webpack -h</code> 来查看</p>
<p><strong>当前只能简单使用，等理解了webpack的核心思想，再写一篇《webpack深度解析》，敬请期待…</strong></p>
<h2 id="3、参考文档"><a href="#3、参考文档" class="headerlink" title="3、参考文档"></a>3、参考文档</h2><ol>
<li><a href="http://webpack.github.io/docs/" target="_blank" rel="external">Webpack官方文档</a></li>
<li><a href="http://blog.madewithlove.be/post/webpack-your-bags/" target="_blank" rel="external">在一个真实的项目中使用Webpack</a></li>
</ol>


    
    
    
  </section>
</article>
    </div>
  
    <div class='post-wrapper'>
      <article class="post reveal">
  <section class="meta">
    
    <h2 class="title">
      <a href="/blog/2017/02/21/重温设计模式/重温设计模式（一）：工厂方法/">
        重温设计模式（一）：工厂方法
      </a>
    </h2>
    
    <time>
      Feb 21, 2017
    </time>
		
  </section>
  <section class="article typo">
	  <p><strong>工厂方法模式（Factory method pattern），属于创建性模式。</strong></p>


    
    
    
  </section>
</article>
    </div>
  
</section>


  <nav id="page-nav">
    
    <a class="prev" rel="prev" href="/blog/archives/2017/">
      <span class="icon icon-chevron-left"></span>
      <span class="text">Previous</span>
    </a>
    
    
    <a class="next" rel="next" href="/blog/archives/2017/page/3/">
      <span class="text">Next</span>
      <span class="icon icon-chevron-right"></span>
    </a>
    
  </nav>
  


      </div>
      <aside class='l_side'>
        
  <section class='m_widget about'>

<img class='avatar waves-image' src='https://avatars1.githubusercontent.com/u/4043284?v=3&amp;s=460' />

<div class='header'>Jay.M.Hu</div>
<div class='content'>
<div></div>
</div>
</section>

  <section class='m_widget friendly-links'>
<div class='header'>Links</div>
<div class='content'>
    <ul class="entry">
    
        <li><a class="flat-box" target="_blank" href="http://humin.cnblogs.com/">
            <div class='name'>幻天芒 - 博客园</div>
        </a></li>
    
    </ul>
</div>
</section>

  <section class='m_widget categories'>
<div class='header'>Categories</div>
<div class='content'>
    
</div>
</section>

  


      </aside>
      <script>setLoadingBarProgress(60);</script>
    </div>
  </div>
  <footer id="footer" class="clearfix">

	<div class="social-wrapper">
  	
      
        <a href="https://github.com/hstarorg" class="social github"
          target="_blank" rel="external">
          <span class="icon icon-github"></span>
        </a>
      
        <a href="/atom.xml" class="social rss"
          target="_blank" rel="external">
          <span class="icon icon-rss"></span>
        </a>
      
    
  </div>
  
  <div>Theme <a href='https://github.com/stkevintan/hexo-theme-material-flow' class="codename">MaterialFlow</a> designed by <a href="http://keyin.me/" target="_blank">Kevin Tan</a>.</div>
  
</footer>


  <script>setLoadingBarProgress(80);</script>
  

<script src="//apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
<script src='//cdn.bootcss.com/node-waves/0.7.5/waves.min.js'></script>
<script src="//cdn.bootcss.com/scrollReveal.js/3.3.2/scrollreveal.min.js"></script>
<script src="/blog/js/jquery.fitvids.js"></script>
<script>
	var GOOGLE_CUSTOM_SEARCH_API_KEY = "";
	var GOOGLE_CUSTOM_SEARCH_ENGINE_ID = "";
	var ALGOLIA_API_KEY = "";
	var ALGOLIA_APP_ID = "";
	var ALGOLIA_INDEX_NAME = "";
  var AZURE_SERVICE_NAME = "";
  var AZURE_INDEX_NAME = "";
  var AZURE_QUERY_KEY = "";
  var BAIDU_API_ID = "";
  var SEARCH_SERVICE = "hexo";
  var ROOT = "/blog/"||"/";
  if(!ROOT.endsWith('/'))ROOT += '/';
</script>
<script src="/blog/js/search.js"></script>
<script src="/blog/js/app.js"></script>


  <script>setLoadingBarProgress(100);</script>
</body>
</html>
