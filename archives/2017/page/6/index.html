<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  
  <title>Archives: 2017 | 幻☆精灵的Blog</title>
  <meta name="description" content="幻☆精灵的Blog站点" />
  <meta name="keywords" content="幻精灵" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <link rel="shortcut icon" href="/blog/images/favicon.ico">
  <link rel="alternate" href="/blog/atom.xml" title="幻☆精灵的Blog">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="幻☆精灵的Blog站点">
<meta property="og:type" content="website">
<meta property="og:title" content="幻☆精灵的Blog">
<meta property="og:url" content="http://hstarorg.github.io/blog/archives/2017/page/6/index.html">
<meta property="og:site_name" content="幻☆精灵的Blog">
<meta property="og:description" content="幻☆精灵的Blog站点">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="幻☆精灵的Blog">
<meta name="twitter:description" content="幻☆精灵的Blog站点">
    
  <link href="https://fonts.googleapis.com/css?family=Inconsolata|Titillium+Web" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Roboto+Mono" rel="stylesheet">
  <link href='//cdn.bootcss.com/node-waves/0.7.5/waves.min.css' rel='stylesheet'>
  <link rel="stylesheet" href="/blog/style.css">
  
  

  <script>
    function setLoadingBarProgress(num) {
      document.getElementById('loading-bar').style.width=num+"%";
    }
  </script>
</head>

<body>
  <div id="loading-bar-wrapper">
  <div id="loading-bar"></div>
</div>


  <script>setLoadingBarProgress(20)</script> 
  <header class="l_header">
		<div class="wrapper container">
			<a class="logo flat-box" href='/blog/' >
				幻☆精灵的Blog
			</a>
			<div class='menu'>
				<ul class='h-list'>
					
						<li>
							<a class='flat-box nav-home' href='/blog/'>
								首页
							</a>
						</li>
					
						<li>
							<a class='flat-box nav-archives' href='/blog/archives'>
								归档
							</a>
						</li>
					
						<li>
							<a class='flat-box nav-about' href='/blog/about'>
								关于我
							</a>
						</li>
					
				</ul>
				<div class='underline'></div>
			</div>
			
				<div class="m_search">
					<form name="searchform" class="form u-search-form">
						<input type="text" class="input u-search-input" placeholder="Search" />
						<span class="icon icon-search"></span>
					</form>
				</div>
			
			<ul class='switcher h-list'>
				
					<li class='s-search'><a href='javascript:void(0)'><span class="icon icon-search"></span></a></li>
				
				<li class='s-menu'><a href='javascript:void(0)'><span class="icon icon-menu"></span></a></li>
			</ul>
		</div>
		<aside class="menu-phone">
			<nav>
				
					<a href="/blog/" class="nav-home nav">
						首页
					</a>
				
					<a href="/blog/archives" class="nav-archives nav">
						归档
					</a>
				
					<a href="/blog/about" class="nav-about nav">
						关于我
					</a>
				
			</nav>
		</aside>
</header>

    <script>setLoadingBarProgress(40);</script>
  <div class="l_body">
    <div class='container'>
      <div class='l_main'>
        
	
	<section class="page-header archive banner waves-image">
    <h1>Year : <span>2017</span></h1>
  </section>

<section class="post-list">
	
    <div class='post-wrapper'>
      <article class="post reveal">
  <section class="meta">
    
    <h2 class="title">
      <a href="/blog/2017/02/21/Other/NPM使用详解（下）/">
        NPM使用详解（下）
      </a>
    </h2>
    
    <time>
      Feb 21, 2017
    </time>
		
  </section>
  <section class="article typo">
	  <p>在浏览本文之前，建议您先浏览《NPM使用详解（上）》</p>
<p>在上一文中，罗列出了最常用的NPM命令，那么本文将继续分解剩下的NPM命令</p>
<hr>
<h4 id="1、access"><a href="#1、access" class="headerlink" title="1、access"></a>1、access</h4><h4 id="2、adduser"><a href="#2、adduser" class="headerlink" title="2、adduser"></a>2、adduser</h4><pre><code>//用于启动在指定的git仓库添加用户的向导
npm adduser [--registry=url] [--scope=@orgname] [--always-auth]
//eg:
npm adduser --registry=http://registry.npmjs.org
</code></pre><h4 id="3、bin"><a href="#3、bin" class="headerlink" title="3、bin"></a>3、bin</h4><pre><code>//打印出npm执行安装的文件夹
npm bin
</code></pre><h4 id="4、bugs"><a href="#4、bugs" class="headerlink" title="4、bugs"></a>4、bugs</h4><pre><code>//查看某个包的issue列表
npm bugs &lt;pkgname&gt;
//eg:（将会用浏览器打开https://github.com/sindresorhus/del/issues）
npm bugs del 
// 可以直接在一个包的文件夹中执行无参数的命令，将自动打开该包的issue列表
//eg:(在del文件夹下执行cmd)
npm bugs
</code></pre><h4 id="5、build"><a href="#5、build" class="headerlink" title="5、build"></a>5、build</h4><h4 id="6、bundle-已过期"><a href="#6、bundle-已过期" class="headerlink" title="6、bundle(已过期)"></a>6、bundle(已过期)</h4><h4 id="7、completion"><a href="#7、completion" class="headerlink" title="7、completion"></a>7、completion</h4><h4 id="8、dedupe"><a href="#8、dedupe" class="headerlink" title="8、dedupe"></a>8、dedupe</h4><pre><code>//
npm dedupe [package names...]
//可简化为如下调用
npm ddp [package names...]
</code></pre><h4 id="9、deprecate"><a href="#9、deprecate" class="headerlink" title="9、deprecate"></a>9、deprecate</h4><pre><code>//为指定版本的包添加过期警告
npm deprecate &lt;name&gt;[@&lt;version&gt;] &lt;message&gt;
// eg:
npm deprecate my-thing@&quot;&lt; 0.2.3&quot; &quot;critical bug fixed in v0.2.3&quot;
</code></pre><h4 id="10、dist-tag"><a href="#10、dist-tag" class="headerlink" title="10、dist-tag"></a>10、dist-tag</h4><pre><code>npm dist-tag add &lt;pkg&gt;@&lt;version&gt; [&lt;tag&gt;]
npm dist-tag rm &lt;pkg&gt; &lt;tag&gt;
npm dist-tag ls [&lt;pkg&gt;]
</code></pre><h4 id="11、docs"><a href="#11、docs" class="headerlink" title="11、docs"></a>11、docs</h4><pre><code>//打开包的文档页面
npm docs [&lt;pkgname&gt; [&lt;pkgname&gt; ...]]
npm docs (with no args in a package dir)
// 打开包的首页readme
npm home [&lt;pkgname&gt; [&lt;pkgname&gt; ...]]
npm home (with no args in a package dir)
</code></pre><h4 id="12、edit"><a href="#12、edit" class="headerlink" title="12、edit"></a>12、edit</h4><pre><code>npm edit &lt;name&gt;[@&lt;version&gt;]
</code></pre><h4 id="13、explore"><a href="#13、explore" class="headerlink" title="13、explore"></a>13、explore</h4><pre><code>npm explore &lt;name&gt; [ -- &lt;cmd&gt;]
</code></pre><h4 id="14、help"><a href="#14、help" class="headerlink" title="14、help"></a>14、help</h4><pre><code>//打开本地npm的帮助文件
npm help &lt;topic&gt;
npm help some search terms
//eg:(打开config的本地帮助)
npm help config
</code></pre><h4 id="15、help-search"><a href="#15、help-search" class="headerlink" title="15、help-search"></a>15、help-search</h4><pre><code>//从npm的markdown文档中查询所有的term，并展示
npm help-search some search terms
</code></pre><h4 id="16、link"><a href="#16、link" class="headerlink" title="16、link"></a>16、link</h4><pre><code>npm link (in package folder)
npm link [@&lt;scope&gt;/]&lt;pkgname&gt;
npm ln (with any of the previous argument usage)
</code></pre><h4 id="17、logout"><a href="#17、logout" class="headerlink" title="17、logout"></a>17、logout</h4><pre><code>//从指定的仓库登出
npm logout [--registry=url] [--scope=@orgname]
</code></pre><h4 id="18、ls"><a href="#18、ls" class="headerlink" title="18、ls"></a>18、ls</h4><pre><code>//列举当前文件夹下的所有包
npm list [[@&lt;scope&gt;/]&lt;pkg&gt; ...]
npm ls [[@&lt;scope&gt;/]&lt;pkg&gt; ...]
npm la [[@&lt;scope&gt;/]&lt;pkg&gt; ...]
npm ll [[@&lt;scope&gt;/]&lt;pkg&gt; ...]
</code></pre><h4 id="19、npm"><a href="#19、npm" class="headerlink" title="19、npm"></a>19、npm</h4><pre><code>npm &lt;command&gt; [args]
</code></pre><h4 id="20、outdated-☆☆☆☆☆"><a href="#20、outdated-☆☆☆☆☆" class="headerlink" title="20、outdated(☆☆☆☆☆)"></a>20、outdated(☆☆☆☆☆)</h4><pre><code>//检查当前文件夹中的包版本（当前，需要，最新）
npm outdated [&lt;name&gt; [&lt;name&gt; ...]]
</code></pre><h4 id="21、owner"><a href="#21、owner" class="headerlink" title="21、owner"></a>21、owner</h4><pre><code>//管理包的拥有者
npm owner ls &lt;package name&gt;
npm owner add &lt;user&gt; &lt;package name&gt;
npm owner rm &lt;user&gt; &lt;package name&gt;
</code></pre><h4 id="22、pack-☆☆☆☆☆"><a href="#22、pack-☆☆☆☆☆" class="headerlink" title="22、pack(☆☆☆☆☆)"></a>22、pack(☆☆☆☆☆)</h4><pre><code>//压缩包文件夹
npm pack [&lt;pkg&gt; [&lt;pkg&gt; ...]]
//eg：在del目录中直接执行
npm pack
//或者在项目目录中，执行
npm pack del
</code></pre><h4 id="23、prefix"><a href="#23、prefix" class="headerlink" title="23、prefix"></a>23、prefix</h4><pre><code>//打印本地前缀到控制台，如果-g，则打印全局的前缀
</code></pre><h4 id="24、prune-☆☆☆☆☆"><a href="#24、prune-☆☆☆☆☆" class="headerlink" title="24、prune(☆☆☆☆☆)"></a>24、prune(☆☆☆☆☆)</h4><pre><code>//删除多余的包(如果指定包名，则删除指定的包)
npm prune [&lt;name&gt; [&lt;name ...]]
npm prune [&lt;name&gt; [&lt;name ...]] [--production]
</code></pre><h4 id="25、publish"><a href="#25、publish" class="headerlink" title="25、publish"></a>25、publish</h4><pre><code>//发布包
npm publish &lt;tarball&gt; [--tag &lt;tag&gt;] [--access &lt;public|restricted&gt;]
npm publish &lt;folder&gt; [--tag &lt;tag&gt;] [--access &lt;public|restricted&gt;]
</code></pre><h4 id="26、rebuild"><a href="#26、rebuild" class="headerlink" title="26、rebuild"></a>26、rebuild</h4><pre><code>//重新编译包
npm rebuild [&lt;name&gt; [&lt;name&gt; ...]]
npm rb [&lt;name&gt; [&lt;name&gt; ...]]
</code></pre><h4 id="27、repo"><a href="#27、repo" class="headerlink" title="27、repo"></a>27、repo</h4><pre><code>//在浏览器中打开包的仓库地址
npm repo &lt;pkgname&gt;
npm repo (with no args in a package dir)
</code></pre><h4 id="28、restart"><a href="#28、restart" class="headerlink" title="28、restart"></a>28、restart</h4><pre><code>//重新启动包
npm restart [-- &lt;args&gt;]
</code></pre><h4 id="29、rm"><a href="#29、rm" class="headerlink" title="29、rm"></a>29、rm</h4><pre><code>//移除包
npm rm &lt;name&gt;
npm r &lt;name&gt;
npm uninstall &lt;name&gt;
npm un &lt;name&gt;
</code></pre><h4 id="30、root"><a href="#30、root" class="headerlink" title="30、root"></a>30、root</h4><pre><code>//打印node_modules文件夹到控制台
npm root
</code></pre><h4 id="31、run-script"><a href="#31、run-script" class="headerlink" title="31、run-script"></a>31、run-script</h4><pre><code>//运行任意的包脚本
npm run-script [command] [-- &lt;args&gt;]
npm run [command] [-- &lt;args&gt;]
</code></pre><h4 id="32、search"><a href="#32、search" class="headerlink" title="32、search"></a>32、search</h4><h4 id="33、shrinkwrap"><a href="#33、shrinkwrap" class="headerlink" title="33、shrinkwrap"></a>33、shrinkwrap</h4><h4 id="34、star"><a href="#34、star" class="headerlink" title="34、star"></a>34、star</h4><pre><code>//给指定的包加star
npm star &lt;pkgname&gt; [&lt;pkg&gt;, ...]
npm unstar &lt;pkgname&gt; [&lt;pkg&gt;, ...]
</code></pre><h4 id="35、stars"><a href="#35、stars" class="headerlink" title="35、stars"></a>35、stars</h4><pre><code>//查看指定用户的stars
npm stars
npm stars [username]
</code></pre><h4 id="36、start"><a href="#36、start" class="headerlink" title="36、start"></a>36、start</h4><h4 id="37、stop"><a href="#37、stop" class="headerlink" title="37、stop"></a>37、stop</h4><h4 id="38、tag"><a href="#38、tag" class="headerlink" title="38、tag"></a>38、tag</h4><h4 id="39、test"><a href="#39、test" class="headerlink" title="39、test"></a>39、test</h4><h4 id="40、unpublish"><a href="#40、unpublish" class="headerlink" title="40、unpublish"></a>40、unpublish</h4><h4 id="41、version"><a href="#41、version" class="headerlink" title="41、version"></a>41、version</h4><pre><code>npm version [&lt;newversion&gt; | major | minor | patch | premajor | preminor | prepatch | prerelease]

//查看项目相关信息
npm version
npm version major
</code></pre><h4 id="42、view"><a href="#42、view" class="headerlink" title="42、view"></a>42、view</h4><h4 id="43、whoami"><a href="#43、whoami" class="headerlink" title="43、whoami"></a>43、whoami</h4>

    
    
    
  </section>
</article>
    </div>
  
    <div class='post-wrapper'>
      <article class="post reveal">
  <section class="meta">
    
    <h2 class="title">
      <a href="/blog/2017/02/21/OWIN/OWIN 中文版/">
        OWIN 中文版
      </a>
    </h2>
    
    <time>
      Feb 21, 2017
    </time>
		
  </section>
  <section class="article typo">
	  <h1 id="OWIN：Open-Web-Server-Interface-for-NET"><a href="#OWIN：Open-Web-Server-Interface-for-NET" class="headerlink" title="OWIN：Open Web Server Interface for .NET"></a>OWIN：Open Web Server Interface for .NET</h1><p>Version：1.0</p>
<p>原文地址：<a href="http://owin.org/html/spec/owin-1.0.html" target="_blank" rel="external">http://owin.org/html/spec/owin-1.0.html</a></p>
<h2 id="0、Table-Intro"><a href="#0、Table-Intro" class="headerlink" title="0、Table Intro"></a>0、Table Intro</h2><ol>
<li>Overview</li>
<li>Definitions</li>
<li>Request Execution<ol>
<li></li>
<li>环境</li>
<li>协议头</li>
<li>协议体</li>
<li>响应体</li>
<li>请求生命周期</li>
</ol>
</li>
<li>应用启动</li>
<li>URI Re<ol>
<li>URI 结构</li>
<li>主机名</li>
<li>路径</li>
<li>URI</li>
<li>预编码</li>
</ol>
</li>
<li>错误处理<ol>
<li>应用错误</li>
<li>服务器错误</li>
</ol>
</li>
<li>版本  </li>
</ol>


    
    
    
  </section>
</article>
    </div>
  
    <div class='post-wrapper'>
      <article class="post reveal">
  <section class="meta">
    
    <h2 class="title">
      <a href="/blog/2017/02/21/PHP学习之路/02-PHP基础语法（上）/">
        02-PHP基础语法（上）
      </a>
    </h2>
    
    <time>
      Feb 21, 2017
    </time>
		
  </section>
  <section class="article typo">
	  <h1 id="0、导言"><a href="#0、导言" class="headerlink" title="0、导言"></a>0、导言</h1><p>学习一门语言，首先要了解它能做什么？其次，就应该去学习应该如何做。那这个的前提就是语法的学习。</p>
<p>语法决定了代码应该如何写（仅仅是可运行），接着我们就来看看PHP它的语法吧。</p>
<p><em>注意：本文测试代码全部运行在PHP7上。</em></p>
<h1 id="1、基础中的基础"><a href="#1、基础中的基础" class="headerlink" title="1、基础中的基础"></a>1、基础中的基础</h1><p>1.1、 PHP文件以 <code>.php</code> 结尾，对于渲染HTML的PHP文件，其本质还是一个HTML页面，只要可以嵌入PHP逻辑代码。</p>
<p>1.2、 在前端 <code>.php</code> 文件中，要嵌入PHP代码，需要使用 &lt;?php 你的代码 ?&gt;。</p>
<p>1.3、PHP的每个语句以分号结束（部分场景省略分号也不报错）。</p>
<p>1.4、 PHP中，有两种注释方式。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 我是单行注释</span></div><div class="line"></div><div class="line"><span class="comment">/*</span></div><div class="line">  我是多行注释</div><div class="line">*/</div></pre></td></tr></table></figure>
<p>1.5、PHP的输出，也有两种方式</p>
<p>一是 <code>echo</code> </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">echo &apos;abc&apos;, &apos;aaaa&apos;;</div><div class="line">echo(&apos;abc&apos;, &apos;aaaa&apos;);</div></pre></td></tr></table></figure>
<p>二是 <code>print</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">print &apos;abc&apos;;</div><div class="line">print(&apos;abc&apos;);</div><div class="line">$result = print(&apos;abc&apos;);</div></pre></td></tr></table></figure>
<p><strong>注意：<code>echo</code>、<code>print</code>即是语言结构，也算是函数，所以可以不加括号调用，也可加括号调用。</strong></p>
<p><strong>注意2：<code>echo</code> 输出没有返回值，<code>print</code> 有返回值1。</strong></p>
<p><strong>注意3：<code>echo</code> 输出比 <code>print</code> 快！</strong></p>
<p>1.6、数据的格式化输出，在输入时，我们可以用更简单的方法拼接字符串</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$name = <span class="string">'Jay'</span>;</div><div class="line"><span class="keyword">echo</span> <span class="string">'My name is &#123;$name&#125;'</span>;</div><div class="line"><span class="keyword">echo</span> <span class="string">"My name is &#123;$name&#125;"</span>;</div><div class="line"><span class="keyword">print</span> <span class="string">'My name is &#123;$name&#125;'</span>;</div><div class="line"><span class="keyword">print</span> <span class="string">"My name is &#123;$name&#125;"</span>;</div></pre></td></tr></table></figure>
<p>会输出：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">My name is &#123;$name&#125;</div><div class="line">My name is Jay</div><div class="line">My name is &#123;$name&#125;</div><div class="line">My name is Jay</div></pre></td></tr></table></figure>
<p><strong>！！！注意：只有当使用双引号（””）包裹字符串的时候，才可以使用简易字符串拼接。</strong></p>
<h1 id="2、数据类型"><a href="#2、数据类型" class="headerlink" title="2、数据类型"></a>2、数据类型</h1><p>PHP有个和大多数语言雷同的类型系统，系统提供了如下类型：</p>
<ol>
<li>String（字符串）</li>
<li>Integer（整型）</li>
<li>Float（浮点型）</li>
<li>Boolean（布尔型）</li>
<li>Array（数组）</li>
<li>Object（对象）</li>
<li>NULL（空值）。</li>
</ol>
<p>PHP中的变量命名以$为标记，之后跟变量名称（变量名字只能包含数字字母和下划线），变量区分大小写。</p>
<p>PHP是弱类型语言，所以同一个变量，可以存储多种类型数据。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">$a = <span class="string">'我是字符串'</span>; <span class="comment">//定义字符串（单引号，双引号皆可）</span></div><div class="line"><span class="keyword">echo</span> $a, <span class="string">'&lt;br&gt;'</span>;</div><div class="line">$a = <span class="number">10</span>; <span class="comment">// 我的整数</span></div><div class="line"><span class="keyword">echo</span> $a, <span class="string">'&lt;br&gt;'</span>;</div><div class="line">$a = <span class="number">0x10</span>; <span class="comment">// 定义16进制整数</span></div><div class="line"><span class="keyword">echo</span> $a, <span class="string">'&lt;br&gt;'</span>;</div><div class="line">$a = <span class="number">010</span>; <span class="comment">// 定义8进制整数</span></div><div class="line"><span class="keyword">echo</span> $a, <span class="string">'&lt;br&gt;'</span>;</div><div class="line">$a = <span class="number">0.1</span>; <span class="comment">// 浮点数</span></div><div class="line"><span class="keyword">echo</span> $a, <span class="string">'&lt;br&gt;'</span>;</div><div class="line">$a = <span class="number">8E-5</span>; <span class="comment">// 指数形式定义浮点数</span></div><div class="line"><span class="keyword">echo</span> $a, <span class="string">'&lt;br&gt;'</span>;</div><div class="line">$a = <span class="keyword">true</span>; <span class="comment">// Bool类型，只有true,false，注意不区分大小写，写成True，TrUe都没问题。</span></div><div class="line"><span class="keyword">echo</span> $a, <span class="string">'&lt;br&gt;'</span>;</div><div class="line">$a = <span class="keyword">NuLL</span>; <span class="comment">// NULL类型只有一个null值，同样不区分大小写。</span></div></pre></td></tr></table></figure>
<p>输出如下：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">我是字符串<span class="tag">&lt;<span class="name">br</span>&gt;</span></div><div class="line">10<span class="tag">&lt;<span class="name">br</span>&gt;</span></div><div class="line">16<span class="tag">&lt;<span class="name">br</span>&gt;</span></div><div class="line">8<span class="tag">&lt;<span class="name">br</span>&gt;</span></div><div class="line">0.1<span class="tag">&lt;<span class="name">br</span>&gt;</span></div><div class="line">8.0E-5<span class="tag">&lt;<span class="name">br</span>&gt;</span></div><div class="line">1<span class="tag">&lt;<span class="name">br</span>&gt;</span>  // 注意，Bool类型，true会输出1，false会输出0</div><div class="line"><span class="tag">&lt;<span class="name">br</span>&gt;</span> // NULL类型，无任何输出</div></pre></td></tr></table></figure>
<p>以上演示了PHP中的简单类型，还剩下Array和Object两个复杂类型。</p>
<p><strong>Array 类型</strong></p>
<p>数组又分为以下几种：</p>
<ol>
<li>简单数组（数值数组，下标为数字）</li>
</ol>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$arr = [<span class="string">'item1'</span>, <span class="string">'item2'</span>];</div><div class="line"><span class="comment">// 等价于</span></div><div class="line">$arr = <span class="keyword">array</span>(<span class="string">'item1'</span>, <span class="string">'item2'</span>);</div><div class="line"></div><div class="line"><span class="comment">// 仅能通过下标访问元素</span></div><div class="line"><span class="keyword">echo</span> $arr[<span class="number">0</span>];</div></pre></td></tr></table></figure>
<ol>
<li>关联数组</li>
</ol>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$arr = [<span class="string">'key1'</span> =&gt; <span class="string">'value1'</span>, <span class="string">'key2'</span> =&gt; <span class="string">'value2'</span>];</div><div class="line"><span class="comment">//等价于</span></div><div class="line">$arr = <span class="keyword">array</span>(<span class="string">'key1'</span> =&gt; <span class="string">'value1'</span>, <span class="string">'key2'</span> =&gt; <span class="string">'value2'</span>);</div><div class="line"></div><div class="line"><span class="comment">// 仅能通过key访问</span></div><div class="line"><span class="keyword">echo</span> $arr[<span class="string">'key1'</span>];</div></pre></td></tr></table></figure>
<ol>
<li>多维数组（数组包含数组）</li>
</ol>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$arr = [<span class="string">'key1'</span> =&gt; [<span class="string">'a'</span>, <span class="string">'b'</span>], <span class="string">'key2'</span> =&gt; [<span class="string">'c'</span>, <span class="string">'d'</span>]];</div><div class="line"><span class="comment">//等价于</span></div><div class="line">$arr = <span class="keyword">array</span>(<span class="string">'key1'</span> =&gt; <span class="keyword">array</span>(<span class="string">'a'</span>, <span class="string">'b'</span>), <span class="string">'key2'</span> =&gt; <span class="keyword">array</span>(<span class="string">'c'</span>, <span class="string">'d'</span>));</div><div class="line"></div><div class="line"><span class="comment">// 根据数组类型，通过key或者是下标访问</span></div><div class="line"><span class="keyword">echo</span> $arr[<span class="string">'key1'</span>][<span class="number">0</span>];</div></pre></td></tr></table></figure>
<p>数组Demo合集：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">$arr = [<span class="string">'item1'</span>, <span class="string">'item2'</span>];</div><div class="line">print_r($arr);</div><div class="line"><span class="keyword">echo</span> <span class="string">'&lt;br&gt;'</span>; </div><div class="line">$arr = <span class="keyword">array</span>(<span class="string">'item1'</span>, <span class="string">'item2'</span>);</div><div class="line">print_r($arr);</div><div class="line"><span class="keyword">echo</span> <span class="string">'&lt;br&gt;'</span>; </div><div class="line"><span class="comment">//仅能通过下标访问</span></div><div class="line"><span class="keyword">echo</span> <span class="string">'$arr第一个元素是：'</span>, $arr[<span class="number">0</span>], <span class="string">'&lt;br&gt;&lt;br&gt;'</span>;</div><div class="line"></div><div class="line">$arr = [<span class="string">'key1'</span> =&gt; <span class="string">'value1'</span>, <span class="string">'key2'</span> =&gt; <span class="string">'value2'</span>];</div><div class="line">print_r($arr);</div><div class="line"><span class="keyword">echo</span> <span class="string">'&lt;br&gt;'</span>;</div><div class="line">$arr = <span class="keyword">array</span>(<span class="string">'key1'</span> =&gt; <span class="string">'value1'</span>, <span class="string">'key2'</span> =&gt; <span class="string">'value2'</span>);</div><div class="line">print_r($arr);</div><div class="line"><span class="keyword">echo</span> <span class="string">'&lt;br&gt;'</span>;</div><div class="line"><span class="comment">// 通过key访问</span></div><div class="line"><span class="keyword">echo</span> <span class="string">'$arr的key1值是：'</span>, $arr[<span class="string">'key1'</span>], <span class="string">'key2值是：'</span>, $arr[<span class="string">'key2'</span>], <span class="string">'&lt;br&gt;&lt;br&gt;'</span>;</div><div class="line"></div><div class="line">$arr = [<span class="string">'key1'</span> =&gt; [<span class="string">'a'</span>, <span class="string">'b'</span>], <span class="string">'key2'</span> =&gt; [<span class="string">'c'</span>, <span class="string">'d'</span>]];</div><div class="line">print_r($arr);</div><div class="line"><span class="keyword">echo</span> <span class="string">'&lt;br&gt;'</span>;</div><div class="line">$arr = <span class="keyword">array</span>(<span class="string">'key1'</span> =&gt; <span class="keyword">array</span>(<span class="string">'a'</span>, <span class="string">'b'</span>), <span class="string">'key2'</span> =&gt; <span class="keyword">array</span>(<span class="string">'c'</span>, <span class="string">'d'</span>));</div><div class="line">print_r($arr);</div><div class="line"><span class="keyword">echo</span> <span class="string">'&lt;br&gt;'</span>;</div><div class="line"><span class="comment">// 根据数组类型，通过key或者是下标访问</span></div><div class="line"><span class="keyword">echo</span> $arr[<span class="string">'key1'</span>][<span class="number">0</span>], $arr[<span class="string">'key2'</span>][<span class="number">1</span>];</div></pre></td></tr></table></figure>
<p><strong>Object 类型</strong></p>
<p>PHP中的Object类型，和编译性语言比较类似，是通过new class得到的。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</div><div class="line">  <span class="keyword">var</span> $userName;</div><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">setName</span><span class="params">($name)</span></span>&#123;</div><div class="line">    <span class="keyword">$this</span>-&gt;userName = $name;</div><div class="line">  &#125;</div><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">getName</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;userName;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line">$user = <span class="keyword">new</span> User();</div><div class="line">$user-&gt;setName(<span class="string">'Jay'</span>);</div><div class="line"><span class="keyword">echo</span> $user-&gt;getName();</div></pre></td></tr></table></figure>
<p>以上代码会输出：<code>Jay</code></p>
<h1 id="4、常量与变量"><a href="#4、常量与变量" class="headerlink" title="4、常量与变量"></a>4、常量与变量</h1><h2 id="4-1、常量"><a href="#4-1、常量" class="headerlink" title="4.1、常量"></a>4.1、常量</h2><p>PHP中的常量必须使用 <code>define</code> 函数来定义。语法如下：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">define(常量名称:string, 常量值, 是否区分大小写:bool-默认为<span class="keyword">false</span>);</div><div class="line"></div><div class="line"><span class="comment">//定义一个常量</span></div><div class="line">define(<span class="string">'PI'</span>, <span class="number">3.1415926</span>, <span class="keyword">true</span>);</div></pre></td></tr></table></figure>
<p>常量值被定义后，在脚本的其他任何地方都不能被改变，且常量是全局可用的。</p>
<h2 id="4-2、变量"><a href="#4-2、变量" class="headerlink" title="4.2、变量"></a>4.2、变量</h2><p>PHP的变量有如下几类：</p>
<ol>
<li>local - 局部变量</li>
<li>global - 全局变量</li>
<li>static - 静态变量</li>
<li>parameter - 参数变量</li>
</ol>
<h3 id="4-2-1、局部变量"><a href="#4-2-1、局部变量" class="headerlink" title="4.2.1、局部变量"></a>4.2.1、局部变量</h3><p>定义在函数中的变量，被称之为局部变量，只在当前函数有效。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">fun</span><span class="params">()</span></span>&#123;</div><div class="line">  $funName = <span class="string">'fun1'</span>;</div><div class="line">  <span class="keyword">echo</span> $funName;</div><div class="line">&#125;</div><div class="line">fun();</div><div class="line"><span class="keyword">echo</span> $funName; <span class="comment">// 出现警告：Undefined variable: funName</span></div></pre></td></tr></table></figure>
<h3 id="4-2-2、全局变量"><a href="#4-2-2、全局变量" class="headerlink" title="4.2.2、全局变量"></a>4.2.2、全局变量</h3><p>定义在函数外部的变量则是全局变量，如果要在函数内部使用，则需要使用global关键字。示例如下：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">$appName = <span class="string">'test'</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">fun1</span><span class="params">()</span></span>&#123;</div><div class="line">  <span class="comment">// 需要指定，当访问$appName时，是访问全局的$appName，否则会出现一个警告，未定义的变量。</span></div><div class="line">  <span class="keyword">global</span> $appName; </div><div class="line">  <span class="keyword">echo</span> $appName;</div><div class="line">&#125;</div><div class="line"></div><div class="line">fun1();</div></pre></td></tr></table></figure>
<h3 id="4-2-3、静态变量"><a href="#4-2-3、静态变量" class="headerlink" title="4.2.3、静态变量"></a>4.2.3、静态变量</h3><p>局部变量，一般是执行完函数，即被释放。如果想保留该变量，那么就可以使用静态变量。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">funs</span><span class="params">()</span></span>&#123;</div><div class="line">  $id = <span class="number">1</span>;</div><div class="line">  <span class="keyword">static</span> $static_id = <span class="number">1</span>;</div><div class="line">  <span class="keyword">echo</span> <span class="string">'$id = '</span>, $id, <span class="string">', $static_id='</span>, $static_id, <span class="string">'&lt;br&gt;'</span>;</div><div class="line">  $id++;</div><div class="line">  $static_id++;</div><div class="line">&#125;</div><div class="line">funs();</div><div class="line">funs();</div></pre></td></tr></table></figure>
<p>输出结果为：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$id = 1, $static_id=1</div><div class="line">$id = 1, $static_id=2</div></pre></td></tr></table></figure>
<p>我们可以看到 <code>$static_id</code> 并没有被释放，一直有效。</p>
<p><strong>注意：静态变量本质上还是局部变量。</strong></p>
<h3 id="4-2-4-参数变量"><a href="#4-2-4-参数变量" class="headerlink" title="4.2.4 参数变量"></a>4.2.4 参数变量</h3><p>这个没啥好说的，函数参数中的变量，类似于局部变量。</p>
<h3 id="4-2-5-超级全局变量"><a href="#4-2-5-超级全局变量" class="headerlink" title="4.2.5 超级全局变量"></a>4.2.5 超级全局变量</h3><p>什么是超级全局变量呢？</p>
<p>不需要特别定义，可直接在全局任何地方使用,是PHP预定义的全局变量。它们是：</p>
<ol>
<li>$GLOBALS</li>
<li>$_SERVER</li>
<li>$_REQUEST</li>
<li>$_POST</li>
<li>$_GET</li>
<li>$_FILES</li>
<li>$_ENV</li>
<li>$_COOKIE</li>
<li>$_SESSION</li>
</ol>
<h1 id="5、其他"><a href="#5、其他" class="headerlink" title="5、其他"></a>5、其他</h1><p>完整Demo地址：<a href="https://github.com/hstarorg/HstarDemoProject/blob/master/php_demo/04-grammar/01.php" target="_blank" rel="external">PHP语法演示Demo01</a></p>
<p>更多内容，请看下回分解。</p>


    
    
    
  </section>
</article>
    </div>
  
    <div class='post-wrapper'>
      <article class="post reveal">
  <section class="meta">
    
    <h2 class="title">
      <a href="/blog/2017/02/21/MongoDB入门基础/01_记一次MongoDB裸奔/">
        01_记一次MongoDB裸奔
      </a>
    </h2>
    
    <time>
      Feb 21, 2017
    </time>
		
  </section>
  <section class="article typo">
	  <h1 id="导言"><a href="#导言" class="headerlink" title="导言"></a>导言</h1><p>大意失荆州，裸奔的 <code>MongoDB</code> 被黑了。虽然并不是什么非常重要的数据，但也给自己敲响的一个警钟。虽然我们平时不容易接触到数据安全，但我们在开发，部署项目的时候，一定要养成良好的安全意识。</p>
<p>根据木桶原理，整个系统的安全性，取决于整个系统最薄弱的环节。所以，我们要尽可能多的考虑更多组成部分的安全性。</p>
<h1 id="事件发现"><a href="#事件发现" class="headerlink" title="事件发现"></a>事件发现</h1><p>本月初，发生了大家所熟知的 <code>MondoDB赎金事件</code>。当时本人也保持了一定的关注，并去 <a href="https://www.shodan.io/" target="_blank" rel="external">https://www.shodan.io/</a> 溜达了一圈，顺便连了几个裸奔的MongoDB（当然，绝未做任何更改）。</p>
<p>直到昨天下午，发现我应用的管理员账户登录不上了。多次检查密码，发现还是无法解决，此时有点怀疑被黑了。由于应用有新建用户功能，新建一个和管理员账户同名的账户，居然成功了。这个时候，我想多半是遭了，只等晚上回去确认了。</p>
<p>回到家，远程到服务器，一连接，果然遭了（可怜我那几十个代码片段 + 几个Gist），需要赎金0.1BTC。</p>
<h1 id="原因分析"><a href="#原因分析" class="headerlink" title="原因分析"></a>原因分析</h1><p>此时可能就要问了，都知道了裸奔不安全，为嘛还不修复？</p>
<p>我能说我懒么？心大么？</p>
<p>因为当时我部署的版本的3.2，据说3.2默认没有开启外网访问。我心大到直接未经尝试就认为这是对的。</p>
<p>实际这句话也没错，Linux版本的 <code>3.x</code> 确实是默认绑定到 <code>127.0.0.1</code> 上的。可TM我是运行在 <code>Windows</code> 上的，由于安装的时候，默认没有创建配置文件，导致一运行就绑定到所有host上了。</p>
<p><strong>当上，以上都是外因！根本原因还是自己疏忽大意，安全意识薄弱。</strong></p>
<h1 id="解决（重头再来）"><a href="#解决（重头再来）" class="headerlink" title="解决（重头再来）"></a>解决（重头再来）</h1><p>没有备份，直接无法恢复。</p>
<p>另外，0.1个BTC我是拿不出来的（我也不相信他会好心给你恢复），再加上数据也不是太重要，就直接把安全设置配置上，重头开始。</p>
<p>那现在是如何配置安全性的呢？</p>
<p>以下操作，均在未开启授权访问时执行</p>
<p>首先是添加用户并设置角色：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 切换到admin库</span></div><div class="line">use admin</div><div class="line"></div><div class="line"><span class="comment"># 创建User</span></div><div class="line">db.createUser(&#123;user: <span class="string">'&lt;name&gt;'</span>, <span class="built_in">pwd</span>: <span class="string">'&lt;password&gt;'</span>, roles: [</div><div class="line">	&#123;role: <span class="string">'readWrite'</span>, db: <span class="string">'&lt;dbname&gt;'</span>&#125;,</div><div class="line">	&#123;role: <span class="string">'dbAdmin'</span>, db: <span class="string">'&lt;dbname&gt;'</span>&#125;</div><div class="line">]&#125;)</div></pre></td></tr></table></figure>
<p>接下来就是创建一个配置文件（2.6之后，配置文件是yaml格式），内容如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">systemLog:</div><div class="line">    destination: file</div><div class="line">    path: c:\data\log\mongod.log</div><div class="line">storage:</div><div class="line">    dbPath: c:\data\db</div><div class="line">net:</div><div class="line">    bindIp: 127.0.0.1</div><div class="line">    port: 27017</div></pre></td></tr></table></figure>
<p><strong>注意：配置文件中一定要设定 <code>log path</code> 和 <code>db path</code></strong></p>
<p><strong>注意2：如果要限制外网访问，就可以配置 net -&gt; bindIp，另外也可以调整端口</strong></p>
<p>此时如何运行呢？</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mongod --config <span class="string">"D:\MongoDB\mongod.conf"</span> --auth</div></pre></td></tr></table></figure>
<p>带上 <code>--auth</code> 就是开启授权访问。</p>
<p>最后客户端访问也需要稍微修改下，只需要修改 <code>mongoAddress</code> 配置即可：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># MongoDB Connection String Format</span></div><div class="line">mongodb://[username:password@]host1[:port1][,host2[:port2],...[,hostN[:portN]]][/[database][?options]]</div><div class="line"></div><div class="line"><span class="comment"># 实例地址</span></div><div class="line">const mongoAddress = <span class="string">'mongodb://admin:Pwd0603@127.0.0.1:27017/dojo'</span></div></pre></td></tr></table></figure>
<h3 id="就这么一点简单的步骤，就能实现-MongoDB-较高的安全性，可这却是非常容易忽略的点。希望大家引以为戒。"><a href="#就这么一点简单的步骤，就能实现-MongoDB-较高的安全性，可这却是非常容易忽略的点。希望大家引以为戒。" class="headerlink" title="就这么一点简单的步骤，就能实现 MongoDB 较高的安全性，可这却是非常容易忽略的点。希望大家引以为戒。"></a>就这么一点简单的步骤，就能实现 <code>MongoDB</code> 较高的安全性，可这却是非常容易忽略的点。希望大家引以为戒。</h3><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><ol>
<li>一定不能疏忽大意，安全意识要加强。</li>
<li>一定要结果实际验证，才能下结论。不能不清楚外置条件，人云亦云。</li>
<li>不要有我的应用小，就不会被黑这种想法。批量攻击，才不会放过你。</li>
<li>定期做好数据备份，被攻击是一回事，能否恢复又是另外一回事了。</li>
</ol>


    
    
    
  </section>
</article>
    </div>
  
    <div class='post-wrapper'>
      <article class="post reveal">
  <section class="meta">
    
    <h2 class="title">
      <a href="/blog/2017/02/21/JS札记/那些不常见的JavaScript题目（下）/">
        那些不常见的JavaScript题目（下）
      </a>
    </h2>
    
    <time>
      Feb 21, 2017
    </time>
		
  </section>
  <section class="article typo">
	  <h2 id="0、导言"><a href="#0、导言" class="headerlink" title="0、导言"></a>0、导言</h2><p>JavaScript超乎寻常的灵活性，让JavaScript可以有很多特殊的用法，让我们来领略一下它们的风采吧。</p>
<p>此为下篇，上篇请查阅：<a href="那些不常见的JavaScript题目（上）.md">上篇</a></p>
<h2 id="1、那些不常见（好玩）的题目（下）"><a href="#1、那些不常见（好玩）的题目（下）" class="headerlink" title="1、那些不常见（好玩）的题目（下）"></a>1、那些不常见（好玩）的题目（下）</h2><hr>
<h3 id="1-21、"><a href="#1-21、" class="headerlink" title="1.21、"></a>1.21、</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Number</span>.MIN_VALUE &gt; <span class="number">0</span></div></pre></td></tr></table></figure>
<p><strong>解析：</strong> 此题考察数字的最小值，它的最小值是大于0的浮点数。</p>
<p><strong>答案：</strong> <code>true</code></p>
<hr>
<h3 id="1-22、"><a href="#1-22、" class="headerlink" title="1.22、"></a>1.22、</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[<span class="number">1</span> &lt; <span class="number">2</span> &lt; <span class="number">3</span>, <span class="number">3</span> &lt; <span class="number">2</span> &lt; <span class="number">1</span>]</div></pre></td></tr></table></figure>
<p><strong>解析：</strong> 此题考察运算顺序。直接从左往右计算，即可。等价于：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">[<span class="literal">true</span> &lt; <span class="number">3</span>, <span class="literal">false</span> &lt; <span class="number">1</span>]</div><div class="line">=&gt;</div><div class="line">[<span class="number">1</span> &lt; <span class="number">3</span>, <span class="number">0</span> &lt; <span class="number">1</span>]</div></pre></td></tr></table></figure>
<p><strong>答案：</strong> <code>[true, true]</code></p>
<hr>
<h3 id="1-23、"><a href="#1-23、" class="headerlink" title="1.23、"></a>1.23、</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="number">2</span> == [[[<span class="number">2</span>]]]</div></pre></td></tr></table></figure>
<p><strong>解析：</strong> 此题考察类型转化，全部调用toString(),转换为了<code>&#39;2&#39;</code></p>
<p><strong>答案：</strong> <code>true</code></p>
<hr>
<h3 id="1-24、"><a href="#1-24、" class="headerlink" title="1.24、"></a>1.24、</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="number">3.</span>toString();</div><div class="line"><span class="number">3.</span>.toString();</div><div class="line"><span class="number">3.</span>..toString();</div></pre></td></tr></table></figure>
<p><strong>解析：</strong> 此题考察.的结合性问题，对于到底属于数字还是函数调用呢，其实只能是数字。三个点是什么语法？</p>
<p><strong>注意：这也导致了整数字面量无法直接调用toString()</strong></p>
<p><strong>答案：</strong> <code>error, &#39;3&#39;, error</code></p>
<hr>
<h3 id="1-25、"><a href="#1-25、" class="headerlink" title="1.25、"></a>1.25、</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">var</span> x = y = <span class="number">1</span>;</div><div class="line">&#125;)();</div><div class="line"><span class="built_in">console</span>.log(y);</div><div class="line"><span class="built_in">console</span>.log(x);</div></pre></td></tr></table></figure>
<p><strong>解析：</strong> 此题考察作用域问题和var定义变量问题。当没有用var定义变量时，变量会成为全局变量。</p>
<p><strong>答案：</strong> <code>1, error</code></p>
<hr>
<h3 id="1-26、"><a href="#1-26、" class="headerlink" title="1.26、"></a>1.26、</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> a = <span class="regexp">/123/</span>, b = <span class="regexp">/123/</span>;</div><div class="line">a == b</div><div class="line">a === b</div></pre></td></tr></table></figure>
<p><strong>解析：</strong> 此题考察正则表达式比较，即使字面量相等，它们也不相等。</p>
<p><strong>答案：</strong> <code>false, false</code></p>
<hr>
<h3 id="1-27、"><a href="#1-27、" class="headerlink" title="1.27、"></a>1.27、</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>],</div><div class="line">    b = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>],</div><div class="line">    c = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>];</div><div class="line">a ==  b;</div><div class="line">a === b;</div><div class="line">a &gt; c;</div><div class="line">a &lt; c;</div></pre></td></tr></table></figure>
<p><strong>解析：</strong> 此题同样考察对象比较。当比较相等时，引用不同，所以皆不等。当比较大小时，会按照数组元素，依次比较字典序。</p>
<p><strong>答案：</strong> <code>false, false, false, true</code></p>
<hr>
<h3 id="1-28、"><a href="#1-28、" class="headerlink" title="1.28、"></a>1.28、</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> a = &#123;&#125;, b = <span class="built_in">Object</span>.prototype;</div><div class="line">[a.prototype === b, <span class="built_in">Object</span>.getPrototypeOf(a) === b]</div></pre></td></tr></table></figure>
<p><strong>解析：</strong> 此题比较有误导性，对于一个对象实例来说，获取原型的方法是：<code>a.constructor.prototype</code> 或者是 <code>Object.getPrototypeOf(a)</code>，对于 <code>a.prototype</code>，直接当成一个属性访问，由于未定义，所以会产生 <code>undefined</code>。</p>
<p><strong>答案：</strong> <code>false, true</code></p>
<hr>
<h3 id="1-29、"><a href="#1-29、" class="headerlink" title="1.29、"></a>1.29、</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123;&#125;</div><div class="line"><span class="keyword">var</span> a = f.prototype, b = <span class="built_in">Object</span>.getPrototypeOf(f);</div><div class="line">a === b</div></pre></td></tr></table></figure>
<p><strong>解析：</strong> 此题同样考察原型相关知识，前者是f的原型，后者是f的构造函数（Function）的原型。</p>
<p><strong>答案：</strong> <code>false</code></p>
<hr>
<h3 id="1-30、"><a href="#1-30、" class="headerlink" title="1.30、"></a>1.30、</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123; &#125;</div><div class="line"><span class="keyword">var</span> oldName = foo.name;</div><div class="line">foo.name = <span class="string">"bar"</span>;</div><div class="line">[oldName, foo.name]</div></pre></td></tr></table></figure>
<p><strong>解析：</strong> 函数的名称为常量，但需要注意，赋值不会报错。</p>
<p><strong>答案：</strong> <code>[&#39;foo&#39;, &#39;foo&#39;]</code></p>
<hr>
<h3 id="1-31、"><a href="#1-31、" class="headerlink" title="1.31、"></a>1.31、</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="string">"1 2 3"</span>.replace(<span class="regexp">/\d/g</span>, <span class="built_in">parseInt</span>)</div></pre></td></tr></table></figure>
<p><strong>解析：</strong> 此题考察 <code>String.replace()</code> 的回调函数，它的回调函数定义是 <code>funcation(matchValue, group, valueIndex, sourceStr){}</code>，依次为匹配到的值、正则分组，该值在字符串中的index，字符串本身。由于在该题中，正则没有分组，所以，调用了三次 <code>parseInt</code> 如下:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">parseInt</span>(<span class="string">'1'</span>, <span class="number">0</span>, <span class="string">'1 2 3'</span>);</div><div class="line"><span class="built_in">parseInt</span>(<span class="string">'2'</span>, <span class="number">2</span>, <span class="string">'1 2 3'</span>);</div><div class="line"><span class="built_in">parseInt</span>(<span class="string">'3'</span>, <span class="number">4</span>, <span class="string">'1 2 3'</span>);</div></pre></td></tr></table></figure>
<p><strong>答案：</strong> <code>&#39;1 NaN 3&#39;</code></p>
<hr>
<h3 id="1-32、"><a href="#1-32、" class="headerlink" title="1.32、"></a>1.32、</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123;&#125;</div><div class="line"><span class="keyword">var</span> parent = <span class="built_in">Object</span>.getPrototypeOf(f);</div><div class="line">f.name <span class="comment">// ?</span></div><div class="line">parent.name <span class="comment">// ?</span></div><div class="line"><span class="keyword">typeof</span> <span class="built_in">eval</span>(f.name) <span class="comment">// ?</span></div><div class="line"><span class="keyword">typeof</span> <span class="built_in">eval</span>(parent.name) <span class="comment">//  ?</span></div></pre></td></tr></table></figure>
<p><strong>解析：</strong> 通过 <code>Object.getPrototypeOf()</code> 获取原型，参数是实例，当f为实例的时候，获取实例f的原型就等于 <code>Function.prototype</code>，由于Function的原型还是一个function。所以 <code>parent = Function.prototype 是一个没有名字的function</code>。</p>
<p>因此:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">f.name <span class="comment">// f</span></div><div class="line">parent.name <span class="comment">// ''</span></div></pre></td></tr></table></figure></p>
<p>使用 <code>eval</code>，执行f，会返回f这个函数，执行’’,会返回 <code>undefined</code>。</p>
<p><strong>答案：</strong> <code>&#39;f&#39;, &#39;&#39;, &#39;function&#39;, &#39;undefined&#39;</code></p>
<hr>
<h3 id="1-33、"><a href="#1-33、" class="headerlink" title="1.33、"></a>1.33、</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> lowerCaseOnly =  <span class="regexp">/^[a-z]+$/</span>;</div><div class="line">[lowerCaseOnly.test(<span class="literal">null</span>), lowerCaseOnly.test()]</div></pre></td></tr></table></figure>
<p><strong>解析：</strong> 正则 <code>test()</code> 方法，会把参数当成字符串来使用，但要注意，<code>null</code> 会被当成 <code>&#39;null&#39;</code>来使用，无参则为 <code>undefined</code>。 </p>
<p><strong>答案：</strong> <code>[true, true]</code></p>
<hr>
<h3 id="1-34、"><a href="#1-34、" class="headerlink" title="1.34、"></a>1.34、</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[,,,].join(<span class="string">", "</span>)</div></pre></td></tr></table></figure>
<p><strong>解析：</strong>  由于JS的Array本质也是对象，所以具有对象的一个特点，会忽略最后一个单引号，<code>[,,,].length // 3</code>。</p>
<p>另外，这种方式定义，实际上是没有产生真正的key的。<code>[,,,] // [undefined * 3]</code></p>
<p><strong>答案：</strong> <code>[, , ]</code></p>
<hr>
<h3 id="1-35、"><a href="#1-35、" class="headerlink" title="1.35、"></a>1.35、</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> a = &#123;<span class="attr">class</span>: <span class="string">"Animal"</span>, <span class="attr">name</span>: <span class="string">'Fido'</span>&#125;;</div><div class="line">a.class</div></pre></td></tr></table></figure>
<p><strong>解析：</strong> 此题理应考察 <code>class</code> 为JS中的保留字，由于JS版本升级，此种写法已经可以正常返回属性值了。</p>
<p><strong>注意：在IE8-的浏览器中，会有语法错误，使用了保留字</strong> </p>
<p><strong>答案：</strong> <code>&#39;Animal&#39;</code></p>
<hr>
<h3 id="1-36、"><a href="#1-36、" class="headerlink" title="1.36、"></a>1.36、</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> a = <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="string">"epoch"</span>)</div></pre></td></tr></table></figure>
<p><strong>解析：</strong> 日期通过new返回的一定是一个Date对象，如果参数格式不合理，则会返回 <code>Invalid Date</code> 的日期对象。</p>
<p><strong>答案：</strong> <code>Invalid Date</code></p>
<hr>
<h3 id="1-37、"><a href="#1-37、" class="headerlink" title="1.37、"></a>1.37、</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> a = <span class="built_in">Function</span>.length,</div><div class="line">    b = <span class="keyword">new</span> <span class="built_in">Function</span>().length</div><div class="line">a === b</div></pre></td></tr></table></figure>
<p><strong>解析：</strong> <code>Function.length</code> 默认为1，<code>Function</code> 实例的 <code>length</code> 属性等于 <code>function</code>的参数个数。</p>
<p><strong>答案：</strong> <code>false</code></p>
<hr>
<h3 id="1-38、"><a href="#1-38、" class="headerlink" title="1.38、"></a>1.38、</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> a = <span class="built_in">Date</span>(<span class="number">0</span>);</div><div class="line"><span class="keyword">var</span> b = <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="number">0</span>);</div><div class="line"><span class="keyword">var</span> c = <span class="keyword">new</span> <span class="built_in">Date</span>();</div><div class="line">[a === b, b === c, a === c]</div></pre></td></tr></table></figure>
<p><strong>解析：</strong> 直接函数调用，不关心参数是啥，都会返回当前日期字符串。</p>
<p>通过 <code>new Date()</code>，如果无参数，返回当前日期对象。</p>
<p>通过 <code>new Date(0)</code>，就有一个参数，并且是数字，则参数含义为long类型的UTC时间。</p>
<p><strong>答案：</strong> <code>[false, false, false]</code></p>
<hr>
<h3 id="1-39、"><a href="#1-39、" class="headerlink" title="1.39、"></a>1.39、</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> min = <span class="built_in">Math</span>.min(), max = <span class="built_in">Math</span>.max()</div><div class="line">min &lt; max</div></pre></td></tr></table></figure>
<p><strong>解析：</strong> 此题考察 <code>Math.min()</code> 和 <code>Math.max()</code> 的用法。</p>
<p>当 <code>Math.min()</code> 无参数时，返回 <code>Infinity</code>，参考：<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/min" target="_blank" rel="external">MDN Math.min</a></p>
<p>当 <code>Math.max()</code> 无参数时，返回 <code>-Infinity</code>，参考：<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/max" target="_blank" rel="external">MDN Math.min</a></p>
<p><strong>答案：</strong> <code>false</code></p>
<hr>
<h3 id="1-40、"><a href="#1-40、" class="headerlink" title="1.40、"></a>1.40、</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> a = <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="string">"2014-03-19"</span>),</div><div class="line">    b = <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="number">2014</span>, <span class="number">03</span>, <span class="number">19</span>);</div><div class="line">[a.getDay() === b.getDay(), a.getMonth() === b.getMonth()]</div></pre></td></tr></table></figure>
<p><strong>解析：</strong> 此题考察使用年月日构造函数时，月份是从0开始计算的。</p>
<p><strong>答案：</strong> <code>[false, false]</code></p>
<h2 id="2、参考资料"><a href="#2、参考资料" class="headerlink" title="2、参考资料"></a>2、参考资料</h2><p><a href="https://developer.mozilla.org/en-US" target="_blank" rel="external">MDN</a> – Mozilla 开发者网络</p>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript" target="_blank" rel="external">MDN Javascrpt</a> –MDN JavaScript目录</p>


    
    
    
  </section>
</article>
    </div>
  
    <div class='post-wrapper'>
      <article class="post reveal">
  <section class="meta">
    
    <h2 class="title">
      <a href="/blog/2017/02/21/MongoDB入门基础/02_Mongo权限探索/">
        02_Mongo权限探索
      </a>
    </h2>
    
    <time>
      Feb 21, 2017
    </time>
		
  </section>
  <section class="article typo">
	  <h1 id="0x0、导言"><a href="#0x0、导言" class="headerlink" title="0x0、导言"></a>0x0、导言</h1><p>经过一次 <code>MongoDB</code> 被黑之后，就想把 <code>MongoDB</code> 的权限仔细的了解一遍。安全第一！安全第一！</p>
<p>为了避免版本不一致导致的差异，特此说明：以下命令均在 <code>Mongo3.4</code> 中测试，理论上支持所有 <code>3.x</code> 版本</p>
<h1 id="0x1、MongoDB权限系统"><a href="#0x1、MongoDB权限系统" class="headerlink" title="0x1、MongoDB权限系统"></a>0x1、MongoDB权限系统</h1><p><code>MongoDB</code> 的权限管理也是符合 <code>RBAC</code> 的权限系统。</p>
<p>既然是 <code>RBAC</code> 的权限管理，那么就一定会有 <code>actions</code> 和 <code>resources</code> 的概念。</p>
<p>在 <code>MongoDB</code> 中，每一种操作都对应一种 <code>action</code>，在 <a href="https://docs.mongodb.com/manual/reference/privilege-actions/" target="_blank" rel="external">Action List</a> 可以查看所有的 <code>Action</code> 列表</p>
<p>同理，<code>Collection/Database/Cluster</code> 都是 <code>Resrouce</code>, <code>resource</code> 列表也可以在 <a href="https://docs.mongodb.com/manual/reference/resource-document/" target="_blank" rel="external">Resource Document</a> 找到。</p>
<h2 id="1-1、如何授权启动"><a href="#1-1、如何授权启动" class="headerlink" title="1.1、如何授权启动"></a>1.1、如何授权启动</h2><p>在 <code>MongoDB</code> 中，默认是无授权启动的。如果我们要开启授权，那么需要在启动 <code>MongoDB</code> 的时候，加上 <code>--auth</code> 参数：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mongod --config <span class="string">"&lt;config path&gt;"</span> --auth</div></pre></td></tr></table></figure>
<p>如果使用配置文件，那么也可以直接配置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">security</div><div class="line">    authorization: enabled</div></pre></td></tr></table></figure>
<p><strong>注意：如果没有添加账户，就算设置 <code>--auth</code> 参数也无效，需要先添加用户，在添加用户的时候，必须要指定用户角色。</strong></p>
<h2 id="1-2、MongoDB角色管理"><a href="#1-2、MongoDB角色管理" class="headerlink" title="1.2、MongoDB角色管理"></a>1.2、MongoDB角色管理</h2><p>在 <code>MongoDB</code> 中，具有两种类型的角色，一类是系统角色，一类是自定义角色。</p>
<p>一般来说，我们只需要关注系统角色。自定义角色需要通过角色相关的Shell来进行CRUD。</p>
<h3 id="1-2-1、系统角色"><a href="#1-2-1、系统角色" class="headerlink" title="1.2.1、系统角色"></a>1.2.1、系统角色</h3><p><code>MongoDB</code> 按照分类，具有较多的角色，列举如下，也可在 <a href="https://docs.mongodb.com/manual/core/security-built-in-roles/" target="_blank" rel="external">security-built-in-roles</a> 查看所有内建角色明细。</p>
<ul>
<li><p>数据库用户相关角色</p>
<ol>
<li>read –只能查看单个数据库</li>
<li>readWrite – 可读写单个数据库</li>
</ol>
</li>
<li><p>数据库管理员相关角色</p>
<ol>
<li>dbAdmin – 数据库管理员，能进行差不多各种操作</li>
<li>dbOwner – 等于dbAdmin、readWrite、userAdmin的并集，数据库拥有者</li>
<li>userAdmin – 能够管理各种用户，角色等（如果是admin集合的，则能管理所有db）</li>
</ol>
</li>
<li><p>集群管理员相关角色</p>
<ol>
<li>clusterAdmin – 是clusterManager，clusterMonitor，clusterMonitor权限的集合，还多了个删除数据库操作。</li>
<li>clusterManager – 主要是配置集群</li>
<li>clusterMonitor – 主要是监控集群</li>
<li>hostManager – 主要是配置主机</li>
</ol>
</li>
<li><p>备份还原相关角色</p>
<ol>
<li>backup – 备份操作</li>
<li>restore – 还原操作</li>
</ol>
</li>
<li><p>针对所有DB的角色</p>
<ol>
<li>readAnyDatabase – 可读取所有的数据库</li>
<li>readWriteAnyDatabase – 可读写所有的数据库</li>
<li>userAdminAnyDatabase – 所有db的用户管理员</li>
<li>dbAdminAnyDatabase – 所有db的DB管理员</li>
</ol>
</li>
<li><p>超级管理员角色</p>
<ol>
<li>root – 超级超级管理员，最大权限了</li>
</ol>
</li>
<li><p>内部角色</p>
<ol>
<li>__system – 既然是内部角色，我们就不要去用了</li>
</ol>
</li>
</ul>
<h3 id="1-2-2、自定义角色"><a href="#1-2-2、自定义角色" class="headerlink" title="1.2.2、自定义角色"></a>1.2.2、自定义角色</h3><p>除了系统角色之外，还可以自定义角色，能够更灵活的控制权限。</p>
<p>详细，请参考：<a href="https://docs.mongodb.com/manual/reference/method/js-role-management/" target="_blank" rel="external">role-management</a></p>
<h2 id="1-2、MongoDB用户管理"><a href="#1-2、MongoDB用户管理" class="headerlink" title="1.2、MongoDB用户管理"></a>1.2、MongoDB用户管理</h2><p>有了Role的知识，我们来看User，就很easy了。</p>
<p>和一般的系统权限类似，MongoDB 也提供了诸多和用户相关的操作</p>
<ol>
<li>db.auth() – 用于登录</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">db.auth( &#123;</div><div class="line">   user: &lt;username&gt;, -- 用户</div><div class="line">   pwd: &lt;password&gt;, -- 密码</div><div class="line">   mechanism: &lt;authentication mechanism&gt;,  -- 可选，认证机制</div><div class="line">   digestPassword: &lt;boolean&gt; </div><div class="line">&#125; )</div></pre></td></tr></table></figure>
<ol>
<li>db.createUser()  – 创建用户</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&#123; user: &quot;&lt;name&gt;&quot;, -- 用户名</div><div class="line">  pwd: &quot;&lt;cleartext password&gt;&quot;, -- 密码</div><div class="line">  customData: &#123; &lt;any information&gt; &#125;, -- 自定义的数据</div><div class="line">  roles: [ -- 配置角色，db角色，设置数据库， 否则直接写角色名</div><div class="line">    &#123; role: &quot;&lt;role&gt;&quot;, db: &quot;&lt;database&gt;&quot; &#125; | &quot;&lt;role&gt;&quot;,</div><div class="line">    ...</div><div class="line">  ]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ol>
<li>db.updateUser() – 更新用户</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">db.updateUser(</div><div class="line">   &quot;&lt;username&gt;&quot;, -- 要更新的用户名</div><div class="line">   &#123; -- 要更新的用户对象</div><div class="line">     customData : &#123; &lt;any information&gt; &#125;,</div><div class="line">     roles : [</div><div class="line">               &#123; role: &quot;&lt;role&gt;&quot;, db: &quot;&lt;database&gt;&quot; &#125; | &quot;&lt;role&gt;&quot;,</div><div class="line">               ...</div><div class="line">             ],</div><div class="line">     pwd: &quot;&lt;cleartext password&gt;&quot;</div><div class="line">    &#125;,</div><div class="line">    writeConcern: &#123; &lt;write concern&gt; &#125;</div><div class="line">)</div></pre></td></tr></table></figure>
<p><strong>注：仅仅只需要更新role的话，考虑使用grantRolesToUser，revokeRolesFromUser</strong></p>
<ol>
<li>db.removeUser()</li>
<li>db.dropAllUsers()</li>
<li>db.dropUser()</li>
<li>db.grantRolesToUser()</li>
<li>db.revokeRolesFromUser()</li>
<li>db.getUser()</li>
<li>db.getUsers()</li>
</ol>
<p>其他用户方法都比较类似，查看详细： <a href="https://docs.mongodb.com/manual/reference/method/js-user-management/" target="_blank" rel="external">user-management</a></p>
<h1 id="0x2、使用授权的MongoDB"><a href="#0x2、使用授权的MongoDB" class="headerlink" title="0x2、使用授权的MongoDB"></a>0x2、使用授权的MongoDB</h1><p>如果在 <code>MongoDB</code> 中配置了授权，那么连接到带授权的 <code>MongoDB</code> 也会有些许区别。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 简单的MongoDB Connection String</span></div><div class="line">mongodb://127.0.0.1/testdb</div><div class="line"></div><div class="line"><span class="comment"># 带端口的MongoDB</span></div><div class="line">mongodb://127.0.0.1:27018/testdb</div><div class="line"></div><div class="line"><span class="comment"># 带授权的MongoDB</span></div><div class="line">mongodb://user1:password1@127.0.0.1:27017/testdb</div><div class="line"></div><div class="line"><span class="comment"># 带授权，且User是admin的场景</span></div><div class="line">mongodb://user1:password1@127.0.0.1:27017/testdb/?authSource=admin</div></pre></td></tr></table></figure>
<p>如果是 <code>shell</code>，则需要先执行 <code>db.auth(&#39;name&#39;, &#39;pwd&#39;)</code>，之后才能执行其他命令。</p>
<h1 id="0x3、总结"><a href="#0x3、总结" class="headerlink" title="0x3、总结"></a>0x3、总结</h1><p>加强安全意识，人为预防常规安全风险。</p>
<p><time>2017-1-21 16:09:48</time></p>


    
    
    
  </section>
</article>
    </div>
  
    <div class='post-wrapper'>
      <article class="post reveal">
  <section class="meta">
    
    <h2 class="title">
      <a href="/blog/2017/02/21/Angular相关/Angular从0到1：function（上）/">
        Angular从0到1：function（上）
      </a>
    </h2>
    
    <time>
      Feb 21, 2017
    </time>
		
  </section>
  <section class="article typo">
	  <h2 id="1、前言"><a href="#1、前言" class="headerlink" title="1、前言"></a>1、前言</h2><p>Angular作为最流行的前端MV*框架，在WEB开发中占据了重要的地位。接下来，我们就一步一步从官方api结合实践过程，来学习一下这个强大的框架吧。</p>
<p>Note：每个function描述标题之后的★标明了该function的重要程度（1~5星）。</p>
<h2 id="2、function（上）"><a href="#2、function（上）" class="headerlink" title="2、function（上）"></a>2、function（上）</h2><p>Angular封装了一系列公共方法，帮助我们更简单的使用JS。这些就是Angular的function。</p>
<h3 id="2-1、angular-bind-★"><a href="#2-1、angular-bind-★" class="headerlink" title="2.1、angular.bind(★)"></a>2.1、angular.bind(★)</h3><p>angular.bind类似于Function.prototype.bind，实现函数柯里化，返回一个函数代理。eg:</p>
<pre><code>函数原型
angular.bind(/*this对象*/self, /*要封装的function*/fn, /*参数列表*/args);

//原始函数
function fun(arg1, arg2, arg3) {
  console.log(this);
  console.log(arg1);
  console.log(arg2);
  console.log(arg3);
}
fun(&apos;arg1&apos;, &apos;arg2&apos;, &apos;arg3&apos;);
//如果几个常用参数都是固定的，而且该函数被调用频繁，那么就可以包装一下
var fun2 = angular.bind(window, fun, &apos;arg1&apos;, &apos;arg2&apos;);
//新的调用方式
fun2(&apos;arg3&apos;);
</code></pre><h3 id="2-2、angular-bootstrap-★★★★"><a href="#2-2、angular-bootstrap-★★★★" class="headerlink" title="2.2、angular.bootstrap(★★★★)"></a>2.2、angular.bootstrap(★★★★)</h3><p>用于使用angular执行渲染元素。也是angular的启动方法，如果没有在页面上指定ng-app,必须要手动调用该函数进行启动。</p>
<pre><code>angular.bootstrap(/*Dom元素*/element, /*Array/String/Function*/[modules], /*Object*/[config]);

//常规用法
angular.bootstrap(document, [&apos;app&apos;])
//带配置项
angular.bootstrap(document, [&apos;app&apos;], {strictDi: true/*Defaults: false*/})
</code></pre><h3 id="2-3、angular-copy-★★★★★"><a href="#2-3、angular-copy-★★★★★" class="headerlink" title="2.3、angular.copy(★★★★★)"></a>2.3、angular.copy(★★★★★)</h3><p>Angular.copy用于复制对象，由于angular的双向绑定特点，那么如果直接操作$scope对象，那么很容易就会改变ui的显示，这个时候就需要借助angular.copy来创建一个对象副本，并进行操作。</p>
<pre><code>//原型
angular.copy(source, [destination]);

var obj = {a: 1};
var obj2 = angular.copy(obj);
var obj3;
angular.copy(obj, obj3);
console.log(obj2 === obj) //false
console.log(obj3 === obj) //false
var obj4;
//第二个和参数和返回值是相等的，而且第二个参数不管以前是什么，都会被重新赋值
var obj5 = angular.copy(obj, obj4);
console.log(obj4 === obj5); //true
</code></pre><h3 id="2-4、angular-element-★★★★"><a href="#2-4、angular-element-★★★★" class="headerlink" title="2.4、angular.element(★★★★)"></a>2.4、angular.element(★★★★)</h3><p>等价与jQuery的选择器，如果在angular之前没有引入jQuery，那么就使用jqLite包装.</p>
<pre><code>angular.element(&apos;body&apos;);
//等价于
$(&apos;body&apos;);

//用法
var $body = angular.element(&apos;body&apos;);
</code></pre><h3 id="2-5、angular-equals-★★"><a href="#2-5、angular-equals-★★" class="headerlink" title="2.5、angular.equals(★★)"></a>2.5、angular.equals(★★)</h3><p>用于比较两个对象是否相等，如下示例的规则和JS有区别，注意识别。</p>
<pre><code>var obj1 = {a: 1};
var obj2 = obj1;
//引用一致，则相等
console.log(angular.equals(obj1, obj2)); // true

obj2 = {a: 1};
//引用不一致，对象表现一致，则相等
console.log(angular.equals(obj1, obj2)); // true

obj2 = {a: 1,$a: 2};
//对象比较时，忽略以$开头的属性
console.log(angular.equals(obj1, obj2)); // true

obj1 = /aa/;
obj2 = /aa/;
//正则表达式表现相等，则相等
console.log(angular.equals(obj1, obj2)); // true

//NaN与NaN比较，则相等
console.log(angular.equals(NaN, NaN)); // true
</code></pre><h3 id="2-6、angular-extend-★★"><a href="#2-6、angular-extend-★★" class="headerlink" title="2.6、angular.extend(★★)"></a>2.6、angular.extend(★★)</h3><p>功能上和jQuery.extend没多大差异</p>
<pre><code>//原型-第一个参数为目标，之后的参数为源，同时返回dst
angular.extend(dst, src);

//示例
var obj1 = {a: 1};
var obj2 = angular.extend(obj1, {a: 2}, {b: 3});
console.log(obj1)
console.log(obj1 === obj2); //true
</code></pre><h3 id="2-7、angular-forEach-★★★★★"><a href="#2-7、angular-forEach-★★★★★" class="headerlink" title="2.7、angular.forEach(★★★★★)"></a>2.7、angular.forEach(★★★★★)</h3><p>angular.forEach用于遍历对象或者数组，类似于ES5的Array.prototype.forEach</p>
<pre><code>//原型
angular.forEach(obj, iterator, [context]);

var values = {name: &apos;misko&apos;, gender: &apos;male&apos;};
var arr = [&apos;misko&apos;, &apos;male&apos;];
angular.forEach(values, function (value, key) {
  console.log(key + &apos; = &apos; + value);
});
angular.forEach(arr, function (value, i) {
  console.log(i + &apos; = &apos; + value);
});
//还可以传递this
var obj = {};
angular.forEach(values, function (value, key) {
  obj[key] = value;
}, obj);
console.log(obj);
</code></pre><h3 id="2-8、angular-fromJson-★★★"><a href="#2-8、angular-fromJson-★★★" class="headerlink" title="2.8、angular.fromJson(★★★)"></a>2.8、angular.fromJson(★★★)</h3><p>angular.fromJson将JSON字符串转换为JSON对象，注意，必须严格满足JSON格式，比如属性必须双引号，该函数内部实现是利用JSON.parse()。</p>
<pre><code>//原型
angular.fromJson(/*string*/ jsonString)

var jsonString = &apos;{&quot;p1&quot;: &quot;xx&quot;, &quot;p2&quot;: 1, &quot;p3&quot;: true}&apos;;
var jsonObj = angular.fromJson(jsonString);
console.log(jsonObj);
</code></pre><h3 id="2-9、angular-toJson-★★★"><a href="#2-9、angular-toJson-★★★" class="headerlink" title="2.9、angular.toJson(★★★)"></a>2.9、angular.toJson(★★★)</h3><p>angular.toJson可以将对象，数组，日期，字符串，数字转换为json字符串</p>
<pre><code>//原型
angular.toJson(obj, pretty);

var obj = {p1: 1, p2: true, p3: &apos;2&apos;};
var jsonString = angular.toJson(obj);
console.log(jsonString);
//美化输出格式（设置为true，默认采用2个字符缩进）
jsonString = angular.toJson(obj, true);
console.log(jsonString);
//还可以设置缩进字符数
jsonString = angular.toJson(obj, 10);
console.log(jsonString);
</code></pre><h3 id="2-10、angular-identity-★"><a href="#2-10、angular-identity-★" class="headerlink" title="2.10、angular.identity(★)"></a>2.10、angular.identity(★)</h3><p>angular.identity返回该函数参数的第一个值。编写函数式代码时，非常有用（待使用）。</p>
<pre><code>//官方示例
function transformer(transformationFn, value) {
  return (transformationFn || angular.identity)(value);
};
//简单演示
var value = angular.identity(&apos;a&apos;, 1, true);
console.log(value); // &apos;a&apos;
</code></pre><h3 id="2-11、angular-injector-★★"><a href="#2-11、angular-injector-★★" class="headerlink" title="2.11、angular.injector(★★)"></a>2.11、angular.injector(★★)</h3><p>angular.injector能够创建一个injector对象，可以用于检索services以及用于依赖注入。</p>
<pre><code>//原型，[strictDi]默认false，如果true，表示执行严格依赖模式，
//angular则不会根据参数名称自动推断类型，必须使用[&apos;xx&apos;, function(xx){}]这种形式。
angular.injector(modules, [strictDi]); 

//定义模块A
var moduleA = angular.module(&apos;moduleA&apos;, [])
  .factory(&apos;F1&apos;, [function () {
    return {
      print: function () {
        console.log(&apos;I\&apos;m F1 factory&apos;);
      }
    }
  }]);
var $injector = angular.injector([&apos;moduleA&apos;])
$injector.invoke(function (F1) {
  console.log(F1.print());
});
//此种写法会报错，因为是严格模式
var $injector2 = angular.injector([&apos;moduleA&apos;], true)
$injector2.invoke(function (F1) {
  console.log(F1.print());
});
//可以采用如下写法
$injector2.invoke([&apos;F1&apos;, function (F1) {
  console.log(F1.print());
}]);
</code></pre><h3 id="2-12、angular-module-★★★★★"><a href="#2-12、angular-module-★★★★★" class="headerlink" title="2.12、angular.module(★★★★★)"></a>2.12、angular.module(★★★★★)</h3><p>angular.module可以说是最常用的function了。通过它，可以实现模块的定义，模块的获取。</p>
<pre><code>//定义模块A
var moduleA = angular.module(&apos;moduleA&apos;, []);
//定义模块B，模块B依赖moduleA
var moduleB = angular.module(&apos;moduleB&apos;, [&apos;moduleB&apos;]);

//可以在第三个参数上设置配置函数
var moduleB = angular.module(&apos;moduleB&apos;, [&apos;moduleB&apos;], [&apos;$locationProvider&apos;, function ($locationProvider) {
  console.log($locationProvider);
}]);
//等价于
var moduleB = angular.module(&apos;moduleB&apos;, [&apos;moduleB&apos;])
.config([&apos;$locationProvider&apos;, function ($locationProvider) {
  console.log($locationProvider);
}]);

//获取模块
angular.bootstrap(document, [&apos;moduleB&apos;]);
</code></pre>

    
    
    
  </section>
</article>
    </div>
  
    <div class='post-wrapper'>
      <article class="post reveal">
  <section class="meta">
    
    <h2 class="title">
      <a href="/blog/2017/02/21/SQL SERVER/说说你所熟知的MSSQL中的substring函数/">
        说说你所熟知的MSSQL中的substring函数
      </a>
    </h2>
    
    <time>
      Feb 21, 2017
    </time>
		
  </section>
  <section class="article typo">
	  <p>说说你所熟知的MSSQL中的substring函数</p>
<p>###函数签名：</p>
<pre><code>substring
    --expression (varchar,nvarchar,text,ntext,varbinary,or image)
    --Starting position (bigint)
    --Length (bigint)

从函数名称来看，是截取字符串内容。
从函数签名来看，不仅能截取字符串内容，还能截取二进制内容
</code></pre><p>###那么，你觉得如下应该sql语句应该是什么结果呢？</p>
<pre><code>select subString(&apos;123456&apos;,0,1)
select subString(&apos;123456&apos;,1,1)
select subString(&apos;123456&apos;,-1,2)
select subString(&apos;123456&apos;,-1,3) 
</code></pre><p>###如果想好了，但不确定，那赶紧打开工具执行看看吧</p>
<pre><code>你答对了吗？为什么会是那些结果，能解释吗？
</code></pre><p>###三大知识点：</p>
<pre><code>1. MSSQL中，下标从1开始，注意：不是大多数编程语言采用的1。
2. substring函数的调用substring(str,startIndex,length)
   效果上是转换为substring(str,startIndex,endIndex)来运算的，
   endIndex=startIndex+length。
3. 对于区间取值，采取的是前闭后开的策略，也有是说包含开始下标，但是不包含结束下标。
</code></pre><h3 id="那么能解释上面的代码了吗？"><a href="#那么能解释上面的代码了吗？" class="headerlink" title="那么能解释上面的代码了吗？"></a>那么能解释上面的代码了吗？</h3>

    
    
    
  </section>
</article>
    </div>
  
    <div class='post-wrapper'>
      <article class="post reveal">
  <section class="meta">
    
    <h2 class="title">
      <a href="/blog/2017/02/21/Other/Thrift简单实践/">
        Thrift简单实践
      </a>
    </h2>
    
    <time>
      Feb 21, 2017
    </time>
		
  </section>
  <section class="article typo">
	  <h2 id="0、什么是RPC"><a href="#0、什么是RPC" class="headerlink" title="0、什么是RPC"></a>0、什么是RPC</h2><p><strong>RPC</strong>（Remote Procedure Call - 远程过程调用）,是通过网络从远程计算机上请求服务，而不需要了解底层网路技术的细节。简单点说，就是<strong>像调用本地服务（方法）一样调用远端的服务（方法）。</strong></p>
<h3 id="RPC与REST的区别"><a href="#RPC与REST的区别" class="headerlink" title="RPC与REST的区别"></a>RPC与REST的区别</h3><p>RPC是一种协议，REST是一种架构风格。</p>
<p>RPC以行为为中心，REST以资源为中心。当加入新功能时，RPC需要增加更多的行为，并进行调用。REST的话，调用方法基本不变。</p>
<p>RPC可以不基于HTTP协议，因此在后端语言调用中，可以采用RPC获得更好的性能。REST一般是基于HTTP协议。</p>
<h2 id="1、RPC框架Thrift（0-9-3）"><a href="#1、RPC框架Thrift（0-9-3）" class="headerlink" title="1、RPC框架Thrift（0.9.3）"></a>1、RPC框架Thrift（0.9.3）</h2><p>Thrift是一种开源的高效的、支持多种编程语言的远程服务调用框架。支持C++, Java, Python, PHP, Ruby, Erlang, Perl, Haskell, C#, Cocoa, JavaScript, Node.js, Smalltalk, OCaml 和 Delphi等诸多语言，能够很好的进行跨语言调用。</p>
<p>Thrift官网： <a href="https://thrift.apache.org/" target="_blank" rel="external">https://thrift.apache.org/</a></p>
<h2 id="2、Thrift的简单实践（Windows）"><a href="#2、Thrift的简单实践（Windows）" class="headerlink" title="2、Thrift的简单实践（Windows）"></a>2、Thrift的简单实践（Windows）</h2><h3 id="2-1-安装Thrift"><a href="#2-1-安装Thrift" class="headerlink" title="2.1 安装Thrift"></a>2.1 安装Thrift</h3><p>在<a href="http://www.apache.org/dyn/closer.cgi?path=/thrift/0.9.3/thrift-0.9.3.exe" target="_blank" rel="external">http://www.apache.org/dyn/closer.cgi?path=/thrift/0.9.3/thrift-0.9.3.exe</a>这里可以下载Thrift的windows系统编译版本。</p>
<p>该文件是一个绿色文件，可以放置在目录中，进入该目录的cmd，就可以直接使用thrift。输入<code>thrift -version</code>可以查看当前Thrift的版本。</p>
<p><img src="http://7xit2j.com1.z0.glb.clouddn.com/abc1.png" alt="img1"></p>
<p>至此，Thrift已完成安装</p>
<h3 id="2-2-编写接口定义文件"><a href="#2-2-编写接口定义文件" class="headerlink" title="2.2 编写接口定义文件"></a>2.2 编写接口定义文件</h3><p>在安装好Thrift之后，需要我们编写接口定义文件，用来约定服务和thrift类型的接口定义。</p>
<p>Thrift主要有一下这些类型：</p>
<ol>
<li>bool     –简单类型，true or false</li>
<li>byte     –简单类型，单字符</li>
<li>i16      –简单类型，16位整数</li>
<li>i32      –简单类型，32位整数</li>
<li>i64      –简单类型，64位整数</li>
<li>double   –简单类型，双精度浮点型</li>
<li>string   –简单类型，utf-8编码字符串</li>
<li>binary   –二进制，未编码的字符序列</li>
<li>struct    –结构体，对应结构体、类等对象类型</li>
<li>list    –list容器</li>
<li>set     –set容器</li>
<li>map     –map容器</li>
<li>enum    –枚举类型</li>
</ol>
<p>接下来，利用这些类型，编写一个简单的.thrift接口定义文件。</p>
<pre><code>/* 1.thrift file content */
namespace js ThriftTest
namespace csharp ThriftTest

service ThriftTest{
  double plus(1:double num1, 2:double num2)
}
</code></pre><p>更复杂的案例： <a href="https://git-wip-us.apache.org/repos/asf?p=thrift.git;a=blob_plain;f=test/ThriftTest.thrift;hb=HEAD" target="_blank" rel="external">https://git-wip-us.apache.org/repos/asf?p=thrift.git;a=blob_plain;f=test/ThriftTest.thrift;hb=HEAD</a></p>
<p>在利用<code>thrift --gen js:node --gen js 1.thrift</code>来生成好客户端代码和服务端代码。可以跟多个–gen <language>参数，来实现一次性生成多个语言的代码。</language></p>
<h3 id="2-3-利用Thrift实现nodeJS服务端"><a href="#2-3-利用Thrift实现nodeJS服务端" class="headerlink" title="2.3 利用Thrift实现nodeJS服务端"></a>2.3 利用Thrift实现nodeJS服务端</h3><pre><code>var thrift = require(&apos;thrift&apos;);

var ThriftTest = require(&quot;./gen-nodejs/ThriftTest&quot;);
var ttypes = require(&quot;./gen-nodejs/1_types&quot;);


var nodeServer = thrift.createServer(ThriftTest, {
  //完成具体的事情
  plus: function(n1, n2, callback){
    console.log(`server request, n1 = ${n1}, n2 = ${n2}.`);
    callback(null, n1 + n2);
  }
});

//处理错误，假设不处理，如果客户端强制断开连接，会导致后端程序挂掉
nodeServer.on(&apos;error&apos;, function(err){
  console.log(err);
});

nodeServer.listen(7410);
console.log(&apos;node server started... port: 7410&apos;);

//如果client的浏览器，通信采用http的时候，需要创建http server
var httpServer = thrift.createWebServer({
  cors: {&apos;*&apos;: true}, //配置跨域访问
  services: {
    &apos;/thrift&apos;: { //配置路径映射
      transport: thrift.TBufferedTransport,
      protocol: thrift.TJSONProtocol,
      processor: ThriftTest,
      handler: { //具体的处理对象
        plus: function(n1, n2, callback) {
          console.log(`http request, n1 = ${n1}, n2 = ${n2}.`);
          callback(null, n1 + n2);
        }
      }
    }
  }
});

httpServer.on(&apos;error&apos;, function(err) {
  console.log(err);
});

httpServer.listen(7411);
console.log(&apos;http server started... port: 7411&apos;);
</code></pre><h3 id="2-4-Node-Client-调用"><a href="#2-4-Node-Client-调用" class="headerlink" title="2.4 Node Client 调用"></a>2.4 Node Client 调用</h3><pre><code>var thrift = require(&apos;thrift&apos;);
var ThriftTest = require(&apos;./gen-nodejs/ThriftTest&apos;);
var ttypes = require(&apos;./gen-nodejs/1_types&apos;);

transport = thrift.TBufferedTransport()
protocol = thrift.TBinaryProtocol()

var connection = thrift.createConnection(&quot;localhost&quot;, 7410, {
  transport : transport,
  protocol : protocol
});

connection.on(&apos;error&apos;, function(err) {
  console.log(false, err);
});

var client = thrift.createClient(ThriftTest, connection);

var sum = client.plus(1, 1, function(err, result){
  //connection.end(); //如果不关闭连接，那么强制断开连接，将会导致后端出现error
  if(err){
    console.log(err);
    return;
  }
  console.log(result);
});
</code></pre><h3 id="2-5、Http-Client-调用"><a href="#2-5、Http-Client-调用" class="headerlink" title="2.5、Http Client 调用"></a>2.5、Http Client 调用</h3><pre><code>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;UTF-8&quot;&gt;
  &lt;title&gt;Thrift Test Client&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;input type=&quot;text&quot; id=&quot;num1&quot;&gt; + &lt;input type=&quot;text&quot; id=&quot;num2&quot;&gt; &lt;button onclick=&quot;call()&quot;&gt;=&lt;/button&gt; &lt;span id=&quot;result&quot;&gt;?&lt;/span&gt;
 &lt;!--  &lt;script src=&quot;jquery.js&quot;&gt;&lt;/script&gt; --&gt;
  &lt;script src=&quot;thrift.js&quot;&gt;&lt;/script&gt;
  &lt;script src=&quot;gen-js/1_types.js&quot;&gt;&lt;/script&gt;
  &lt;script src=&quot;gen-js/ThriftTest.js&quot;&gt;&lt;/script&gt;
  &lt;script&gt;
    var transport = new Thrift.Transport(&quot;http://127.0.0.1:7411/thrift&quot;);
    var protocol = new Thrift.TJSONProtocol(transport);
    var client = new ThriftTest.ThriftTestClient(protocol);
    var el_result = document.getElementById(&apos;result&apos;);
    function call(){
      var num1 = +document.getElementById(&apos;num1&apos;).value,
      num2 = +document.getElementById(&apos;num2&apos;).value;
      client.plus(num1, num2, function(result) {
        el_result.innerText = result;
        alert(&apos;调用成功！&apos;);
      });
    }
  &lt;/script&gt;
  &lt;script&gt;
  &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre><p><strong>注意：如果在thrift生成代码时，使用了–gen js:jquery参数，那么在浏览器调用的时候，就必须依赖jquery。</strong></p>
<h2 id="3、demo地址"><a href="#3、demo地址" class="headerlink" title="3、demo地址"></a>3、demo地址</h2><p><a href="https://github.com/hstarorg/HstarDemoProject/tree/master/thrift_demo" target="_blank" rel="external">https://github.com/hstarorg/HstarDemoProject/tree/master/thrift_demo</a></p>


    
    
    
  </section>
</article>
    </div>
  
    <div class='post-wrapper'>
      <article class="post reveal">
  <section class="meta">
    
    <h2 class="title">
      <a href="/blog/2017/02/21/PHP学习之路/01_PHP简易安装环境/">
        01_PHP简易安装环境
      </a>
    </h2>
    
    <time>
      Feb 21, 2017
    </time>
		
  </section>
  <section class="article typo">
	  <h2 id="0、导言"><a href="#0、导言" class="headerlink" title="0、导言"></a>0、导言</h2><p><strong>PHP</strong> 是啥，我想应该不用解释了吧。</p>
<p>最近发布的最新版本 <code>PHP7</code> ，提供之前版本的2倍速度提升，感觉很有吸引力哈。在看到2016年编程语言趋势和想到之前也想体验一下 <code>PHP</code> 的情况下，就说干就干，直接来简单学习下这门语言。</p>
<h2 id="1、PHP简易环境搭建"><a href="#1、PHP简易环境搭建" class="headerlink" title="1、PHP简易环境搭建"></a>1、PHP简易环境搭建</h2><h3 id="1-1、PHP安装"><a href="#1-1、PHP安装" class="headerlink" title="1.1、PHP安装"></a>1.1、PHP安装</h3><p><code>PHP</code> 的安装相当简单，打开 <code>PHP</code> 的下载地址：<a href="http://php.net/downloads.php" target="_blank" rel="external">http://php.net/downloads.php</a>，可以看到它的版本下载。</p>
<p>我这里是 Windows 环境，就点击 【Windows downloads】 进入Windows版本的PHP下载地址： <a href="http://windows.php.net/download#php-7.0" target="_blank" rel="external">http://windows.php.net/download#php-7.0</a> 。在这里找到对应的版本下载即可。</p>
<p><strong>注意：请下载对应x86,x64的zip包，不要下载Debug Pack包。至于Non Thread Safe 与 Thread Safe，由于本人刚接触，不知道有什么区别，随意下载一个就行。</strong> </p>
<p>我是Win10 x64版本，所以直接下载的：【VC14 x64 Non Thread Safe (2016-May-25 23:02:13)】（有最新版本下载最新版本即可）。</p>
<p>下载好之后，是一个压缩包。解压到目录中，在环境变量中配置 <code>Path</code> 为该目录。</p>
<p>打开 <code>cmd</code> 窗口，执行 <code>php -v</code> ，如果输出 <code>PHP</code> 的版本号，则表示安装成功！</p>
<h3 id="1-2、IDE的选择"><a href="#1-2、IDE的选择" class="headerlink" title="1.2、IDE的选择"></a>1.2、IDE的选择</h3><p>PHP有比较多IDE，这里推荐 <a href="https://www.jetbrains.com/phpstorm/" target="_blank" rel="external">PhpStorm</a> 和 <a href="https://code.visualstudio.com/" target="_blank" rel="external">VsCode</a>。</p>
<p>本人使用的 <code>VsCode</code>，足够轻量。</p>
<h3 id="1-3、依赖管理工具"><a href="#1-3、依赖管理工具" class="headerlink" title="1.3、依赖管理工具"></a>1.3、依赖管理工具</h3><p>一个成熟的语言，一定会有很多现成的包，如C#的Nuget，Node的npm。在PHP中，也有同样的工具：Composer。</p>
<p><em>如何在Windows下使用：Composer？</em></p>
<p>首先，进入Composer下载地址：<a href="https://getcomposer.org/download/" target="_blank" rel="external">https://getcomposer.org/download/</a>，找到【Composer-Setup.exe】，然后下载安装。</p>
<p>安装成功之后在控制台执行：<code>composer</code> 会输出一系列命令，则证明安装成功。</p>
<p>然后就可以通过 <code>composer install &lt;package&gt;</code> 来安装依赖包了。 想了解更多 <code>composer</code> 命令，请查询：<a href="https://getcomposer.org/doc/" target="_blank" rel="external">https://getcomposer.org/doc/</a>。</p>
<p><strong>注意，我在Windows中使用composer安装时，先使用了 <code>composer config disable-tls true</code> 和 <code>composer config secure-http false</code> 才得以成功安装依赖。</strong></p>
<h3 id="1-4、Server程序"><a href="#1-4、Server程序" class="headerlink" title="1.4、Server程序"></a>1.4、Server程序</h3><p>PHP自带有一个命令行的Server，用于开发测试已经足够使用了。所以，我直接使用了该Server。</p>
<p>只需要在php项目的根目录，打开cmd，执行 <code>php -S localhost:9999</code> 就可以启动一个PHP Server了。</p>
<p>想了解更多关于PHP自带的Web Server，请参考 <a href="http://php.net/features.commandline.webserver" target="_blank" rel="external">http://php.net/features.commandline.webserver</a></p>
<h2 id="2、Hello-PHP"><a href="#2、Hello-PHP" class="headerlink" title="2、Hello PHP"></a>2、Hello PHP</h2><p>新建一个目录，创建 <code>index.php</code>，输入以下内容：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">  mb_internal_encoding(<span class="string">'UTF-8'</span>);</div><div class="line"></div><div class="line">  mb_http_output(<span class="string">'UTF-8'</span>);</div><div class="line"><span class="meta">?&gt;</span></div><div class="line">&lt;!doctype html&gt;</div><div class="line">&lt;html&gt;</div><div class="line">  &lt;head&gt;</div><div class="line">    &lt;title&gt;Php Info&lt;/title&gt;</div><div class="line">  &lt;/head&gt;</div><div class="line">  &lt;body&gt;</div><div class="line">    <span class="meta">&lt;?php</span></div><div class="line">      phpinfo();</div><div class="line">    <span class="meta">?&gt;</span></div><div class="line">  &lt;/body&gt;</div><div class="line">&lt;/html&gt;</div></pre></td></tr></table></figure>
<p>打开控制台，使用 <code>php -S localhost:9999</code> 启动WebServer。</p>
<p>用浏览器访问 <a href="http://localhost:9999" target="_blank" rel="external">http://localhost:9999</a>，就可以看到当前服务器的PHP环境信息了。</p>
<h2 id="3、Other"><a href="#3、Other" class="headerlink" title="3、Other"></a>3、Other</h2><p>3.1、推荐资料： <a href="http://laravel-china.github.io/php-the-right-way/" target="_blank" rel="external">PHP之道</a></p>
<p>3.2、PHP的编码问题，一般在php的页面上，我们都需要设置：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">  mb_internal_encoding(<span class="string">'UTF-8'</span>); <span class="comment">//内部编码为UTF-8</span></div><div class="line"></div><div class="line">  mb_http_output(<span class="string">'UTF-8'</span>); <span class="comment">//服务器输出内容编码为UTF-8</span></div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure>
<p>要想用Server运行含有该代码的PHP页面。需要特别配置一下 <code>php.ini</code> 文件。</p>
<p>在PHP的解压目录，找到 <code>php.ini-development</code>，复制一份为 <code>php.ini</code>，然后找到 <code>extension_dir</code>，设置为：<code>extension_dir = &quot;你的PHP解压目录\ext&quot;</code>，然后找到 <code>;extension=php_mbstring.dll</code> 去掉前面的注释。</p>
<p>3.3、PHP框架推荐</p>
<ul>
<li>Yaf 官方框架，超高性能</li>
</ul>
<p><a href="http://www.laruence.com/manual/index.html" target="_blank" rel="external">http://www.laruence.com/manual/index.html</a></p>
<p><a href="http://php.net/manual/zh/yaf.installation.php" target="_blank" rel="external">http://php.net/manual/zh/yaf.installation.php</a></p>
<ul>
<li>LazyPHP 超级简单的框架，建议读源码</li>
</ul>
<p><a href="https://github.com/easychen/LazyPHP" target="_blank" rel="external">https://github.com/easychen/LazyPHP</a></p>
<ul>
<li>Slim 据说还不错</li>
</ul>
<p><a href="http://www.slimframework.com/" target="_blank" rel="external">http://www.slimframework.com/</a></p>
<ul>
<li>Laravel 高人气框架</li>
</ul>
<p><a href="https://laravel.com/" target="_blank" rel="external">https://laravel.com/</a></p>
<p><a href="https://lumen.laravel.com/" target="_blank" rel="external">https://lumen.laravel.com/</a>  专注API开发的PHP。</p>
<ul>
<li>ThinkPHP 中文</li>
</ul>
<p><a href="http://www.thinkphp.cn/" target="_blank" rel="external">http://www.thinkphp.cn/</a></p>
<ul>
<li>InitPHP (A PHP Framework) - (from github)</li>
</ul>
<p><a href="http://www.initphp.com/" target="_blank" rel="external">http://www.initphp.com/</a></p>
<ul>
<li>TinyMVC (from github)</li>
</ul>
<p><a href="https://github.com/mohrt/tinymvc-php" target="_blank" rel="external">https://github.com/mohrt/tinymvc-php</a></p>


    
    
    
  </section>
</article>
    </div>
  
</section>


  <nav id="page-nav">
    
    <a class="prev" rel="prev" href="/blog/archives/2017/page/5/">
      <span class="icon icon-chevron-left"></span>
      <span class="text">Previous</span>
    </a>
    
    
    <a class="next" rel="next" href="/blog/archives/2017/page/7/">
      <span class="text">Next</span>
      <span class="icon icon-chevron-right"></span>
    </a>
    
  </nav>
  


      </div>
      <aside class='l_side'>
        
  <section class='m_widget about'>

<img class='avatar waves-image' src='https://avatars1.githubusercontent.com/u/4043284?v=3&amp;s=460' />

<div class='header'>Jay.M.Hu</div>
<div class='content'>
<div></div>
</div>
</section>

  <section class='m_widget friendly-links'>
<div class='header'>Links</div>
<div class='content'>
    <ul class="entry">
    
        <li><a class="flat-box" target="_blank" href="http://humin.cnblogs.com/">
            <div class='name'>幻天芒 - 博客园</div>
        </a></li>
    
    </ul>
</div>
</section>

  <section class='m_widget categories'>
<div class='header'>Categories</div>
<div class='content'>
    
</div>
</section>

  


      </aside>
      <script>setLoadingBarProgress(60);</script>
    </div>
  </div>
  <footer id="footer" class="clearfix">

	<div class="social-wrapper">
  	
      
        <a href="https://github.com/hstarorg" class="social github"
          target="_blank" rel="external">
          <span class="icon icon-github"></span>
        </a>
      
        <a href="/atom.xml" class="social rss"
          target="_blank" rel="external">
          <span class="icon icon-rss"></span>
        </a>
      
    
  </div>
  
  <div>Theme <a href='https://github.com/stkevintan/hexo-theme-material-flow' class="codename">MaterialFlow</a> designed by <a href="http://keyin.me/" target="_blank">Kevin Tan</a>.</div>
  
</footer>


  <script>setLoadingBarProgress(80);</script>
  

<script src="//apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
<script src='//cdn.bootcss.com/node-waves/0.7.5/waves.min.js'></script>
<script src="//cdn.bootcss.com/scrollReveal.js/3.3.2/scrollreveal.min.js"></script>
<script src="/blog/js/jquery.fitvids.js"></script>
<script>
	var GOOGLE_CUSTOM_SEARCH_API_KEY = "";
	var GOOGLE_CUSTOM_SEARCH_ENGINE_ID = "";
	var ALGOLIA_API_KEY = "";
	var ALGOLIA_APP_ID = "";
	var ALGOLIA_INDEX_NAME = "";
  var AZURE_SERVICE_NAME = "";
  var AZURE_INDEX_NAME = "";
  var AZURE_QUERY_KEY = "";
  var BAIDU_API_ID = "";
  var SEARCH_SERVICE = "hexo";
  var ROOT = "/blog/"||"/";
  if(!ROOT.endsWith('/'))ROOT += '/';
</script>
<script src="/blog/js/search.js"></script>
<script src="/blog/js/app.js"></script>


  <script>setLoadingBarProgress(100);</script>
</body>
</html>
